<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Steganography Pro - Hide Messages Securely</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Light theme (default) */
            --purple-900: #3b0764;
            --purple-700: #7c3aed;
            --purple-600: #8b5cf6;
            --purple-500: #a855f7;
            --purple-400: #c084fc;
            --purple-300: #d8b4fe;
            --purple-200: #e9d5ff;
            --purple-100: #f3e8ff;
            --purple-50: #faf5ff;
            
            --white: #ffffff;
            --gray-50: #fafafa;
            --gray-100: #f4f4f5;
            --gray-200: #e4e4e7;
            --gray-700: #3f3f46;
            --gray-900: #18181b;
            
            --bg-primary: #ffffff;
            --bg-secondary: #fafafa;
            --bg-tertiary: #f4f4f5;
            --text-primary: #18181b;
            --text-secondary: #3f3f46;
            --text-muted: #71717a;
            --border-color: rgba(0, 0, 0, 0.1);
            --card-bg: #ffffff;
            --input-bg: #ffffff;
            --navbar-bg: rgba(255, 255, 255, 0.8);
            
            --gradient-purple: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
            --gradient-pink: linear-gradient(135deg, #ec4899 0%, #f472b6 100%);
            --gradient-blue: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%);
            --gradient-green: linear-gradient(135deg, #10b981 0%, #34d399 100%);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 40px rgba(124, 58, 237, 0.15);
            --shadow-glow: 0 0 30px rgba(124, 58, 237, 0.4);
        }

        /* Dark theme */
        [data-theme="dark"] {
            --purple-900: #e9d5ff;
            --purple-700: #a855f7;
            --purple-600: #c084fc;
            --purple-500: #d8b4fe;
            --purple-400: #e9d5ff;
            --purple-300: #7c3aed;
            --purple-200: #5b21b6;
            --purple-100: #4c1d95;
            --purple-50: #2e1065;
            
            --white: #18181b;
            --gray-50: #27272a;
            --gray-100: #3f3f46;
            --gray-200: #52525b;
            --gray-700: #d4d4d8;
            --gray-900: #fafafa;
            
            --bg-primary: #0f0f10;
            --bg-secondary: #18181b;
            --bg-tertiary: #27272a;
            --text-primary: #fafafa;
            --text-secondary: #d4d4d8;
            --text-muted: #a1a1aa;
            --border-color: rgba(255, 255, 255, 0.1);
            --card-bg: #1f1f23;
            --input-bg: #27272a;
            --navbar-bg: rgba(15, 15, 16, 0.9);
            
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.4);
            --shadow-xl: 0 20px 40px rgba(124, 58, 237, 0.25);
            --shadow-glow: 0 0 30px rgba(168, 85, 247, 0.5);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
            transition: background 0.3s ease, color 0.3s ease;
        }

        [data-theme="light"] body {
            background: linear-gradient(180deg, var(--purple-50) 0%, var(--white) 100%);
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 20%, rgba(124, 58, 237, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(236, 72, 153, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        [data-theme="dark"] body::before {
            background: 
                radial-gradient(circle at 20% 20%, rgba(124, 58, 237, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(168, 85, 247, 0.1) 0%, transparent 50%);
        }

        /* Theme Toggle Button */
        .theme-toggle {
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: 50px;
            padding: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            margin-right: 12px;
        }

        .theme-toggle:hover {
            border-color: var(--purple-500);
            transform: scale(1.05);
        }

        .theme-toggle-icon {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }

        [data-theme="dark"] .theme-toggle-icon.sun {
            display: inline;
        }

        [data-theme="dark"] .theme-toggle-icon.moon {
            display: none;
        }

        [data-theme="light"] .theme-toggle-icon.sun {
            display: none;
        }

        [data-theme="light"] .theme-toggle-icon.moon {
            display: inline;
        }

        /* ============== NAVIGATION ============== */
        .navbar {
            background: var(--navbar-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: 1rem 2rem;
            transition: background 0.3s ease;
        }

        .nav-container {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 24px;
            flex-wrap: wrap;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 800;
            background: var(--gradient-purple);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.5px;
            cursor: pointer;
        }

        /* Auth Buttons in Nav */
        .nav-auth {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-shrink: 0;
        }

        .nav-auth-btn {
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            font-family: 'Poppins', sans-serif;
            white-space: nowrap;
            min-width: 100px;
            text-align: center;
        }

        .nav-auth-btn.login {
            background: transparent;
            color: var(--purple-700);
            border: 2px solid var(--purple-300);
        }

        .nav-auth-btn.login:hover {
            background: var(--purple-50);
            border-color: var(--purple-500);
        }

        .nav-auth-btn.signup {
            background: var(--gradient-purple);
            color: white;
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
        }

        .nav-auth-btn.signup:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(124, 58, 237, 0.4);
        }

        .user-menu {
            position: relative;
            display: none;
        }

        .user-menu.active {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient-purple);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .user-avatar:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.4);
        }

        .user-dropdown {
            position: absolute;
            top: 50px;
            right: 0;
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            padding: 16px;
            min-width: 220px;
            display: none;
            z-index: 1001;
            border: 2px solid var(--border-color);
        }

        [data-theme="dark"] .user-dropdown {
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
        }

        .user-dropdown.show {
            display: block;
            animation: dropdownSlide 0.3s ease;
        }

        @keyframes dropdownSlide {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .user-dropdown-header {
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border-color);
            margin-bottom: 12px;
        }

        .user-dropdown-name {
            font-weight: 700;
            color: var(--text-primary);
        }

        .user-dropdown-email {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .user-dropdown-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .user-dropdown-item:hover {
            background: var(--purple-50);
            color: var(--purple-700);
        }

        [data-theme="dark"] .user-dropdown-item:hover {
            background: rgba(139, 92, 246, 0.2);
            color: var(--purple-300);
        }

        .user-dropdown-item.danger {
            color: #ef4444;
        }

        .user-dropdown-item.danger:hover {
            background: #fef2f2;
        }

        [data-theme="dark"] .user-dropdown-item.danger:hover {
            background: rgba(239, 68, 68, 0.2);
        }

        .nav-menu {
            display: flex;
            gap: 0.5rem;
            list-style: none;
            background: var(--bg-tertiary);
            padding: 0.5rem;
            border-radius: 100px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .nav-link {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.95rem;
            padding: 0.75rem 1.5rem;
            border-radius: 100px;
            transition: all 0.2s ease;
            cursor: pointer;
            white-space: nowrap;
        }

        .nav-link:hover {
            color: var(--purple-700);
            background: rgba(255,255,255,0.5);
        }

        .nav-link.active {
            background: white;
            color: var(--purple-700);
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            font-weight: 700;
        }

        /* ============== MAIN CONTAINER ============== */
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 24px;
            position: relative;
            z-index: 1;
        }

        /* ============== PAGE SECTIONS ============== */
        .page-section {
            display: none;
            animation: pageSlideIn 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .page-section.active {
            display: block;
        }

        @keyframes pageSlideIn {
            from { 
                opacity: 0; 
                transform: translateY(30px) scale(0.98);
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1);
            }
        }

        /* ============== HOME PAGE ============== */
        .hero {
            text-align: center;
            padding: 80px 20px;
            position: relative;
        }

        .hero-badge {
            display: inline-block;
            padding: 12px 28px;
            background: linear-gradient(135deg, var(--purple-100) 0%, var(--purple-200) 100%);
            border: 3px solid var(--purple-300);
            border-radius: 50px;
            color: var(--purple-900);
            font-weight: 800;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 32px;
            animation: badgeFloat 3s ease-in-out infinite;
            box-shadow: 0 8px 20px rgba(124, 58, 237, 0.2);
        }

        @keyframes badgeFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .hero-title {
            font-size: 5rem;
            font-weight: 900;
            line-height: 1.1;
            margin-bottom: 32px;
            background: var(--gradient-purple);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -3px;
            animation: titleScale 1s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes titleScale {
            0% { transform: scale(0.9); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .hero-subtitle {
            font-size: 1.5rem;
            color: var(--text-secondary);
            font-weight: 600;
            max-width: 800px;
            margin: 0 auto 50px;
            line-height: 1.8;
            animation: fadeInUp 1s ease 0.2s both;
        }

        [data-theme="dark"] .hero-badge {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(139, 92, 246, 0.3) 100%);
            border-color: var(--purple-400);
            color: var(--purple-300);
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .cta-buttons {
            display: flex;
            gap: 24px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 60px;
        }

        .btn-cta {
            padding: 22px 48px;
            background: var(--gradient-purple);
            color: white;
            border: none;
            border-radius: 16px;
            font-weight: 900;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 15px 40px rgba(124, 58, 237, 0.4);
            position: relative;
            overflow: hidden;
        }

        .btn-cta::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn-cta:hover::before {
            width: 400px;
            height: 400px;
        }

        .btn-cta:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 20px 60px rgba(124, 58, 237, 0.6);
        }

        .btn-cta:active {
            transform: translateY(-2px) scale(1.02);
        }

        .btn-secondary {
            padding: 22px 48px;
            background: var(--card-bg);
            color: var(--purple-700);
            border: 4px solid var(--purple-300);
            border-radius: 16px;
            font-weight: 900;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        [data-theme="dark"] .btn-secondary {
            color: var(--purple-300);
        }

        .btn-secondary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: var(--gradient-purple);
            transition: left 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: -1;
        }

        .btn-secondary:hover::before {
            left: 0;
        }

        .btn-secondary:hover {
            color: white;
            border-color: var(--purple-500);
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 15px 40px rgba(124, 58, 237, 0.3);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 32px;
            margin-top: 80px;
        }

        .feature-card {
            background: var(--card-bg);
            padding: 48px;
            border-radius: 24px;
            border: 3px solid var(--border-color);
            text-align: center;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .feature-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: var(--gradient-purple);
            opacity: 0;
            transition: opacity 0.4s;
        }

        .feature-card:hover::before {
            opacity: 0.05;
            animation: rotate 3s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .feature-card:hover {
            transform: translateY(-10px) scale(1.03);
            box-shadow: var(--shadow-xl);
            border-color: var(--purple-500);
        }

        .feature-icon {
            font-size: 4rem;
            margin-bottom: 24px;
            display: inline-block;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            filter: drop-shadow(0 4px 8px rgba(124, 58, 237, 0.3));
        }

        .feature-card:hover .feature-icon {
            transform: scale(1.2) rotate(10deg);
            animation: iconBounce 0.6s ease-in-out;
        }

        @keyframes iconBounce {
            0%, 100% { transform: scale(1.2) rotate(10deg) translateY(0); }
            50% { transform: scale(1.2) rotate(10deg) translateY(-15px); }
        }

        .feature-title {
            font-size: 1.5rem;
            font-weight: 900;
            margin-bottom: 16px;
            color: var(--text-primary);
            position: relative;
            z-index: 1;
        }

        .feature-desc {
            font-size: 1.05rem;
            color: var(--text-secondary);
            line-height: 1.7;
            font-weight: 500;
            position: relative;
            z-index: 1;
        }

        /* ============== STATS DASHBOARD ============== */
        .stats-dashboard {
            padding: 80px 50px;
            background: linear-gradient(135deg, #ec4899, #3b82f6);
            margin: 80px 0 0 0;
            border-radius: 30px;
        }

        .section-title {
            font-size: 2.8rem;
            font-weight: 800;
            color: white;
            text-align: center;
            margin-bottom: 15px;
            animation: titleScale 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .section-subtitle {
            text-align: center;
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 50px;
            animation: fadeIn 0.8s ease;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 50px;
        }

        .stat-card {
            background: white;
            padding: 35px 25px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
            animation: slideUp 0.6s ease backwards;
        }

        .stat-card:nth-child(1) { animation-delay: 0.1s; }
        .stat-card:nth-child(2) { animation-delay: 0.2s; }
        .stat-card:nth-child(3) { animation-delay: 0.3s; }
        .stat-card:nth-child(4) { animation-delay: 0.4s; }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(138, 43, 226, 0.1), transparent);
            transition: left 0.6s ease;
        }

        .stat-card:hover::before {
            left: 100%;
        }

        .stat-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 20px 60px rgba(138, 43, 226, 0.3);
        }

        .stat-icon {
            font-size: 3.5rem;
            margin-bottom: 15px;
            animation: iconBounce 2s ease-in-out infinite;
        }

        .stat-value {
            font-size: 3rem;
            font-weight: 900;
            color: var(--purple-700);
            margin-bottom: 10px;
            font-variant-numeric: tabular-nums;
        }

        .stat-label {
            font-size: 1rem;
            color: #666;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .stat-bar {
            height: 8px;
            background: #f0f0f0;
            border-radius: 10px;
            overflow: hidden;
        }

        .stat-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--purple-700), var(--purple-500));
            border-radius: 10px;
            transition: width 1s cubic-bezier(0.65, 0, 0.35, 1);
        }

        /* ============== SHOWCASE SECTION ============== */
        .showcase-section {
            padding: 80px 50px;
            max-width: 1200px;
            margin: 60px auto;
        }

        .showcase-section .section-title {
            color: var(--gray-900);
        }

        .showcase-section .section-subtitle {
            color: #666;
        }

        .samples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 30px;
            margin-top: 50px;
        }

        .sample-card {
            background: white;
            padding: 40px 30px;
            border-radius: 25px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            border: 3px solid transparent;
        }

        .sample-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(
                transparent,
                var(--purple-700),
                transparent 30%
            );
            animation: rotate 4s linear infinite;
            opacity: 0;
            transition: opacity 0.4s;
        }

        .sample-card::after {
            content: '';
            position: absolute;
            inset: 3px;
            background: white;
            border-radius: 22px;
            z-index: 1;
        }

        [data-theme="dark"] .sample-card {
            background: var(--card-bg);
        }

        [data-theme="dark"] .sample-card::after {
            background: var(--card-bg);
        }

        .sample-card > * {
            position: relative;
            z-index: 2;
        }

        .sample-card:hover::before {
            opacity: 1;
        }

        .sample-card:hover {
            transform: translateY(-15px) scale(1.02);
            box-shadow: 0 25px 60px rgba(138, 43, 226, 0.25);
        }

        .sample-badge {
            display: inline-block;
            padding: 8px 18px;
            background: linear-gradient(135deg, var(--purple-700), var(--purple-500));
            color: white;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(138, 43, 226, 0.3);
        }

        .sample-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: iconFloat 3s ease-in-out infinite;
        }

        @keyframes iconFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-12px); }
        }

        .sample-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 15px;
        }

        .sample-desc {
            font-size: 1.05rem;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 25px;
        }

        .sample-btn {
            background: linear-gradient(135deg, var(--purple-700), var(--purple-500));
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(138, 43, 226, 0.3);
            position: relative;
            overflow: hidden;
        }

        .sample-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .sample-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .sample-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(138, 43, 226, 0.4);
        }

        /* ============== CHART SECTION ============== */
        .chart-section {
            padding: 80px 50px;
            background: linear-gradient(135deg, #f8f9ff, #fff5fb);
            margin: 60px 0;
            border-radius: 30px;
        }

        .chart-section .section-title {
            color: var(--gray-900);
        }

        .chart-section .section-subtitle {
            color: #666;
        }

        .chart-container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 25px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.1);
            animation: slideUp 0.8s ease;
        }

        @keyframes rotate {
            100% { transform: rotate(360deg); }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ============== ANIMATED PROCESS EXPLANATION ============== */
        .process-explanation {
            padding: 80px 50px;
            max-width: 1400px;
            margin: 60px auto;
            background: var(--card-bg);
            border-radius: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.08);
        }

        [data-theme="dark"] .process-explanation {
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .process-methods {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 60px;
        }

        .method-tab {
            padding: 18px 40px;
            background: var(--card-bg);
            border: 3px solid var(--purple-200);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            font-weight: 700;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--text-primary);
        }

        [data-theme="dark"] .method-tab {
            border-color: var(--purple-300);
        }

        .method-tab:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(138, 43, 226, 0.2);
            border-color: var(--purple-500);
        }

        .method-tab.active {
            background: var(--gradient-purple);
            color: white;
            border-color: var(--purple-700);
            box-shadow: 0 10px 30px rgba(138, 43, 226, 0.4);
        }

        .method-icon {
            font-size: 1.5rem;
        }

        .method-animation {
            display: none;
            animation: fadeIn 0.6s ease;
        }

        .method-animation.active {
            display: block;
        }

        .animation-stage {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 30px;
            margin-bottom: 60px;
            padding: 40px;
            background: linear-gradient(135deg, var(--purple-50), var(--purple-100));
            border-radius: 25px;
            flex-wrap: wrap;
        }

        [data-theme="dark"] .animation-stage {
            background: linear-gradient(135deg, rgba(124, 58, 237, 0.15), rgba(168, 85, 247, 0.1));
        }

        .stage-step {
            flex: 1;
            min-width: 180px;
            animation: slideUp 0.8s ease backwards;
        }

        .stage-step.stage-1 { animation-delay: 0.2s; }
        .stage-step.stage-2 { animation-delay: 0.4s; }
        .stage-step.stage-3 { animation-delay: 0.6s; }

        .step-visual {
            margin-bottom: 25px;
        }

        .visual-box {
            background: var(--card-bg);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
            min-height: 220px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            transition: all 0.4s ease;
            position: relative;
        }

        [data-theme="dark"] .visual-box {
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .visual-box:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 40px rgba(138, 43, 226, 0.25);
        }

        .visual-box.processing {
            background: linear-gradient(135deg, #fff7ed, #ffedd5);
            animation: pulse-glow 2s ease-in-out infinite;
        }

        [data-theme="dark"] .visual-box.processing {
            background: linear-gradient(135deg, rgba(251, 146, 60, 0.2), rgba(251, 146, 60, 0.1));
        }

        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 10px 30px rgba(251, 146, 60, 0.3); }
            50% { box-shadow: 0 15px 50px rgba(251, 146, 60, 0.6); }
        }

        .visual-box.success {
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
            border: 3px solid #10b981;
        }

        .visual-icon {
            font-size: 3.5rem;
            margin-bottom: 15px;
            animation: iconBounce 2s ease-in-out infinite;
        }

        .visual-label {
            font-weight: 800;
            font-size: 1.1rem;
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .visual-content {
            font-family: 'Courier New', monospace;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--purple-700);
            padding: 12px;
            background: rgba(124, 58, 237, 0.1);
            border-radius: 10px;
            margin-top: 10px;
        }

        .process-particles {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }

        .particle {
            font-size: 2rem;
            animation: float-particle 2s ease-in-out infinite;
            display: inline-block;
        }

        .particle:nth-child(1) { animation-delay: 0s; }
        .particle:nth-child(2) { animation-delay: 0.3s; }
        .particle:nth-child(3) { animation-delay: 0.6s; }

        @keyframes float-particle {
            0%, 100% { transform: translateY(0) rotate(0deg); opacity: 0.3; }
            50% { transform: translateY(-20px) rotate(180deg); opacity: 1; }
        }

        .invisible-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #10b981;
            color: white;
            padding: 6px 14px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 800;
            animation: badge-pulse 2s ease-in-out infinite;
        }

        @keyframes badge-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .animated-arrow {
            font-size: 3rem;
            color: var(--purple-500);
            font-weight: 900;
            animation: arrow-move 1.5s ease-in-out infinite;
            flex-shrink: 0;
        }

        @keyframes arrow-move {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(10px); }
        }

        .step-description {
            text-align: center;
        }

        .step-num {
            width: 50px;
            height: 50px;
            background: var(--gradient-purple);
            color: white;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1.5rem;
            margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(124, 58, 237, 0.4);
        }

        .step-description h3 {
            font-size: 1.4rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .step-description p {
            font-size: 1rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Image-specific visuals */
        .image-preview {
            position: relative;
        }

        .pixel-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            max-width: 180px;
            margin: 0 auto;
        }

        .pixel {
            aspect-ratio: 1;
            border-radius: 8px;
            animation: pixel-shimmer 3s ease-in-out infinite;
        }

        @keyframes pixel-shimmer {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .difference-badge {
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            background: #10b981;
            color: white;
            padding: 6px 12px;
            border-radius: 10px;
            font-size: 0.75rem;
            font-weight: 800;
            white-space: nowrap;
        }

        .lsb-demo {
            padding: 20px;
        }

        .binary-display {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .byte {
            display: flex;
            gap: 6px;
        }

        .bit {
            width: 32px;
            height: 32px;
            background: #e0e7ff;
            color: #3730a3;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            transition: all 0.3s;
        }

        .bit.lsb {
            background: #fef3c7;
            color: #92400e;
            border: 2px solid #f59e0b;
        }

        .byte.modified .bit.lsb {
            background: #dcfce7;
            color: #166534;
            border: 2px solid #10b981;
            animation: bit-change 1s ease-in-out infinite;
        }

        @keyframes bit-change {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .arrow-down {
            font-size: 2rem;
            color: var(--purple-500);
            animation: arrow-bounce 1s ease-in-out infinite;
        }

        @keyframes arrow-bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(10px); }
        }

        /* Tech Details */
        .tech-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .tech-card {
            background: linear-gradient(135deg, var(--purple-50), var(--card-bg));
            padding: 30px;
            border-radius: 20px;
            border: 2px solid var(--purple-200);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            animation: slideUp 0.6s ease backwards;
        }

        [data-theme="dark"] .tech-card {
            background: linear-gradient(135deg, rgba(124, 58, 237, 0.1), var(--card-bg));
            border-color: var(--purple-300);
        }

        .tech-card:nth-child(1) { animation-delay: 0.8s; }
        .tech-card:nth-child(2) { animation-delay: 0.9s; }
        .tech-card:nth-child(3) { animation-delay: 1s; }

        .tech-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(138, 43, 226, 0.2);
            border-color: var(--purple-500);
        }

        .tech-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .tech-title {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .tech-desc {
            font-size: 1rem;
            color: var(--text-secondary);
            line-height: 1.7;
        }

        /* ============== WORKSPACE CARDS ============== */
        .workspace-card {
            background: var(--card-bg);
            border-radius: 24px;
            border: 3px solid var(--purple-200);
            box-shadow: var(--shadow-xl);
            overflow: hidden;
            margin-bottom: 40px;
            animation: slideUp 0.6s ease backwards;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        [data-theme="dark"] .workspace-card {
            border-color: var(--purple-300);
        }

        .workspace-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 70px rgba(138, 43, 226, 0.2);
        }

        .card-header {
            background: linear-gradient(135deg, var(--purple-50) 0%, var(--card-bg) 100%);
            padding: 32px 40px;
            border-bottom: 2px solid var(--purple-200);
            position: relative;
            overflow: hidden;
        }

        [data-theme="dark"] .card-header {
            border-bottom-color: var(--purple-300);
        }

        .card-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(138, 43, 226, 0.1), transparent);
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(-30px, -30px); }
        }

        .card-title {
            font-size: 2rem;
            font-weight: 900;
            color: var(--text-primary);
            margin-bottom: 8px;
            position: relative;
        }

        .card-subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
            font-weight: 500;
            position: relative;
        }

        .card-body {
            padding: 48px;
        }

        /* ============== PASSWORD GENERATOR ============== */
        .password-input-group {
            display: flex;
            gap: 8px;
            align-items: stretch;
        }

        .password-input-group .input-field {
            flex: 1;
        }

        .btn-generate {
            background: var(--gradient-blue);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 12px 16px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 50px;
        }

        .btn-generate:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .btn-copy {
            background: var(--gradient-green);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 12px 16px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 50px;
        }

        .btn-copy:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }

        /* ============== SPEED METRICS ============== */
        .speed-metrics {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            margin-top: 16px;
            padding: 16px;
            background: var(--bg-tertiary);
            border-radius: 12px;
        }

        .speed-metric {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: var(--card-bg);
            border-radius: 8px;
            font-size: 0.9rem;
        }

        .speed-metric-icon {
            font-size: 1.2rem;
        }

        .speed-metric-value {
            font-weight: 700;
            color: var(--purple-600);
        }

        .speed-metric-label {
            color: var(--text-muted);
        }

        /* ============== ENCRYPTION VISUALIZATION ============== */
        .encryption-viz {
            background: var(--bg-tertiary);
            border-radius: 16px;
            padding: 24px;
            margin: 20px 0;
            overflow: hidden;
        }

        .encryption-viz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .encryption-viz-title {
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .encryption-rounds {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding: 8px 0;
        }

        .encryption-round {
            min-width: 80px;
            padding: 12px;
            background: var(--card-bg);
            border-radius: 12px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .encryption-round.active {
            border-color: var(--purple-500);
            background: var(--purple-50);
        }

        .encryption-round.completed {
            border-color: #10b981;
            background: #ecfdf5;
        }

        [data-theme="dark"] .encryption-round.completed {
            background: #064e3b;
        }

        .encryption-round-number {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .encryption-round-data {
            font-family: 'Consolas', monospace;
            font-size: 0.75rem;
            color: var(--purple-600);
            word-break: break-all;
            margin-top: 4px;
        }

        .encryption-progress {
            height: 4px;
            background: var(--bg-secondary);
            border-radius: 2px;
            overflow: hidden;
            margin-top: 12px;
        }

        .encryption-progress-bar {
            height: 100%;
            background: var(--gradient-purple);
            transition: width 0.3s ease;
            border-radius: 2px;
        }

        /* ============== STEPS ============== */
        .step-container {
            margin-bottom: 40px;
            animation: fadeIn 0.5s ease backwards;
        }

        .step-container:nth-child(1) { animation-delay: 0.1s; }
        .step-container:nth-child(2) { animation-delay: 0.2s; }
        .step-container:nth-child(3) { animation-delay: 0.3s; }
        .step-container:nth-child(4) { animation-delay: 0.4s; }

        .step-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 16px;
        }

        .step-number {
            min-width: 50px;
            height: 50px;
            background: var(--gradient-purple);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1.4rem;
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); box-shadow: 0 6px 20px rgba(124, 58, 237, 0.5); }
        }

        .step-title {
            font-size: 1.4rem;
            font-weight: 800;
            color: var(--text-primary);
        }

        .step-description {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 16px;
            padding-left: 66px;
            line-height: 1.7;
        }

        .step-help {
            padding: 16px 24px;
            background: var(--purple-50);
            border-left: 4px solid var(--purple-500);
            border-radius: 8px;
            margin-bottom: 16px;
            margin-left: 66px;
            font-size: 0.95rem;
            color: var(--purple-900);
            font-weight: 500;
        }

        [data-theme="dark"] .step-help {
            background: rgba(139, 92, 246, 0.1);
            color: var(--purple-300);
        }

        /* ============== FORM INPUTS ============== */
        .input-field {
            width: 100%;
            padding: 20px 24px;
            border: 3px solid var(--border-color);
            border-radius: 16px;
            font-family: 'Poppins', sans-serif;
            font-size: 1.1rem;
            font-weight: 500;
            line-height: 1.8;
            transition: all 0.3s;
            background: var(--input-bg);
            color: var(--text-primary);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--purple-500);
            background: var(--card-bg);
            box-shadow: 0 0 0 4px var(--purple-100);
            transform: translateY(-2px);
        }

        [data-theme="dark"] .input-field:focus {
            box-shadow: 0 0 0 4px rgba(139, 92, 246, 0.2);
        }

        .input-field::placeholder {
            color: var(--text-muted);
            font-style: italic;
        }

        textarea.input-field {
            min-height: 400px;
            max-height: 600px;
            resize: vertical;
            line-height: 1.9;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 1rem;
            letter-spacing: 0.5px;
            padding: 24px;
            font-weight: 500;
        }

        textarea.input-field[readonly] {
            min-height: 400px;
            background: var(--bg-tertiary);
            cursor: default;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
        }

        /* ============== LIMITS INFO & CHAR COUNTER ============== */
        .limits-info-box {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 1px solid #7dd3fc;
            border-radius: 16px;
            padding: 20px 24px;
            margin-bottom: 24px;
        }

        [data-theme="dark"] .limits-info-box {
            background: linear-gradient(135deg, #0c4a6e 0%, #075985 100%);
            border-color: #0284c7;
        }
        
        .limits-info-title {
            font-size: 1rem;
            font-weight: 700;
            color: #0284c7;
            margin: 0 0 12px 0;
        }

        [data-theme="dark"] .limits-info-title {
            color: #7dd3fc;
        }
        
        .limits-info-list {
            margin: 0;
            padding: 0 0 0 20px;
            color: #0369a1;
        }

        [data-theme="dark"] .limits-info-list {
            color: #bae6fd;
        }
        
        .limits-info-list li {
            margin-bottom: 6px;
            font-size: 0.9rem;
        }
        
        .limits-info-list li:last-child {
            margin-bottom: 0;
        }
        
        .char-counter {
            text-align: right;
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-top: 8px;
            font-weight: 500;
        }
        
        .char-counter.warning {
            color: #f59e0b;
        }
        
        .char-counter.error {
            color: #ef4444;
            font-weight: 700;
        }

        /* ============== UPLOAD ZONE ============== */
        .upload-zone {
            position: relative;
            border: 4px dashed var(--purple-300);
            border-radius: 24px;
            padding: 60px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            background: linear-gradient(135deg, var(--purple-50) 0%, var(--card-bg) 100%);
            overflow: hidden;
        }

        .upload-zone::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(circle, rgba(138, 43, 226, 0.1), transparent);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .upload-zone:hover::before {
            width: 500px;
            height: 500px;
        }

        .upload-zone:hover {
            border-color: var(--purple-500);
            background: var(--purple-100);
            transform: scale(1.02);
            box-shadow: 0 15px 40px rgba(138, 43, 226, 0.15);
        }

        [data-theme="dark"] .upload-zone:hover {
            background: rgba(139, 92, 246, 0.2);
        }

        .upload-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: iconBounce 2s ease-in-out infinite;
            position: relative;
            z-index: 1;
        }

        .upload-title {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--purple-700);
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
        }

        [data-theme="dark"] .upload-title {
            color: var(--purple-400);
        }

        .upload-subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
            position: relative;
            z-index: 1;
        }

        .file-input {
            position: absolute;
            width: 0;
            height: 0;
            opacity: 0;
            pointer-events: none;
        }

        .preview-box {
            margin-top: 24px;
            padding: 24px;
            background: var(--bg-tertiary);
            border: 3px solid var(--border-color);
            border-radius: 16px;
        }

        .preview-box img {
            width: 100%;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
        }

        /* ============== BUTTONS ============== */
        .btn-primary {
            width: 100%;
            padding: 22px;
            background: var(--gradient-purple);
            border: none;
            border-radius: 16px;
            color: white;
            font-family: 'Poppins', sans-serif;
            font-size: 1.3rem;
            font-weight: 900;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 10px 30px rgba(124, 58, 237, 0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn-primary:hover::before {
            width: 400px;
            height: 400px;
        }

        .btn-primary:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 20px 50px rgba(124, 58, 237, 0.6);
        }

        .btn-primary:active {
            transform: translateY(-1px) scale(0.98);
        }

        .btn-action {
            padding: 16px 36px;
            background: white;
            border: 3px solid var(--purple-300);
            border-radius: 14px;
            color: var(--purple-700);
            font-weight: 700;
            font-size: 1.05rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
            font-family: 'Poppins', sans-serif;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .btn-action::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(138, 43, 226, 0.1), transparent);
            transition: left 0.5s;
        }

        .btn-action:hover::before {
            left: 100%;
        }

        .btn-action:hover {
            background: var(--purple-50);
            border-color: var(--purple-500);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(138, 43, 226, 0.2);
        }

        /* ============== RESULTS ============== */
        .result-container {
            margin-top: 48px;
            padding: 48px;
            background: linear-gradient(135deg, #10b981 0%, #3b82f6 100%);
            border-radius: 24px;
            animation: celebration 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 0 20px 50px rgba(16, 185, 129, 0.3);
            position: relative;
            overflow: hidden;
        }

        .result-container::before {
            content: '';
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 3rem;
            animation: spin 3s linear infinite;
        }

        @keyframes celebration {
            0% { opacity: 0; transform: scale(0.8) translateY(30px); }
            50% { transform: scale(1.05) translateY(-10px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
        }

        .result-icon {
            font-size: 3rem;
        }

        .result-title {
            font-size: 2rem;
            font-weight: 900;
            color: white;
        }

        .result-content {
            background: var(--card-bg);
            padding: 32px;
            border-radius: 16px;
            box-shadow: var(--shadow-lg);
        }

        .result-actions {
            display: flex;
            gap: 20px;
            margin-top: 24px;
            justify-content: flex-end;
            flex-wrap: wrap;
        }

        /* ============== ANALYTICS ============== */
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 24px;
            margin: 32px 0;
        }

        .metric-card {
            background: var(--card-bg);
            padding: 28px;
            border-radius: 16px;
            text-align: center;
            box-shadow: var(--shadow-lg);
            border: 2px solid var(--border-color);
        }

        [data-theme="dark"] .metric-card {
            border-color: var(--purple-300);
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: 900;
            background: var(--gradient-purple);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .metric-label {
            font-size: 0.9rem;
            color: var(--gray-700);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* ============== GUIDE SECTION ============== */
        .guide-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .guide-card {
            background: var(--card-bg);
            padding: 40px;
            border-radius: 20px;
            border: 2px solid var(--border-color);
            margin-bottom: 24px;
        }

        .guide-number {
            display: inline-block;
            width: 40px;
            height: 40px;
            background: var(--gradient-purple);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 40px;
            font-weight: 900;
            margin-bottom: 16px;
        }

        .guide-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 12px;
        }

        .guide-text {
            font-size: 1.05rem;
            line-height: 1.8;
            color: var(--text-secondary);
        }

        /* ============== TUTORIAL OVERLAY ============== */
        .tutorial-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(2px);
            z-index: 10001;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .tutorial-overlay.active {
            display: flex;
        }

        .tutorial-spotlight {
            position: absolute;
            border: 4px solid var(--purple-500);
            border-radius: 16px;
            box-shadow: 0 0 40px var(--purple-500), 0 0 60px rgba(124, 58, 237, 0.6);
            pointer-events: none;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 10002;
            background: transparent;
        }

        .tutorial-card {
            position: fixed;
            background: var(--card-bg);
            border-radius: 24px;
            padding: 40px;
            max-width: 500px;
            box-shadow: 0 25px 70px rgba(124, 58, 237, 0.4);
            z-index: 10003;
            animation: tutorialSlideIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes tutorialSlideIn {
            from { opacity: 0; transform: translateY(30px) scale(0.9); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .tutorial-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
        }

        .tutorial-step-badge {
            background: var(--gradient-purple);
            color: white;
            padding: 8px 20px;
            border-radius: 100px;
            font-weight: 800;
            font-size: 0.9rem;
        }

        .tutorial-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--gray-900);
            margin-bottom: 16px;
        }

        .tutorial-description {
            font-size: 1.1rem;
            color: var(--gray-700);
            line-height: 1.7;
            margin-bottom: 32px;
        }

        /* ============== AUTH MODAL ============== */
        .auth-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(8px);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .auth-modal.active {
            display: flex;
        }

        .auth-modal-content {
            background: var(--card-bg);
            border-radius: 24px;
            padding: 40px;
            max-width: 440px;
            width: 100%;
            box-shadow: 0 25px 70px rgba(0, 0, 0, 0.3);
            animation: modalSlideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        @keyframes modalSlideIn {
            from { opacity: 0; transform: translateY(-30px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .auth-modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--bg-secondary);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.3s;
            color: var(--text-primary);
        }

        .auth-modal-close:hover {
            background: var(--bg-tertiary);
            transform: rotate(90deg);
        }

        .auth-modal-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .auth-modal-icon {
            font-size: 3rem;
            margin-bottom: 16px;
        }

        .auth-modal-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .auth-modal-subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
        }

        .auth-form-group {
            margin-bottom: 20px;
        }

        .auth-form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .auth-form-input {
            width: 100%;
            padding: 14px 18px;
            border: 3px solid var(--border-color);
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s;
            background: var(--input-bg);
            color: var(--text-primary);
        }

        .auth-form-input:focus {
            outline: none;
            border-color: var(--purple-500);
            box-shadow: 0 0 0 4px var(--purple-100);
        }

        [data-theme="dark"] .auth-form-input:focus {
            box-shadow: 0 0 0 4px rgba(139, 92, 246, 0.2);
        }

        .auth-form-input.error {
            border-color: #ef4444;
            box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1);
        }

        .auth-form-error {
            color: #ef4444;
            font-size: 0.85rem;
            margin-top: 6px;
            display: none;
        }

        .auth-form-error.show {
            display: block;
        }

        .auth-form-hint {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 6px;
        }

        .auth-submit-btn {
            width: 100%;
            padding: 16px;
            background: var(--gradient-purple);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Poppins', sans-serif;
            margin-top: 10px;
        }

        .auth-submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(124, 58, 237, 0.4);
        }

        .auth-submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .auth-switch {
            text-align: center;
            margin-top: 20px;
            color: var(--gray-700);
        }

        .auth-switch-link {
            color: var(--purple-700);
            font-weight: 600;
            cursor: pointer;
        }

        .auth-switch-link:hover {
            text-decoration: underline;
        }

        .password-strength {
            height: 6px;
            border-radius: 3px;
            background: var(--gray-200);
            margin-top: 8px;
            overflow: hidden;
        }

        .password-strength-bar {
            height: 100%;
            border-radius: 3px;
            transition: all 0.3s;
            width: 0%;
        }

        .password-strength-bar.weak { width: 25%; background: #ef4444; }
        .password-strength-bar.fair { width: 50%; background: #f59e0b; }
        .password-strength-bar.good { width: 75%; background: #10b981; }
        .password-strength-bar.strong { width: 100%; background: #059669; }

        /* ============== LIMITS INFO BOX ============== */
        .limits-info {
            background: linear-gradient(135deg, var(--purple-50) 0%, var(--purple-100) 100%);
            border: 2px solid var(--purple-200);
            border-radius: 16px;
            padding: 20px 24px;
            margin-bottom: 24px;
        }

        .limits-info-title {
            font-weight: 700;
            color: var(--purple-900);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .limits-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
        }

        .limits-info-item {
            background: white;
            padding: 12px;
            border-radius: 10px;
            text-align: center;
        }

        .limits-info-value {
            font-weight: 800;
            color: var(--purple-700);
            font-size: 1.1rem;
        }

        .limits-info-label {
            font-size: 0.8rem;
            color: var(--gray-700);
        }

        .char-counter {
            text-align: right;
            font-size: 0.85rem;
            color: var(--gray-700);
            margin-top: 8px;
        }

        .char-counter.warning {
            color: #f59e0b;
        }

        .char-counter.danger {
            color: #ef4444;
        }

        /* ============== HISTORY PANEL ============== */
        .history-panel {
            background: var(--card-bg);
            border-radius: 24px;
            border: 3px solid var(--border-color);
            box-shadow: var(--shadow-xl);
            overflow: hidden;
            margin-bottom: 40px;
        }

        .history-header {
            background: linear-gradient(135deg, var(--purple-50) 0%, var(--card-bg) 100%);
            padding: 24px 32px;
            border-bottom: 2px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        [data-theme="dark"] .history-header {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, var(--card-bg) 100%);
        }

        .history-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--text-primary);
        }

        .history-actions {
            display: flex;
            gap: 12px;
        }

        .history-list {
            max-height: 500px;
            overflow-y: auto;
        }

        .history-item {
            padding: 20px 32px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 16px;
            transition: all 0.2s;
        }

        .history-item:hover {
            background: var(--bg-tertiary);
        }

        .history-item-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .history-item-icon.encode {
            background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
        }

        .history-item-icon.decode {
            background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%);
        }

        .history-item-content {
            flex: 1;
        }

        .history-item-title {
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .history-item-meta {
            font-size: 0.85rem;
            color: var(--text-secondary);
            display: flex;
            gap: 16px;
        }

        .history-item-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .history-item-badge.text {
            background: #dbeafe;
            color: #1d4ed8;
        }

        .history-item-badge.image {
            background: #fce7f3;
            color: #be185d;
        }

        .history-item-badge.encrypted {
            background: #dcfce7;
            color: #166534;
        }

        [data-theme="dark"] .history-item-badge.text {
            background: rgba(59, 130, 246, 0.2);
            color: #60a5fa;
        }

        [data-theme="dark"] .history-item-badge.image {
            background: rgba(236, 72, 153, 0.2);
            color: #f472b6;
        }

        [data-theme="dark"] .history-item-badge.encrypted {
            background: rgba(16, 185, 129, 0.2);
            color: #34d399;
        }

        .history-item-delete {
            opacity: 0;
            transition: opacity 0.2s;
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            color: #ef4444;
        }

        .history-item:hover .history-item-delete {
            opacity: 1;
        }

        .history-item-delete:hover {
            background: #fef2f2;
        }

        .history-empty {
            padding: 60px 20px;
            text-align: center;
            color: var(--gray-700);
        }

        .history-empty-icon {
            font-size: 4rem;
            margin-bottom: 16px;
        }

        .tutorial-controls {
            display: flex;
            gap: 12px;
            justify-content: space-between;
        }

        .tutorial-btn {
            padding: 14px 28px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
        }

        .tutorial-btn-primary {
            background: var(--gradient-purple);
            color: white;
            flex: 1;
        }

        .tutorial-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(124, 58, 237, 0.4);
        }

        .tutorial-btn-secondary {
            background: var(--gray-100);
            color: var(--gray-700);
        }

        .tutorial-btn-secondary:hover {
            background: var(--gray-200);
        }

        .tutorial-progress {
            display: flex;
            gap: 8px;
            margin-top: 24px;
            justify-content: center;
        }

        .tutorial-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--gray-200);
            transition: all 0.3s;
        }

        .tutorial-dot.active {
            background: var(--purple-500);
            width: 30px;
            border-radius: 5px;
        }

        /* ============== UTILITIES ============== */
        .hidden { display: none !important; }

        .toast {
            position: fixed;
            bottom: 40px;
            right: 40px;
            padding: 20px 32px;
            background: var(--gray-900);
            color: white;
            border-radius: 16px;
            font-weight: 700;
            font-size: 1.1rem;
            box-shadow: var(--shadow-xl);
            transform: translateX(400px);
            transition: transform 0.4s;
            z-index: 10000;
        }

        .toast.show {
            transform: translateX(0);
        }

        .loading-overlay {
            position: fixed;
            inset: 0;
            background: rgba(124, 58, 237, 0.95);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .spinner {
            width: 80px;
            height: 80px;
            border: 8px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            color: white;
            font-size: 1.5rem;
            font-weight: 800;
            margin-top: 24px;
        }

        /* ============== ACCOUNT SETTINGS PAGE ============== */
        .account-hero {
            text-align: center;
            padding: 60px 40px;
            background: linear-gradient(135deg, var(--purple-100), var(--purple-50));
            border-radius: 30px;
            margin-bottom: 40px;
            position: relative;
            overflow: hidden;
        }

        [data-theme="dark"] .account-hero {
            background: linear-gradient(135deg, rgba(124, 58, 237, 0.2), rgba(168, 85, 247, 0.1));
        }

        .account-hero::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -30%;
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(124, 58, 237, 0.15), transparent 70%);
            animation: float 8s ease-in-out infinite;
        }

        .account-avatar-large {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: var(--gradient-purple);
            margin: 0 auto 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: white;
            font-weight: 800;
            box-shadow: 0 10px 40px rgba(124, 58, 237, 0.4);
            position: relative;
            z-index: 1;
        }

        .account-name {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--text-primary);
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
        }

        .account-email-display {
            font-size: 1.1rem;
            color: var(--text-secondary);
            margin-bottom: 32px;
            position: relative;
            z-index: 1;
        }

        .account-stats-row {
            display: flex;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
            position: relative;
            z-index: 1;
        }

        .account-stat {
            text-align: center;
        }

        .account-stat-value {
            display: block;
            font-size: 2rem;
            font-weight: 900;
            color: var(--purple-700);
        }

        .account-stat-label {
            font-size: 0.9rem;
            color: var(--text-muted);
            font-weight: 600;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
            gap: 30px;
        }

        .settings-card {
            background: var(--card-bg);
            border-radius: 24px;
            border: 2px solid var(--purple-200);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        [data-theme="dark"] .settings-card {
            border-color: var(--purple-300);
        }

        .settings-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 50px rgba(124, 58, 237, 0.15);
        }

        .settings-card.danger {
            border-color: #fecaca;
        }

        .settings-card.danger:hover {
            box-shadow: 0 15px 50px rgba(239, 68, 68, 0.15);
        }

        [data-theme="dark"] .settings-card.danger {
            border-color: rgba(239, 68, 68, 0.4);
        }

        .settings-card-header {
            padding: 24px 28px;
            background: linear-gradient(135deg, var(--purple-50), transparent);
            border-bottom: 2px solid var(--purple-100);
            display: flex;
            align-items: center;
            gap: 16px;
        }

        [data-theme="dark"] .settings-card-header {
            background: linear-gradient(135deg, rgba(124, 58, 237, 0.1), transparent);
            border-bottom-color: var(--purple-200);
        }

        .settings-card.danger .settings-card-header {
            background: linear-gradient(135deg, #fef2f2, transparent);
            border-bottom-color: #fecaca;
        }

        [data-theme="dark"] .settings-card.danger .settings-card-header {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), transparent);
        }

        .settings-card-icon {
            width: 50px;
            height: 50px;
            border-radius: 14px;
            background: var(--gradient-purple);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .settings-card-icon.danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .settings-card-title {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--text-primary);
        }

        .settings-card-title.danger {
            color: #ef4444;
        }

        .settings-card-body {
            padding: 28px;
        }

        .profile-info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .profile-info-row:last-child {
            border-bottom: none;
        }

        .profile-label {
            font-weight: 600;
            color: var(--text-muted);
        }

        .profile-value {
            font-weight: 700;
            color: var(--text-primary);
        }

        .settings-btn {
            width: 100%;
            padding: 16px 24px;
            border-radius: 14px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            font-family: 'Poppins', sans-serif;
            margin-top: 16px;
        }

        .settings-btn.primary {
            background: var(--gradient-purple);
            color: white;
            box-shadow: 0 4px 15px rgba(124, 58, 237, 0.3);
        }

        .settings-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(124, 58, 237, 0.4);
        }

        .settings-btn.danger {
            background: #fef2f2;
            color: #ef4444;
            border: 2px solid #fecaca;
        }

        .settings-btn.danger:hover {
            background: #fee2e2;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.2);
        }

        [data-theme="dark"] .settings-btn.danger {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.4);
        }

        [data-theme="dark"] .settings-btn.danger:hover {
            background: rgba(239, 68, 68, 0.2);
        }

        .danger-warning {
            color: var(--text-secondary);
            line-height: 1.7;
            margin-bottom: 8px;
        }

        /* ============== STEGANOGRAPHY HISTORY PAGE ============== */
        .history-section {
            margin-bottom: 48px;
        }

        .history-section-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 3px solid var(--purple-200);
        }

        /* Timeline */
        .history-timeline {
            position: relative;
            padding-left: 40px;
        }

        .history-timeline::before {
            content: '';
            position: absolute;
            left: 12px;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--gradient-purple);
            border-radius: 2px;
        }

        .timeline-item {
            position: relative;
            margin-bottom: 32px;
            padding-left: 24px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -34px;
            top: 8px;
            width: 16px;
            height: 16px;
            background: var(--purple-500);
            border-radius: 50%;
            border: 4px solid var(--card-bg);
            box-shadow: 0 0 0 4px var(--purple-200);
        }

        .timeline-year {
            display: inline-block;
            background: var(--gradient-purple);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .timeline-content h4 {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .timeline-content p {
            color: var(--text-secondary);
            line-height: 1.7;
        }

        /* Cases Grid */
        .history-cases-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
        }

        .history-case-card {
            background: var(--bg-tertiary);
            border-radius: 16px;
            padding: 24px;
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .history-case-card:hover {
            transform: translateY(-4px);
            border-color: var(--purple-400);
            box-shadow: 0 12px 40px rgba(138, 43, 226, 0.15);
        }

        .case-icon {
            font-size: 2.5rem;
            margin-bottom: 12px;
        }

        .history-case-card h4 {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .history-case-card p {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 12px;
        }

        .case-tag {
            display: inline-block;
            background: var(--purple-100);
            color: var(--purple-700);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        [data-theme="dark"] .case-tag {
            background: rgba(139, 92, 246, 0.2);
            color: var(--purple-300);
        }

        /* Attack Grid */
        .attack-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 24px;
        }

        .attack-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 24px;
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .attack-card:hover {
            border-color: var(--purple-400);
        }

        .attack-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .attack-icon {
            font-size: 1.8rem;
        }

        .attack-header h4 {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .attack-card p {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 16px;
        }

        .attack-effectiveness {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .effectiveness-bar {
            flex: 1;
            height: 8px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            overflow: hidden;
        }

        .effectiveness-bar div {
            height: 100%;
            background: var(--gradient-purple);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        /* Techniques Grid */
        .techniques-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
        }

        .technique-card {
            background: var(--bg-tertiary);
            border-radius: 16px;
            padding: 24px;
            border: 2px solid var(--border-color);
        }

        .technique-card h4 {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 16px;
        }

        .technique-card ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .technique-card li {
            padding: 8px 0;
            color: var(--text-secondary);
            font-size: 0.95rem;
            border-bottom: 1px solid var(--border-color);
        }

        .technique-card li:last-child {
            border-bottom: none;
        }

        .technique-card li strong {
            color: var(--purple-600);
        }

        [data-theme="dark"] .technique-card li strong {
            color: var(--purple-400);
        }

        /* Fun Facts */
        .fun-facts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .fun-fact {
            display: flex;
            gap: 16px;
            align-items: flex-start;
            background: linear-gradient(135deg, var(--purple-50) 0%, var(--card-bg) 100%);
            padding: 20px;
            border-radius: 12px;
            border: 2px solid var(--purple-200);
        }

        [data-theme="dark"] .fun-fact {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, var(--card-bg) 100%);
        }

        .fun-fact-icon {
            font-size: 2rem;
            flex-shrink: 0;
        }

        .fun-fact p {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.6;
            margin: 0;
        }

        /* ============== RESPONSIVE ============== */
        @media (max-width: 1200px) {
            .nav-container {
                padding: 0 16px;
            }
            
            .nav-menu {
                gap: 0.25rem;
            }
            
            .nav-link {
                padding: 0.6rem 1rem;
                font-size: 0.85rem;
            }
            
            .nav-auth-btn {
                padding: 10px 18px;
                font-size: 0.85rem;
                min-width: 80px;
            }
        }
        
        @media (max-width: 992px) {
            .nav-container {
                flex-direction: column;
                gap: 16px;
            }
            
            .nav-menu {
                order: 3;
                width: 100%;
            }
            
            .logo {
                order: 1;
            }
            
            .nav-auth, .user-menu {
                order: 2;
            }
        }
        
        @media (max-width: 768px) {
            .hero-title { font-size: 2.5rem; }
            
            .nav-menu {
                flex-wrap: wrap;
                justify-content: center;
                gap: 0.5rem;
                padding: 0.5rem;
                width: 100%;
                border-radius: 20px;
            }
            
            .nav-link {
                padding: 0.5rem 0.75rem;
                font-size: 0.8rem;
            }
            
            .nav-auth-btn {
                padding: 8px 16px;
                font-size: 0.8rem;
                min-width: 70px;
            }

            .card-body { padding: 24px; }
            .main-container { padding: 16px; }
        }
    </style>
</head>
<body>

    <!-- Loading Overlay -->
    <div id="loading" class="loading-overlay hidden">
        <div class="spinner"></div>
        <div class="loading-text">Processing...</div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">Notification</div>

    <!-- Tutorial Overlay -->
    <div id="tutorial-overlay" class="tutorial-overlay">
        <div id="tutorial-spotlight" class="tutorial-spotlight"></div>
        <div id="tutorial-card" class="tutorial-card">
            <div class="tutorial-header">
                <span id="tutorial-step-badge" class="tutorial-step-badge">Step 1 of 5</span>
            </div>
            <h2 id="tutorial-title" class="tutorial-title">Welcome to the Tutorial!</h2>
            <p id="tutorial-description" class="tutorial-description">Let's take a quick tour of the key features.</p>
            <div class="tutorial-controls">
                <button class="tutorial-btn tutorial-btn-secondary" onclick="skipTutorial()">Skip</button>
                <button id="tutorial-next" class="tutorial-btn tutorial-btn-primary" onclick="nextTutorialStep()">Next</button>
            </div>
            <div class="tutorial-progress" id="tutorial-progress">
                <div class="tutorial-dot active"></div>
                <div class="tutorial-dot"></div>
                <div class="tutorial-dot"></div>
                <div class="tutorial-dot"></div>
                <div class="tutorial-dot"></div>
                <div class="tutorial-dot"></div>
                <div class="tutorial-dot"></div>
                <div class="tutorial-dot"></div>
                <div class="tutorial-dot"></div>
                <div class="tutorial-dot"></div>
            </div>
        </div>
    </div>

    <!-- Auth Modal -->
    <div id="auth-modal" class="auth-modal">
        <div class="auth-modal-content">
            <button class="auth-modal-close" onclick="closeAuthModal()"></button>
            
            <!-- Login Form -->
            <div id="login-form" class="auth-form">
                <div class="auth-modal-header">
                    <div class="auth-modal-icon"></div>
                    <h2 class="auth-modal-title">Welcome Back</h2>
                    <p class="auth-modal-subtitle">Sign in to access your history and saved operations</p>
                </div>
                
                <div class="auth-form-group">
                    <label class="auth-form-label">Username or Email</label>
                    <input type="text" id="login-username" class="auth-form-input" placeholder="Enter username or email">
                    <div id="login-username-error" class="auth-form-error"></div>
                </div>
                
                <div class="auth-form-group">
                    <label class="auth-form-label">Password</label>
                    <input type="password" id="login-password" class="auth-form-input" placeholder="Enter your password">
                    <div id="login-password-error" class="auth-form-error"></div>
                </div>
                
                <button onclick="handleLogin()" class="auth-submit-btn">Sign In</button>
                
                <p class="auth-switch">
                    Don't have an account? <span class="auth-switch-link" onclick="showSignupForm()">Create one</span>
                </p>
            </div>
            
            <!-- Signup Form -->
            <div id="signup-form" class="auth-form hidden">
                <div class="auth-modal-header">
                    <div class="auth-modal-icon"></div>
                    <h2 class="auth-modal-title">Create Account</h2>
                    <p class="auth-modal-subtitle">Sign up to save your history and access from anywhere</p>
                </div>
                
                <div class="auth-form-group">
                    <label class="auth-form-label">Username</label>
                    <input type="text" id="signup-username" class="auth-form-input" placeholder="Choose a username">
                    <div class="auth-form-hint">3-30 characters, letters, numbers, and underscores only</div>
                    <div id="signup-username-error" class="auth-form-error"></div>
                </div>
                
                <div class="auth-form-group">
                    <label class="auth-form-label">Email</label>
                    <input type="email" id="signup-email" class="auth-form-input" placeholder="Enter your email">
                    <div id="signup-email-error" class="auth-form-error"></div>
                </div>
                
                <div class="auth-form-group">
                    <label class="auth-form-label">Password</label>
                    <input type="password" id="signup-password" class="auth-form-input" placeholder="Create a strong password" oninput="updatePasswordStrength()">
                    <div class="password-strength">
                        <div id="password-strength-bar" class="password-strength-bar"></div>
                    </div>
                    <div class="auth-form-hint">Min 8 chars with uppercase, lowercase, number, and special character</div>
                    <div id="signup-password-error" class="auth-form-error"></div>
                </div>
                
                <div class="auth-form-group">
                    <label class="auth-form-label">Confirm Password</label>
                    <input type="password" id="signup-confirm" class="auth-form-input" placeholder="Confirm your password">
                    <div id="signup-confirm-error" class="auth-form-error"></div>
                </div>
                
                <button onclick="handleSignup()" class="auth-submit-btn">Create Account</button>
                
                <p class="auth-switch">
                    Already have an account? <span class="auth-switch-link" onclick="showLoginForm()">Sign in</span>
                </p>
            </div>
        </div>
    </div>

    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo" onclick="navigate('home')">Steganography Pro</div>
            
            <!-- Theme Toggle Button -->
            <button class="theme-toggle" onclick="toggleTheme()" title="Toggle dark mode" aria-label="Toggle dark mode">
                <span class="theme-icon-sun"></span>
                <span class="theme-icon-moon"></span>
            </button>
            
            <ul class="nav-menu">
                <li><a class="nav-link active" onclick="navigate('home')">Home</a></li>
                <li><a class="nav-link" onclick="navigate('text-encode')">Hide in Text</a></li>
                <li><a class="nav-link" onclick="navigate('text-decode')">Reveal from Text</a></li>
                <li><a class="nav-link" onclick="navigate('image-encode')">Hide in Image</a></li>
                <li><a class="nav-link" onclick="navigate('image-decode')">Reveal from Image</a></li>
                <li><a class="nav-link" onclick="navigate('history')" id="nav-history" style="display: none;"> History</a></li>
                <li><a class="nav-link" onclick="navigate('stego-history')"> History</a></li>
                <li><a class="nav-link" onclick="navigate('guide')">How It Works</a></li>
                <li><a class="nav-link" onclick="startTutorial()" style="background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%); color: white;"> Tutorial</a></li>
            </ul>
            
            <!-- Auth Buttons (shown when logged out) -->
            <div id="auth-buttons" class="nav-auth">
                <button class="nav-auth-btn login" onclick="openAuthModal('login')">Log In</button>
                <button class="nav-auth-btn signup" onclick="openAuthModal('signup')">Sign Up</button>
            </div>
            
            <!-- User Menu (shown when logged in) -->
            <div id="user-menu" class="user-menu">
                <div class="user-avatar" onclick="toggleUserDropdown()" id="user-avatar">U</div>
                <div id="user-dropdown" class="user-dropdown">
                    <div class="user-dropdown-header">
                        <div class="user-dropdown-name" id="user-dropdown-name">Username</div>
                        <div class="user-dropdown-email" id="user-dropdown-email">email@example.com</div>
                    </div>
                    <div class="user-dropdown-item" onclick="navigate('history')">
                         My History
                    </div>
                    <div class="user-dropdown-item" onclick="navigate('account')">
                         Account Settings
                    </div>
                    <div class="user-dropdown-item danger" onclick="handleLogout()">
                         Log Out
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="main-container">

        <!-- ========================================
             HOME PAGE
        ======================================== -->
        <section id="page-home" class="page-section active">
            <div class="hero">
                <div class="hero-badge">Professional Security Tool</div>
                <h1 class="hero-title">Hide Messages<br>Inside Text & Images</h1>
                <p class="hero-subtitle">
                    Military-grade steganography made simple. Hide confidential messages in plain sight with AES encryption and zero-knowledge security.
                </p>
                <div class="cta-buttons">
                    <button class="btn-cta" onclick="navigate('text-encode')">Start Hiding Messages</button>
                    <button class="btn-secondary" onclick="navigate('guide')">Learn How It Works</button>
                </div>
            </div>

            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon"></div>
                    <div class="feature-title">AES-128 Encryption</div>
                    <div class="feature-desc">Military-grade encryption protects your secrets with password-based security</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"></div>
                    <div class="feature-title">Completely Invisible</div>
                    <div class="feature-desc">Messages are hidden using Unicode steganography - undetectable to the human eye</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"></div>
                    <div class="feature-title">Quality Analysis</div>
                    <div class="feature-desc">Advanced metrics (MSE, PSNR, SSIM) ensure perfect image quality after encoding</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"></div>
                    <div class="feature-title">Lightning Fast</div>
                    <div class="feature-desc">Process messages and images in milliseconds with optimized algorithms</div>
                </div>
            </div>

            <!-- Live Statistics Dashboard -->
            <div class="stats-dashboard">
                <h2 class="section-title">Live Usage Statistics</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon"></div>
                        <div class="stat-value" id="stat-encodes">0</div>
                        <div class="stat-label">Messages Hidden</div>
                        <div class="stat-bar">
                            <div class="stat-bar-fill" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"></div>
                        <div class="stat-value" id="stat-decodes">0</div>
                        <div class="stat-label">Messages Revealed</div>
                        <div class="stat-bar">
                            <div class="stat-bar-fill" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"></div>
                        <div class="stat-value" id="stat-speed">0ms</div>
                        <div class="stat-label">Avg Processing Time</div>
                        <div class="stat-bar">
                            <div class="stat-bar-fill" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"></div>
                        <div class="stat-value" id="stat-success">100%</div>
                        <div class="stat-label">Success Rate</div>
                        <div class="stat-bar">
                            <div class="stat-bar-fill" style="width: 100%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sample Showcase -->
            <div class="showcase-section">
                <h2 class="section-title">See It In Action</h2>
                <p class="section-subtitle">Click on any sample to try it instantly</p>
                
                <div class="samples-grid">
                    <div class="sample-card" onclick="loadTextSample()">
                        <div class="sample-badge"> Popular</div>
                        <div class="sample-icon"></div>
                        <h3 class="sample-title">Corporate Email</h3>
                        <p class="sample-desc">Professional marketing email hiding confidential project details and budget info</p>
                        <button class="sample-btn">Try This Demo </button>
                    </div>
                    
                    <div class="sample-card" onclick="loadJournalistSample()">
                        <div class="sample-badge"> Trending</div>
                        <div class="sample-icon"></div>
                        <h3 class="sample-title">News Article</h3>
                        <p class="sample-desc">Public news story concealing protected source information and whistleblower contact</p>
                        <button class="sample-btn">Try This Demo </button>
                    </div>
                    
                    <div class="sample-card" onclick="loadSocialSample()">
                        <div class="sample-badge"> Creative</div>
                        <div class="sample-icon"></div>
                        <h3 class="sample-title">Social Media Post</h3>
                        <p class="sample-desc">Casual Instagram caption hiding secret meet-up coordinates and event details</p>
                        <button class="sample-btn">Try This Demo </button>
                    </div>
                    
                    <div class="sample-card" onclick="loadImageSample()">
                        <div class="sample-badge"> Advanced</div>
                        <div class="sample-icon"></div>
                        <h3 class="sample-title">Image Steganography</h3>
                        <p class="sample-desc">Upload your own photo and hide messages with 99.6% visual similarity</p>
                        <button class="sample-btn">Upload Image </button>
                    </div>
                    
                    <div class="sample-card" onclick="loadEncryptedSample()">
                        <div class="sample-badge"> Secure</div>
                        <div class="sample-icon"></div>
                        <h3 class="sample-title">Password Protected</h3>
                        <p class="sample-desc">Military-grade AES encryption protecting sensitive diplomatic communications</p>
                        <button class="sample-btn">Try This Demo </button>
                    </div>
                    
                    <div class="sample-card" onclick="navigate('guide')">
                        <div class="sample-badge"> Documentation</div>
                        <div class="sample-icon"></div>
                        <h3 class="sample-title">Learn The Science</h3>
                        <p class="sample-desc">Complete guide to zero-width characters, LSB encoding, and cryptographic techniques</p>
                        <button class="sample-btn">Read Guide </button>
                    </div>
                </div>
            </div>

            <!-- Animated Process Explanation -->
            <div class="process-explanation">
                <h2 class="section-title" style="color: var(--text-primary);">How The Magic Works</h2>
                <p class="section-subtitle" style="color: var(--text-secondary);">Watch the steganography process step-by-step</p>
                
                <div class="process-methods">
                    <div class="method-tab active" onclick="showMethod('text')">
                        <span class="method-icon"></span>
                        <span>Text Steganography</span>
                    </div>
                    <div class="method-tab" onclick="showMethod('image')">
                        <span class="method-icon"></span>
                        <span>Image Steganography</span>
                    </div>
                </div>

                <!-- Text Method Animation -->
                <div id="method-text" class="method-animation active">
                    <div class="animation-stage">
                        <div class="stage-step stage-1">
                            <div class="step-visual">
                                <div class="visual-box">
                                    <div class="visual-icon"></div>
                                    <div class="visual-label">Cover Text</div>
                                    <div class="visual-content">"Hello World"</div>
                                </div>
                            </div>
                            <div class="step-description">
                                <div class="step-num">1</div>
                                <h3>Input Cover Text</h3>
                                <p>Start with innocent-looking text that will carry your secret message</p>
                            </div>
                        </div>

                        <div class="animated-arrow"></div>

                        <div class="stage-step stage-2">
                            <div class="step-visual">
                                <div class="visual-box processing">
                                    <div class="visual-icon"></div>
                                    <div class="visual-label">Secret Message</div>
                                    <div class="visual-content">"TOP SECRET"</div>
                                    <div class="process-particles">
                                        <span class="particle"></span>
                                        <span class="particle"></span>
                                        <span class="particle"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="step-description">
                                <div class="step-num">2</div>
                                <h3>Zero-Width Encoding</h3>
                                <p>Secret is converted to invisible zero-width characters (  )</p>
                            </div>
                        </div>

                        <div class="animated-arrow"></div>

                        <div class="stage-step stage-3">
                            <div class="step-visual">
                                <div class="visual-box success">
                                    <div class="visual-icon"></div>
                                    <div class="visual-label">Stego Text</div>
                                    <div class="visual-content">"Hello World"</div>
                                    <div class="invisible-badge">Hidden Inside!</div>
                                </div>
                            </div>
                            <div class="step-description">
                                <div class="step-num">3</div>
                                <h3>Embedding Complete</h3>
                                <p>Zero-width characters inserted between normal text - completely invisible!</p>
                            </div>
                        </div>
                    </div>

                    <div class="tech-details">
                        <div class="tech-card">
                            <div class="tech-icon"></div>
                            <div class="tech-title">Zero-Width Characters</div>
                            <div class="tech-desc">Uses Unicode characters U+200B, U+200C, U+200D that are invisible but readable by computers</div>
                        </div>
                        <div class="tech-card">
                            <div class="tech-icon"></div>
                            <div class="tech-title">AES Encryption</div>
                            <div class="tech-desc">Optional password protection with military-grade 128-bit AES encryption</div>
                        </div>
                        <div class="tech-card">
                            <div class="tech-icon"></div>
                            <div class="tech-title">100% Invisible</div>
                            <div class="tech-desc">Completely undetectable to human eyes - looks like normal text</div>
                        </div>
                    </div>
                </div>

                <!-- Image Method Animation -->
                <div id="method-image" class="method-animation">
                    <div class="animation-stage">
                        <div class="stage-step stage-1">
                            <div class="step-visual">
                                <div class="visual-box">
                                    <div class="image-preview">
                                        <div class="pixel-grid">
                                            <div class="pixel" style="background: #ff6b6b;"></div>
                                            <div class="pixel" style="background: #4ecdc4;"></div>
                                            <div class="pixel" style="background: #45b7d1;"></div>
                                            <div class="pixel" style="background: #f9ca24;"></div>
                                            <div class="pixel" style="background: #6c5ce7;"></div>
                                            <div class="pixel" style="background: #a29bfe;"></div>
                                        </div>
                                    </div>
                                    <div class="visual-label">Cover Image</div>
                                </div>
                            </div>
                            <div class="step-description">
                                <div class="step-num">1</div>
                                <h3>Select Cover Image</h3>
                                <p>Choose any PNG/JPG image to hide your secret message inside</p>
                            </div>
                        </div>

                        <div class="animated-arrow"></div>

                        <div class="stage-step stage-2">
                            <div class="step-visual">
                                <div class="visual-box processing">
                                    <div class="lsb-demo">
                                        <div class="binary-display">
                                            <div class="byte">
                                                <span class="bit">1</span>
                                                <span class="bit">1</span>
                                                <span class="bit">0</span>
                                                <span class="bit">1</span>
                                                <span class="bit">0</span>
                                                <span class="bit">0</span>
                                                <span class="bit">1</span>
                                                <span class="bit lsb">0</span>
                                            </div>
                                            <div class="arrow-down"></div>
                                            <div class="byte modified">
                                                <span class="bit">1</span>
                                                <span class="bit">1</span>
                                                <span class="bit">0</span>
                                                <span class="bit">1</span>
                                                <span class="bit">0</span>
                                                <span class="bit">0</span>
                                                <span class="bit">1</span>
                                                <span class="bit lsb">1</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="visual-label">LSB Modification</div>
                                </div>
                            </div>
                            <div class="step-description">
                                <div class="step-num">2</div>
                                <h3>Bit Manipulation</h3>
                                <p>Message encoded in least significant bits of pixel RGB values</p>
                            </div>
                        </div>

                        <div class="animated-arrow"></div>

                        <div class="stage-step stage-3">
                            <div class="step-visual">
                                <div class="visual-box success">
                                    <div class="image-preview">
                                        <div class="pixel-grid">
                                            <div class="pixel" style="background: #ff6b6c;"></div>
                                            <div class="pixel" style="background: #4ecdc5;"></div>
                                            <div class="pixel" style="background: #45b7d0;"></div>
                                            <div class="pixel" style="background: #f9ca25;"></div>
                                            <div class="pixel" style="background: #6c5ce6;"></div>
                                            <div class="pixel" style="background: #a29bff;"></div>
                                        </div>
                                        <div class="difference-badge">1 color diff</div>
                                    </div>
                                    <div class="visual-label">Stego Image</div>
                                </div>
                            </div>
                            <div class="step-description">
                                <div class="step-num">3</div>
                                <h3>Imperceptible Changes</h3>
                                <p>Image looks identical - only 1 pixel value change (99.6% similar!)</p>
                            </div>
                        </div>
                    </div>

                    <div class="tech-details">
                        <div class="tech-card">
                            <div class="tech-icon"></div>
                            <div class="tech-title">LSB Algorithm</div>
                            <div class="tech-desc">Modifies only the last bit of each color channel - changes invisible to human eye</div>
                        </div>
                        <div class="tech-card">
                            <div class="tech-icon"></div>
                            <div class="tech-title">High PSNR</div>
                            <div class="tech-desc">Peak Signal-to-Noise Ratio >40dB ensures exceptional visual quality</div>
                        </div>
                        <div class="tech-card">
                            <div class="tech-icon"></div>
                            <div class="tech-title">Good Capacity</div>
                            <div class="tech-desc">Hide ~1 character per 8 pixels - 1MB image can hide 100KB+ of text</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Performance Chart -->
            <div class="chart-section">
                <h2 class="section-title">Quality Comparison</h2>
                <p class="section-subtitle">See how different encoding methods affect image quality</p>
                <div class="chart-container">
                    <canvas id="qualityChart"></canvas>
                </div>
            </div>
        </section>

        <!-- ========================================
             TEXT ENCODE PAGE
        ======================================== -->
        <section id="page-text-encode" class="page-section">
            <div class="workspace-card">
                <div class="card-header">
                    <h2 class="card-title">Hide Message in Text</h2>
                    <p class="card-subtitle">Embed a secret message inside normal-looking text that only the recipient can read</p>
                </div>
                <div class="card-body">
                    
                    <!-- Limits Info Box -->
                    <div class="limits-info-box">
                        <h4 class="limits-info-title"> Input Limits</h4>
                        <ul class="limits-info-list">
                            <li>Cover text: <strong>100,000</strong> characters max</li>
                            <li>Secret message: <strong>50,000</strong> characters max</li>
                            <li>Password: <strong>Optional</strong> (AES-128 encryption)</li>
                        </ul>
                    </div>
                    
                    <div class="step-container">
                        <div class="step-header">
                            <div class="step-number">1</div>
                            <div class="step-title">Write Your Cover Text</div>
                        </div>
                        <div class="step-description">
                            This is the public message that everyone will see. Make it look natural and innocent - like a normal email or message.
                        </div>
                        <div class="step-help">
                             <strong>Example:</strong> "Hi Sarah! The meeting went great today. Looking forward to our coffee next week. Have a nice evening!"
                        </div>
                        <textarea id="text-encode-cover" class="input-field" placeholder="Type your public cover message here..." oninput="updateCharCounter('text-encode-cover', 100000)"></textarea>
                        <div class="char-counter" id="text-encode-cover-counter">0 / 100,000 characters</div>
                    </div>

                    <div class="step-container">
                        <div class="step-header">
                            <div class="step-number">2</div>
                            <div class="step-title">Enter Your Secret Message</div>
                        </div>
                        <div class="step-description">
                            This is the confidential information you want to hide. It will be completely invisible in the final output.
                        </div>
                        <div class="step-help">
                             <strong>Example:</strong> "Access code: BLUE-SKY-2024"
                        </div>
                        <textarea id="text-encode-secret" class="input-field" placeholder="Type your secret message here..." oninput="updateCharCounter('text-encode-secret', 50000)"></textarea>
                        <div class="char-counter" id="text-encode-secret-counter">0 / 50,000 characters</div>
                    </div>

                    <div class="step-container">
                        <div class="step-header">
                            <div class="step-number">3</div>
                            <div class="step-title">Set a Password (Recommended)</div>
                        </div>
                        <div class="step-description">
                            Add an extra layer of security. Only people with this password will be able to decrypt and read your secret.
                        </div>
                        <div class="step-help">
                             <strong>Tip:</strong> Use a strong password that you share separately with the recipient
                        </div>
                        <div class="password-input-group">
                            <input type="text" id="text-encode-password" class="input-field" placeholder="Enter a secure password (optional)">
                            <button type="button" class="btn-generate" onclick="generatePassword('text-encode-password')" title="Generate random password">
                                
                            </button>
                            <button type="button" class="btn-copy" onclick="copyPasswordToClipboard('text-encode-password')" title="Copy password">
                                
                            </button>
                        </div>
                        
                        <!-- Encryption Visualization -->
                        <div id="text-encode-viz" class="encryption-viz" style="display: none;">
                            <div class="encryption-viz-header">
                                <span class="encryption-viz-title"> AES-128 Encryption Process</span>
                                <span id="text-encode-viz-status">Encrypting...</span>
                            </div>
                            <div class="encryption-rounds" id="text-encode-rounds">
                                <!-- Rounds will be populated by JavaScript -->
                            </div>
                            <div class="encryption-progress">
                                <div class="encryption-progress-bar" id="text-encode-progress" style="width: 0%;"></div>
                            </div>
                        </div>
                    </div>

                    <button onclick="performTextEncode()" class="btn-primary"> Hide Message Now</button>

                    <div id="text-encode-result" class="result-container hidden">
                        <div class="result-header">
                            <span class="result-icon"></span>
                            <span class="result-title">Success! Message Hidden</span>
                        </div>
                        <div class="result-content">
                            <p style="margin-bottom: 16px; color: var(--gray-700); font-weight: 600;">Your text with the hidden message:</p>
                            <textarea id="text-encode-output" class="input-field" readonly style="background: var(--purple-50);"></textarea>
                        </div>
                        <div class="result-actions">
                            <button onclick="copyToClipboard('text-encode-output')" class="btn-action"> Copy to Clipboard</button>
                            <button onclick="navigate('text-decode')" class="btn-action"> Test Decoding</button>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <!-- ========================================
             TEXT DECODE PAGE
        ======================================== -->
        <section id="page-text-decode" class="page-section">
            <div class="workspace-card">
                <div class="card-header">
                    <h2 class="card-title">Reveal Hidden Message from Text</h2>
                    <p class="card-subtitle">Extract the secret message hidden inside text</p>
                </div>
                <div class="card-body">
                    
                    <div class="step-container">
                        <div class="step-header">
                            <div class="step-number">1</div>
                            <div class="step-title">Paste the Text with Hidden Message</div>
                        </div>
                        <div class="step-description">
                            Copy and paste the text that contains the hidden message you want to reveal.
                        </div>
                        <textarea id="text-decode-input" class="input-field" placeholder="Paste the text here..."></textarea>
                    </div>

                    <div class="step-container">
                        <div class="step-header">
                            <div class="step-number">2</div>
                            <div class="step-title">Enter Password (If Required)</div>
                        </div>
                        <div class="step-description">
                            If the message was encrypted with a password, enter it here to decrypt the secret.
                        </div>
                        <input type="password" id="text-decode-password" class="input-field" placeholder="Enter password if the message is encrypted">
                    </div>

                    <button onclick="performTextDecode()" class="btn-primary"> Reveal Secret</button>

                    <div id="text-decode-result" class="result-container hidden">
                        <div class="result-header">
                            <span class="result-icon"></span>
                            <span class="result-title">Secret Message Found!</span>
                        </div>
                        <div class="result-content">
                            <p id="text-decode-output" style="font-size: 1.2rem; line-height: 1.8; font-weight: 600; color: var(--purple-900);"></p>
                        </div>
                        <div class="result-actions">
                            <button onclick="copySecretText()" class="btn-action"> Copy Secret</button>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <!-- ========================================
             IMAGE ENCODE PAGE
        ======================================== -->
        <section id="page-image-encode" class="page-section">
            <div class="workspace-card">
                <div class="card-header">
                    <h2 class="card-title">Hide Message in Image</h2>
                    <p class="card-subtitle">Embed a secret message inside image pixels using LSB steganography</p>
                </div>
                <div class="card-body">
                    
                    <!-- Limits Info Box -->
                    <div class="limits-info-box">
                        <h4 class="limits-info-title"> Input Limits</h4>
                        <ul class="limits-info-list">
                            <li>Image size: <strong>4096x4096</strong> pixels max</li>
                            <li>File size: <strong>16 MB</strong> max</li>
                            <li>Secret message: <strong>50,000</strong> characters max</li>
                            <li>Formats: <strong>PNG, JPG, BMP</strong></li>
                        </ul>
                    </div>
                    
                    <div class="step-container">
                        <div class="step-header">
                            <div class="step-number">1</div>
                            <div class="step-title">Choose Your Cover Image</div>
                        </div>
                        <div class="step-description">
                            Select an image file (PNG, JPG, or BMP). Your secret will be hidden in the pixels without any visible change.
                        </div>
                        <div class="upload-zone" onclick="document.getElementById('image-encode-file').click()">
                            <input type="file" id="image-encode-file" class="file-input" style="pointer-events:none;">
                            <div class="upload-icon"></div>
                            <div class="upload-title">Drop Your Image Here</div>
                            <div class="upload-subtitle">or click to browse (PNG, JPG, BMP supported)</div>
                        </div>
                        <div id="image-encode-preview" class="preview-box hidden">
                            <img id="image-encode-preview-img" alt="Cover Image">
                        </div>
                    </div>

                    <div class="step-container">
                        <div class="step-header">
                            <div class="step-number">2</div>
                            <div class="step-title">Enter Your Secret Message</div>
                        </div>
                        <div class="step-description">
                            Type the confidential message you want to hide inside the image.
                        </div>
                        <textarea id="image-encode-secret" class="input-field" placeholder="Type your secret message..." oninput="updateCharCounter('image-encode-secret', 50000)"></textarea>
                        <div class="char-counter" id="image-encode-secret-counter">0 / 50,000 characters</div>
                    </div>

                    <div class="step-container">
                        <div class="step-header">
                            <div class="step-number">3</div>
                            <div class="step-title">Set Password (Recommended)</div>
                        </div>
                        <div class="step-description">
                            Encrypt your message with a password for maximum security.
                        </div>
                        <div class="password-input-group">
                            <input type="text" id="image-encode-password" class="input-field" placeholder="Enter a secure password">
                            <button type="button" class="btn-generate" onclick="generatePassword('image-encode-password')" title="Generate random password">
                                
                            </button>
                            <button type="button" class="btn-copy" onclick="copyPasswordToClipboard('image-encode-password')" title="Copy password">
                                
                            </button>
                        </div>
                        
                        <!-- Encryption Visualization (hidden until encoding starts) -->
                        <div id="image-encode-viz" class="encryption-viz" style="display: none;">
                            <div class="encryption-viz-header">
                                <span class="encryption-viz-title"> AES-128 Encryption Process</span>
                                <span id="image-encode-viz-status">Encrypting...</span>
                            </div>
                            <div class="encryption-rounds" id="image-encode-rounds">
                                <!-- Rounds will be populated by JavaScript -->
                            </div>
                            <div class="encryption-progress">
                                <div class="encryption-progress-bar" id="image-encode-progress" style="width: 0%;"></div>
                            </div>
                        </div>
                    </div>

                    <button onclick="performImageEncode()" class="btn-primary"> Hide Message in Image</button>

                    <div id="image-encode-result" class="result-container hidden">
                        <div class="result-header">
                            <span class="result-icon"></span>
                            <span class="result-title">Image Encoded Successfully!</span>
                        </div>

                        <div class="analytics-grid">
                            <div class="metric-card">
                                <div class="metric-value" id="img-quality">Excellent</div>
                                <div class="metric-label">Quality Rating</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value" id="img-mse">0.00</div>
                                <div class="metric-label">MSE Score</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value" id="img-psnr"></div>
                                <div class="metric-label">PSNR (dB)</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value" id="img-ssim">1.000</div>
                                <div class="metric-label">SSIM Index</div>
                            </div>
                        </div>

                        <div class="result-content">
                            <img id="image-encode-output" style="width: 100%; border-radius: 12px;" alt="Encoded Image">
                        </div>
                        <div class="result-actions">
                            <a id="image-download-link" href="#" download="secret_image.png" class="btn-primary" style="display: inline-block; text-align: center; text-decoration: none; width: auto;"> Download Image</a>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <!-- ========================================
             IMAGE DECODE PAGE
        ======================================== -->
        <section id="page-image-decode" class="page-section">
            <div class="workspace-card">
                <div class="card-header">
                    <h2 class="card-title">Extract Message from Image</h2>
                    <p class="card-subtitle">Reveal the hidden message embedded in image pixels</p>
                </div>
                <div class="card-body">
                    
                    <div class="step-container">
                        <div class="step-header">
                            <div class="step-number">1</div>
                            <div class="step-title">Upload Image with Hidden Message</div>
                        </div>
                        <div class="step-description">
                            Select the image file that contains the hidden message you want to extract.
                        </div>
                        <div class="upload-zone" onclick="document.getElementById('image-decode-file').click()">
                            <input type="file" id="image-decode-file" class="file-input" style="pointer-events:none;">
                            <div class="upload-icon"></div>
                            <div class="upload-title">Drop Image to Decode</div>
                            <div class="upload-subtitle">or click to browse</div>
                        </div>
                        <div id="image-decode-preview" class="preview-box hidden">
                            <img id="image-decode-preview-img" alt="Image to Decode">
                        </div>
                    </div>

                    <div class="step-container">
                        <div class="step-header">
                            <div class="step-number">2</div>
                            <div class="step-title">Enter Password (If Encrypted)</div>
                        </div>
                        <div class="step-description">
                            If the message was encrypted, you need the password to decrypt it.
                        </div>
                        <input type="password" id="image-decode-password" class="input-field" placeholder="Enter password if required">
                    </div>

                    <button onclick="performImageDecode()" class="btn-primary"> Extract Secret Message</button>

                    <div id="image-decode-result" class="result-container hidden">
                        <div class="result-header">
                            <span class="result-icon"></span>
                            <span class="result-title">Message Extracted!</span>
                        </div>
                        <div class="result-content">
                            <p id="image-decode-output" style="font-size: 1.2rem; line-height: 1.8; font-weight: 600; color: var(--purple-900);"></p>
                        </div>
                        <div class="result-actions">
                            <button onclick="copyImageSecret()" class="btn-action"> Copy Secret</button>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <!-- ========================================
             GUIDE PAGE
        ======================================== -->
        <section id="page-guide" class="page-section">
            <div class="guide-container">
                <div style="text-align: center; margin-bottom: 48px;">
                    <h1 style="font-size: 3rem; font-weight: 900; margin-bottom: 16px;">How Steganography Works</h1>
                    <p style="font-size: 1.2rem; color: var(--text-secondary);">Learn about hiding messages in plain sight</p>
                </div>

                <div class="guide-card">
                    <div class="guide-number">1</div>
                    <h3 class="guide-title">What is Steganography?</h3>
                    <p class="guide-text">
                        Steganography is the art of hiding secret information inside ordinary-looking data. Unlike encryption (which scrambles data), steganography conceals the very existence of the message. To an observer, the carrier text or image appears completely normal.
                    </p>
                </div>

                <div class="guide-card">
                    <div class="guide-number">2</div>
                    <h3 class="guide-title">Text Steganography (Zero-Width Characters)</h3>
                    <p class="guide-text">
                        We use Unicode zero-width characters (invisible characters) to encode your secret message. These characters are inserted between regular letters and are completely invisible to the human eye. The text looks and behaves normally, but contains hidden data that only our tool can extract.
                    </p>
                </div>

                <div class="guide-card">
                    <div class="guide-number">3</div>
                    <h3 class="guide-title">Image Steganography (LSB Method)</h3>
                    <p class="guide-text">
                        Images are made of pixels, and each pixel has color values (Red, Green, Blue). We hide data by slightly modifying the least significant bits of these color values. The changes are so small that the human eye cannot detect them, but the data can be perfectly recovered. Our quality metrics (MSE, PSNR, SSIM) confirm the image remains visually identical.
                    </p>
                </div>

                <div class="guide-card">
                    <div class="guide-number">4</div>
                    <h3 class="guide-title">Encryption Layer (AES-128)</h3>
                    <p class="guide-text">
                        When you add a password, we use AES-128 encryption (military-grade security) to encrypt your secret message before hiding it. This means even if someone discovers there's a hidden message, they can't read it without the password. This provides two layers of security: steganography (hiding) + cryptography (encryption).
                    </p>
                </div>

                <div class="guide-card">
                    <div class="guide-number">5</div>
                    <h3 class="guide-title">Best Practices</h3>
                    <p class="guide-text">
                         Always use a strong password for sensitive secrets<br>
                         Keep cover text natural and contextually appropriate<br>
                         For images, use PNG format for lossless quality<br>
                         Share the password through a separate secure channel<br>
                         Don't reuse the same cover text/image multiple times
                    </p>
                </div>
            </div>
        </section>

        <!-- ========================================
             HISTORY PAGE
        ======================================== -->
        <section id="page-history" class="page-section">
            <div class="history-panel">
                <div class="history-header">
                    <h2 class="history-title"> Operation History</h2>
                    <div class="history-actions">
                        <button class="btn-action" onclick="refreshHistory()"> Refresh</button>
                        <button class="btn-action" onclick="clearAllHistory()" style="color: #ef4444;"> Clear All</button>
                    </div>
                </div>
                
                <div id="history-stats" class="analytics-grid" style="padding: 24px;">
                    <div class="metric-card">
                        <div class="metric-value" id="history-total">0</div>
                        <div class="metric-label">Total Operations</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="history-encodes">0</div>
                        <div class="metric-label">Encodes</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="history-decodes">0</div>
                        <div class="metric-label">Decodes</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="history-encrypted">0</div>
                        <div class="metric-label">Encrypted</div>
                    </div>
                </div>
                
                <div id="history-list" class="history-list">
                    <div class="history-empty">
                        <div class="history-empty-icon"></div>
                        <p>No history yet. Start encoding or decoding messages!</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================================
             ACCOUNT SETTINGS PAGE
        ======================================== -->
        <section id="page-account" class="page-section">
            <!-- Account Header with Avatar -->
            <div class="account-hero">
                <div class="account-avatar-large" id="account-avatar-display">
                    <span id="account-avatar-letter">?</span>
                </div>
                <h1 class="account-name" id="account-display-name">Welcome</h1>
                <p class="account-email-display" id="account-email-display">Sign in to view your account</p>
                <div class="account-stats-row">
                    <div class="account-stat">
                        <span class="account-stat-value" id="account-stat-encodes">0</span>
                        <span class="account-stat-label">Encodes</span>
                    </div>
                    <div class="account-stat">
                        <span class="account-stat-value" id="account-stat-decodes">0</span>
                        <span class="account-stat-label">Decodes</span>
                    </div>
                    <div class="account-stat">
                        <span class="account-stat-value" id="account-stat-encrypted">0</span>
                        <span class="account-stat-label">Encrypted</span>
                    </div>
                </div>
            </div>
            
            <!-- Settings Cards Grid -->
            <div class="settings-grid">
                <!-- Profile Card -->
                <div class="settings-card">
                    <div class="settings-card-header">
                        <div class="settings-card-icon"></div>
                        <h3 class="settings-card-title">Profile Information</h3>
                    </div>
                    <div class="settings-card-body">
                        <div class="profile-info-row">
                            <span class="profile-label">Username</span>
                            <span class="profile-value" id="account-username">-</span>
                        </div>
                        <div class="profile-info-row">
                            <span class="profile-label">Email</span>
                            <span class="profile-value" id="account-email">-</span>
                        </div>
                        <div class="profile-info-row">
                            <span class="profile-label">Member Since</span>
                            <span class="profile-value" id="account-created">-</span>
                        </div>
                    </div>
                </div>
                
                <!-- Security Card -->
                <div class="settings-card">
                    <div class="settings-card-header">
                        <div class="settings-card-icon"></div>
                        <h3 class="settings-card-title">Change Password</h3>
                    </div>
                    <div class="settings-card-body">
                        <div class="auth-form-group">
                            <label class="auth-form-label">Current Password</label>
                            <input type="password" id="current-password" class="input-field" placeholder="Enter current password">
                        </div>
                        <div class="auth-form-group">
                            <label class="auth-form-label">New Password</label>
                            <input type="password" id="new-password" class="input-field" placeholder="Enter new password">
                        </div>
                        <div class="auth-form-group">
                            <label class="auth-form-label">Confirm New Password</label>
                            <input type="password" id="confirm-new-password" class="input-field" placeholder="Confirm new password">
                        </div>
                        <button onclick="handleChangePassword()" class="settings-btn primary"> Update Password</button>
                    </div>
                </div>
                
                <!-- Danger Zone Card -->
                <div class="settings-card danger">
                    <div class="settings-card-header">
                        <div class="settings-card-icon danger"></div>
                        <h3 class="settings-card-title danger">Danger Zone</h3>
                    </div>
                    <div class="settings-card-body">
                        <p class="danger-warning">Once you delete your account, there is no going back. All your data, history, and preferences will be permanently removed.</p>
                        <button onclick="handleDeleteAccount()" class="settings-btn danger"> Delete My Account</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================================
             STEGANOGRAPHY HISTORY PAGE
        ======================================== -->
        <section id="page-stego-history" class="page-section">
            <div class="workspace-card">
                <div class="card-header">
                    <h2 class="card-title"> History of Steganography</h2>
                    <p class="card-subtitle">Famous cases, techniques, and attacks throughout history</p>
                </div>
                <div class="card-body">
                    
                    <!-- Timeline Section -->
                    <div class="history-section">
                        <h3 class="history-section-title"> Historical Timeline</h3>
                        
                        <div class="history-timeline">
                            <div class="timeline-item">
                                <div class="timeline-year">440 BC</div>
                                <div class="timeline-content">
                                    <h4>Ancient Greece - Histiaeus</h4>
                                    <p>The first recorded use of steganography. Histiaeus shaved a slave's head, tattooed a message on his scalp, waited for hair to regrow, then sent him to deliver the hidden message.</p>
                                </div>
                            </div>
                            
                            <div class="timeline-item">
                                <div class="timeline-year">1499</div>
                                <div class="timeline-content">
                                    <h4>Johannes Trithemius</h4>
                                    <p>Published "Steganographia" - the first book on the art of hidden writing. Though it appeared to be about magic, it actually contained sophisticated encryption techniques.</p>
                                </div>
                            </div>
                            
                            <div class="timeline-item">
                                <div class="timeline-year">WWII</div>
                                <div class="timeline-content">
                                    <h4>Microdots & Invisible Ink</h4>
                                    <p>German spies used microdots - photographs shrunk to the size of a period that could contain an entire page of text. Allies also used invisible ink made from various chemicals.</p>
                                </div>
                            </div>
                            
                            <div class="timeline-item">
                                <div class="timeline-year">1985</div>
                                <div class="timeline-content">
                                    <h4>Digital Steganography Begins</h4>
                                    <p>With the rise of digital images and the internet, steganography evolved into hiding data in digital files using techniques like LSB (Least Significant Bit) encoding.</p>
                                </div>
                            </div>
                            
                            <div class="timeline-item">
                                <div class="timeline-year">2001</div>
                                <div class="timeline-content">
                                    <h4>Post-9/11 Concerns</h4>
                                    <p>Reports suggested terrorists may have used steganography to communicate. This led to increased research in steganalysis - the art of detecting hidden messages.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Famous Cases Section -->
                    <div class="history-section">
                        <h3 class="history-section-title"> Famous Cases & Examples</h3>
                        
                        <div class="history-cases-grid">
                            <div class="history-case-card">
                                <div class="case-icon"></div>
                                <h4>Operation Bernhard (WWII)</h4>
                                <p>Nazi Germany's plan to destabilize Britain by flooding the economy with counterfeit pound notes. Messages were hidden in the watermarks of the forged currency.</p>
                                <div class="case-tag">Wartime</div>
                            </div>
                            
                            <div class="history-case-card">
                                <div class="case-icon"></div>
                                <h4>Bin Laden's Steganography</h4>
                                <p>After 9/11, rumors circulated that Al-Qaeda used steganography in images on eBay and pornographic websites to coordinate attacks. While never proven, it sparked major research.</p>
                                <div class="case-tag">Modern</div>
                            </div>
                            
                            <div class="history-case-card">
                                <div class="case-icon"></div>
                                <h4>Russian Spy Ring (2010)</h4>
                                <p>The FBI caught Russian sleeper agents who embedded secret messages in images posted on public websites. The "Illegals Program" used sophisticated digital steganography.</p>
                                <div class="case-tag">Espionage</div>
                            </div>
                            
                            <div class="history-case-card">
                                <div class="case-icon"></div>
                                <h4>Audio Steganography</h4>
                                <p>Musicians have hidden messages in albums - from The Beatles' "Revolution 9" (play backward) to Aphex Twin's spectrogram face hidden in "Equation" audio frequencies.</p>
                                <div class="case-tag">Entertainment</div>
                            </div>
                            
                            <div class="history-case-card">
                                <div class="case-icon"></div>
                                <h4>Null Cipher in WWII</h4>
                                <p>German spy Velvalee Dickinson sent letters about "dolls" to contacts in South America. Reading every first letter of each word revealed hidden military intelligence.</p>
                                <div class="case-tag">Classic</div>
                            </div>
                            
                            <div class="history-case-card">
                                <div class="case-icon"></div>
                                <h4>Printer Tracking Dots</h4>
                                <p>Many color printers secretly embed nearly invisible yellow dots that encode the printer's serial number and timestamp. NSA leaker Reality Winner was caught this way in 2017.</p>
                                <div class="case-tag">Forensics</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Steganalysis Attacks Section -->
                    <div class="history-section">
                        <h3 class="history-section-title"> Steganalysis Attacks</h3>
                        <p style="margin-bottom: 24px; color: var(--text-secondary);">Techniques used to detect hidden messages in digital files</p>
                        
                        <div class="attack-grid">
                            <div class="attack-card">
                                <div class="attack-header">
                                    <span class="attack-icon"></span>
                                    <h4>Statistical Analysis</h4>
                                </div>
                                <p>Analyzes the statistical properties of pixel values. LSB embedding often disrupts natural distributions, creating detectable anomalies in histograms.</p>
                                <div class="attack-effectiveness">
                                    <span>Effectiveness:</span>
                                    <div class="effectiveness-bar"><div style="width: 85%;"></div></div>
                                </div>
                            </div>
                            
                            <div class="attack-card">
                                <div class="attack-header">
                                    <span class="attack-icon"></span>
                                    <h4>Chi-Square Attack</h4>
                                </div>
                                <p>Detects sequential LSB embedding by measuring the probability that pixel pairs differ. Clean images have specific statistical patterns that steganography disrupts.</p>
                                <div class="attack-effectiveness">
                                    <span>Effectiveness:</span>
                                    <div class="effectiveness-bar"><div style="width: 90%;"></div></div>
                                </div>
                            </div>
                            
                            <div class="attack-card">
                                <div class="attack-header">
                                    <span class="attack-icon"></span>
                                    <h4>Machine Learning Detection</h4>
                                </div>
                                <p>Neural networks trained on thousands of clean and stego images can detect subtle patterns invisible to traditional analysis. CNNs achieve >95% accuracy.</p>
                                <div class="attack-effectiveness">
                                    <span>Effectiveness:</span>
                                    <div class="effectiveness-bar"><div style="width: 95%;"></div></div>
                                </div>
                            </div>
                            
                            <div class="attack-card">
                                <div class="attack-header">
                                    <span class="attack-icon"></span>
                                    <h4>Visual Attack</h4>
                                </div>
                                <p>Extracts and enhances the least significant bit plane. In stego images, this reveals patterns; in clean images, it appears random. Simple but effective.</p>
                                <div class="attack-effectiveness">
                                    <span>Effectiveness:</span>
                                    <div class="effectiveness-bar"><div style="width: 70%;"></div></div>
                                </div>
                            </div>
                            
                            <div class="attack-card">
                                <div class="attack-header">
                                    <span class="attack-icon"></span>
                                    <h4>RS Analysis</h4>
                                </div>
                                <p>Regular-Singular analysis divides image into groups and measures how flipping LSBs affects "smoothness." Stego images show characteristic RS patterns.</p>
                                <div class="attack-effectiveness">
                                    <span>Effectiveness:</span>
                                    <div class="effectiveness-bar"><div style="width: 80%;"></div></div>
                                </div>
                            </div>
                            
                            <div class="attack-card">
                                <div class="attack-header">
                                    <span class="attack-icon"></span>
                                    <h4>Sample Pair Analysis</h4>
                                </div>
                                <p>Examines pairs of pixels to estimate the embedding rate. Can detect even low-capacity embedding and estimate how much data is hidden.</p>
                                <div class="attack-effectiveness">
                                    <span>Effectiveness:</span>
                                    <div class="effectiveness-bar"><div style="width: 75%;"></div></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Modern Techniques Section -->
                    <div class="history-section">
                        <h3 class="history-section-title"> Modern Steganography Techniques</h3>
                        
                        <div class="techniques-grid">
                            <div class="technique-card">
                                <h4> Image Steganography</h4>
                                <ul>
                                    <li><strong>LSB Embedding:</strong> Replaces least significant bits of pixels</li>
                                    <li><strong>DCT Domain:</strong> Hides data in JPEG compression coefficients</li>
                                    <li><strong>Spread Spectrum:</strong> Spreads message across frequency domain</li>
                                    <li><strong>Adaptive:</strong> Embeds only in "noisy" image regions</li>
                                </ul>
                            </div>
                            
                            <div class="technique-card">
                                <h4> Audio Steganography</h4>
                                <ul>
                                    <li><strong>Echo Hiding:</strong> Encodes data in sound echoes</li>
                                    <li><strong>Phase Coding:</strong> Modifies audio phase components</li>
                                    <li><strong>Spread Spectrum:</strong> Hides in audio frequency spread</li>
                                    <li><strong>MP3 Stego:</strong> Embeds in compression artifacts</li>
                                </ul>
                            </div>
                            
                            <div class="technique-card">
                                <h4> Text Steganography</h4>
                                <ul>
                                    <li><strong>Zero-Width Characters:</strong> Invisible Unicode characters</li>
                                    <li><strong>Whitespace:</strong> Extra spaces and tabs encode bits</li>
                                    <li><strong>Semantic:</strong> Word substitution with synonyms</li>
                                    <li><strong>Format-Based:</strong> Font, size, or color variations</li>
                                </ul>
                            </div>
                            
                            <div class="technique-card">
                                <h4> Network Steganography</h4>
                                <ul>
                                    <li><strong>Protocol Fields:</strong> Unused TCP/IP header fields</li>
                                    <li><strong>Timing Channels:</strong> Packet timing encodes data</li>
                                    <li><strong>DNS Tunneling:</strong> Data in DNS queries</li>
                                    <li><strong>ICMP Covert:</strong> Hidden in ping packets</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Fun Facts Section -->
                    <div class="history-section">
                        <h3 class="history-section-title"> Fun Facts</h3>
                        <div class="fun-facts-grid">
                            <div class="fun-fact">
                                <span class="fun-fact-icon"></span>
                                <p>In the movie "A Beautiful Mind," John Nash discovers hidden Soviet messages in newspapers - a dramatization of real Cold War paranoia about steganography.</p>
                            </div>
                            <div class="fun-fact">
                                <span class="fun-fact-icon"></span>
                                <p>A typical 1080p image can hide approximately 2.5 MB of data using advanced LSB techniques without visible quality loss.</p>
                            </div>
                            <div class="fun-fact">
                                <span class="fun-fact-icon"></span>
                                <p>Some apps use steganography to watermark screenshots, allowing companies to trace leaks back to specific users.</p>
                            </div>
                            <div class="fun-fact">
                                <span class="fun-fact-icon"></span>
                                <p>Video game developers have hidden messages in game files. Minecraft famously contains the phrase "FOLLOW THE RABBIT" in its audio files.</p>
                            </div>
                        </div>
                    </div>
                    
                </div>
            </div>
        </section>

    </div>

    <script>
        // Automatically use the correct API endpoint
        const API_BASE = window.location.hostname === 'localhost' 
            ? 'http://localhost:5000/api' 
            : `${window.location.protocol}//${window.location.host}/api`;
        
        let coverImageData = null;
        let stegoImageData = null;
        let decodeImageData = null;
        
        // System limits (will be loaded from API)
        let systemLimits = {
            max_text_length: 100000,
            max_secret_length: 50000,
            max_image_dimension: 4096
        };
        
        // Auth state
        let authState = {
            isLoggedIn: false,
            user: null,
            accessToken: null,
            refreshToken: null
        };

        // Statistics tracking
        let stats = {
            encodes: 0,
            decodes: 0,
            totalTime: 0,
            operations: 0
        };
        
        // ============================================================================
        // THEME TOGGLE FUNCTIONS
        // ============================================================================
        
        function initTheme() {
            // Check localStorage for saved theme
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                document.documentElement.setAttribute('data-theme', savedTheme);
            } else {
                // Check system preference
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                document.documentElement.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
            }
        }
        
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            // Animate the toggle button
            const toggle = document.querySelector('.theme-toggle');
            toggle.style.transform = 'scale(0.8) rotate(360deg)';
            setTimeout(() => {
                toggle.style.transform = 'scale(1) rotate(0deg)';
            }, 300);
        }
        
        // Initialize theme on page load
        initTheme();
        
        // ============================================================================
        // PASSWORD GENERATOR FUNCTIONS
        // ============================================================================
        
        function generatePassword(inputId) {
            const length = 16;
            const uppercase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const lowercase = 'abcdefghijklmnopqrstuvwxyz';
            const numbers = '0123456789';
            const symbols = '!@#$%^&*()_+-=[]{}|;:,.<>?';
            const allChars = uppercase + lowercase + numbers + symbols;
            
            let password = '';
            // Ensure at least one of each type
            password += uppercase[Math.floor(Math.random() * uppercase.length)];
            password += lowercase[Math.floor(Math.random() * lowercase.length)];
            password += numbers[Math.floor(Math.random() * numbers.length)];
            password += symbols[Math.floor(Math.random() * symbols.length)];
            
            // Fill the rest randomly
            for (let i = 4; i < length; i++) {
                password += allChars[Math.floor(Math.random() * allChars.length)];
            }
            
            // Shuffle the password
            password = password.split('').sort(() => Math.random() - 0.5).join('');
            
            // Set the password
            const input = document.getElementById(inputId);
            if (input) {
                input.value = password;
                input.type = 'text'; // Show the password
                
                // Flash animation
                input.style.transition = 'background-color 0.3s';
                input.style.backgroundColor = 'rgba(16, 185, 129, 0.2)';
                setTimeout(() => {
                    input.style.backgroundColor = '';
                }, 300);
            }
            
            showNotification(' Strong password generated!', 'success');
        }
        
        function copyPasswordToClipboard(inputId) {
            const input = document.getElementById(inputId);
            if (input && input.value) {
                navigator.clipboard.writeText(input.value).then(() => {
                    showNotification(' Password copied to clipboard!', 'success');
                }).catch(err => {
                    showNotification('Failed to copy password', 'error');
                });
            } else {
                showNotification('No password to copy', 'warning');
            }
        }
        // ============================================================================
        // AUTH FUNCTIONS
        // ============================================================================
        
        function openAuthModal(type = 'login') {
            document.getElementById('auth-modal').classList.add('active');
            if (type === 'signup') {
                showSignupForm();
            } else {
                showLoginForm();
            }
        }
        
        function closeAuthModal() {
            document.getElementById('auth-modal').classList.remove('active');
            clearAuthErrors();
        }
        
        function showLoginForm() {
            document.getElementById('login-form').classList.remove('hidden');
            document.getElementById('signup-form').classList.add('hidden');
            clearAuthErrors();
        }
        
        function showSignupForm() {
            document.getElementById('login-form').classList.add('hidden');
            document.getElementById('signup-form').classList.remove('hidden');
            clearAuthErrors();
        }
        
        function clearAuthErrors() {
            document.querySelectorAll('.auth-form-error').forEach(el => {
                el.classList.remove('show');
                el.textContent = '';
            });
            document.querySelectorAll('.auth-form-input').forEach(el => {
                el.classList.remove('error');
            });
        }
        
        function showAuthError(fieldId, message) {
            const input = document.getElementById(fieldId);
            const error = document.getElementById(fieldId + '-error');
            if (input) input.classList.add('error');
            if (error) {
                error.textContent = message;
                error.classList.add('show');
            }
        }
        
        function updatePasswordStrength() {
            const password = document.getElementById('signup-password').value;
            const bar = document.getElementById('password-strength-bar');
            
            let strength = 0;
            if (password.length >= 8) strength++;
            if (/[A-Z]/.test(password)) strength++;
            if (/[a-z]/.test(password)) strength++;
            if (/[0-9]/.test(password)) strength++;
            if (/[!@#$%^&*()_+\-=\[\]{}|;:,.<>?]/.test(password)) strength++;
            
            bar.className = 'password-strength-bar';
            if (strength === 0) bar.style.width = '0%';
            else if (strength <= 2) bar.classList.add('weak');
            else if (strength === 3) bar.classList.add('fair');
            else if (strength === 4) bar.classList.add('good');
            else bar.classList.add('strong');
        }
        
        async function handleLogin() {
            clearAuthErrors();
            
            const username = document.getElementById('login-username').value.trim();
            const password = document.getElementById('login-password').value;
            
            if (!username) {
                showAuthError('login-username', 'Username or email is required');
                return;
            }
            if (!password) {
                showAuthError('login-password', 'Password is required');
                return;
            }
            
            showLoading(true);
            try {
                const response = await fetch(`${API_BASE}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        username_or_email: username,
                        password: password
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    // Save auth state
                    authState = {
                        isLoggedIn: true,
                        user: data.user,
                        accessToken: data.access_token,
                        refreshToken: data.refresh_token
                    };
                    localStorage.setItem('auth', JSON.stringify(authState));
                    
                    updateAuthUI();
                    closeAuthModal();
                    showToast(' Welcome back, ' + data.user.username + '!');
                } else {
                    showAuthError('login-password', data.error || 'Login failed');
                }
            } catch (error) {
                showAuthError('login-password', 'Connection error. Please try again.');
            }
            showLoading(false);
        }
        
        async function handleSignup() {
            clearAuthErrors();
            
            const username = document.getElementById('signup-username').value.trim();
            const email = document.getElementById('signup-email').value.trim();
            const password = document.getElementById('signup-password').value;
            const confirm = document.getElementById('signup-confirm').value;
            
            // Validation
            if (!username) {
                showAuthError('signup-username', 'Username is required');
                return;
            }
            if (username.length < 3) {
                showAuthError('signup-username', 'Username must be at least 3 characters');
                return;
            }
            if (!email) {
                showAuthError('signup-email', 'Email is required');
                return;
            }
            if (!email.includes('@')) {
                showAuthError('signup-email', 'Invalid email format');
                return;
            }
            if (!password) {
                showAuthError('signup-password', 'Password is required');
                return;
            }
            if (password.length < 8) {
                showAuthError('signup-password', 'Password must be at least 8 characters');
                return;
            }
            if (password !== confirm) {
                showAuthError('signup-confirm', 'Passwords do not match');
                return;
            }
            
            showLoading(true);
            try {
                const response = await fetch(`${API_BASE}/auth/signup`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, email, password })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    authState = {
                        isLoggedIn: true,
                        user: data.user,
                        accessToken: data.access_token,
                        refreshToken: data.refresh_token
                    };
                    localStorage.setItem('auth', JSON.stringify(authState));
                    
                    updateAuthUI();
                    closeAuthModal();
                    showToast(' Account created! Welcome, ' + data.user.username + '!');
                } else {
                    // Show specific field errors
                    const error = data.error.toLowerCase();
                    if (error.includes('username')) {
                        showAuthError('signup-username', data.error);
                    } else if (error.includes('email')) {
                        showAuthError('signup-email', data.error);
                    } else if (error.includes('password')) {
                        showAuthError('signup-password', data.error);
                    } else {
                        showAuthError('signup-password', data.error);
                    }
                }
            } catch (error) {
                showAuthError('signup-password', 'Connection error. Please try again.');
            }
            showLoading(false);
        }
        
        async function handleLogout() {
            showLoading(true);
            try {
                if (authState.accessToken) {
                    await fetch(`${API_BASE}/auth/logout`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${authState.accessToken}`
                        },
                        body: JSON.stringify({ refresh_token: authState.refreshToken })
                    });
                }
            } catch (e) {
                // Ignore errors on logout
            }
            
            authState = { isLoggedIn: false, user: null, accessToken: null, refreshToken: null };
            localStorage.removeItem('auth');
            updateAuthUI();
            closeUserDropdown();
            navigate('home');
            showToast(' Logged out successfully');
            showLoading(false);
        }
        
        function updateAuthUI() {
            const authButtons = document.getElementById('auth-buttons');
            const userMenu = document.getElementById('user-menu');
            const navHistory = document.getElementById('nav-history');
            
            if (authState.isLoggedIn && authState.user) {
                authButtons.style.display = 'none';
                userMenu.classList.add('active');
                navHistory.style.display = 'block';
                
                // Update user info
                document.getElementById('user-avatar').textContent = authState.user.username.charAt(0).toUpperCase();
                document.getElementById('user-dropdown-name').textContent = authState.user.username;
                document.getElementById('user-dropdown-email').textContent = authState.user.email;
                
                // Update account page
                document.getElementById('account-username').textContent = authState.user.username;
                document.getElementById('account-email').textContent = authState.user.email;
                
                // Update new account hero section
                document.getElementById('account-avatar-letter').textContent = authState.user.username.charAt(0).toUpperCase();
                document.getElementById('account-display-name').textContent = authState.user.username;
                document.getElementById('account-email-display').textContent = authState.user.email;
            } else {
                authButtons.style.display = 'flex';
                userMenu.classList.remove('active');
                navHistory.style.display = 'none';
            }
        }
        
        function toggleUserDropdown() {
            document.getElementById('user-dropdown').classList.toggle('show');
        }
        
        function closeUserDropdown() {
            document.getElementById('user-dropdown').classList.remove('show');
        }
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.user-menu')) {
                closeUserDropdown();
            }
        });
        
        function getAuthHeaders() {
            if (authState.accessToken) {
                return { 'Authorization': `Bearer ${authState.accessToken}` };
            }
            return {};
        }
        
        // Token refresh
        async function refreshAccessToken() {
            if (!authState.refreshToken) return false;
            
            try {
                const response = await fetch(`${API_BASE}/auth/refresh`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ refresh_token: authState.refreshToken })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    authState.accessToken = data.access_token;
                    localStorage.setItem('auth', JSON.stringify(authState));
                    return true;
                }
            } catch (e) {
                console.error('Token refresh failed:', e);
            }
            
            // Refresh failed, log out
            authState = { isLoggedIn: false, user: null, accessToken: null, refreshToken: null };
            localStorage.removeItem('auth');
            updateAuthUI();
            return false;
        }
        
        // ============================================================================
        // HISTORY FUNCTIONS
        // ============================================================================
        
        async function loadAccountStats() {
            if (!authState.isLoggedIn) return;
            
            try {
                const response = await fetch(`${API_BASE}/history/stats`, {
                    headers: { ...getAuthHeaders() }
                });
                const data = await response.json();
                if (data.success) {
                    document.getElementById('account-stat-encodes').textContent = data.stats.encodes || 0;
                    document.getElementById('account-stat-decodes').textContent = data.stats.decodes || 0;
                    document.getElementById('account-stat-encrypted').textContent = data.stats.encrypted_operations || 0;
                }
            } catch (e) {
                console.error('Failed to load account stats:', e);
            }
        }
        
        async function loadHistory() {
            if (!authState.isLoggedIn) return;
            
            try {
                const response = await fetch(`${API_BASE}/history`, {
                    headers: { ...getAuthHeaders() }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    renderHistory(data.history);
                    
                    // Load stats
                    const statsResponse = await fetch(`${API_BASE}/history/stats`, {
                        headers: { ...getAuthHeaders() }
                    });
                    const statsData = await statsResponse.json();
                    if (statsData.success) {
                        document.getElementById('history-total').textContent = statsData.stats.total_operations;
                        document.getElementById('history-encodes').textContent = statsData.stats.encodes;
                        document.getElementById('history-decodes').textContent = statsData.stats.decodes;
                        document.getElementById('history-encrypted').textContent = statsData.stats.encrypted_operations;
                    }
                }
            } catch (e) {
                console.error('Failed to load history:', e);
            }
        }
        
        function renderHistory(items) {
            const container = document.getElementById('history-list');
            
            if (!items || items.length === 0) {
                container.innerHTML = `
                    <div class="history-empty">
                        <div class="history-empty-icon"></div>
                        <p>No history yet. Start encoding or decoding messages!</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = items.map(item => `
                <div class="history-item" data-id="${item.id}">
                    <div class="history-item-icon ${item.operation_type}">
                        ${item.operation_type === 'encode' ? '' : ''}
                    </div>
                    <div class="history-item-content">
                        <div class="history-item-title">
                            ${item.operation_type === 'encode' ? 'Encoded' : 'Decoded'} message
                            <span class="history-item-badge ${item.algorithm}">${item.algorithm.toUpperCase()}</span>
                            ${item.is_encrypted ? '<span class="history-item-badge encrypted"> Encrypted</span>' : ''}
                        </div>
                        <div class="history-item-meta">
                            <span>${item.input_preview ? item.input_preview.substring(0, 50) + '...' : '[Data]'}</span>
                            <span></span>
                            <span>${new Date(item.created_at).toLocaleString()}</span>
                        </div>
                    </div>
                    <button class="history-item-delete" onclick="deleteHistoryItem(${item.id})"></button>
                </div>
            `).join('');
        }
        
        async function deleteHistoryItem(id) {
            if (!confirm('Delete this history item?')) return;
            
            try {
                const response = await fetch(`${API_BASE}/history/${id}`, {
                    method: 'DELETE',
                    headers: { ...getAuthHeaders() }
                });
                
                if (response.ok) {
                    loadHistory();
                    showToast(' History item deleted');
                }
            } catch (e) {
                showToast(' Failed to delete');
            }
        }
        
        async function clearAllHistory() {
            if (!confirm('Clear all history? This cannot be undone.')) return;
            
            try {
                const response = await fetch(`${API_BASE}/history`, {
                    method: 'DELETE',
                    headers: { ...getAuthHeaders() }
                });
                
                const data = await response.json();
                if (data.success) {
                    loadHistory();
                    showToast(' All history cleared');
                }
            } catch (e) {
                showToast(' Failed to clear history');
            }
        }
        
        function refreshHistory() {
            loadHistory();
            showToast(' History refreshed');
        }
        
        // ============================================================================
        // ACCOUNT FUNCTIONS
        // ============================================================================
        
        async function handleChangePassword() {
            const current = document.getElementById('current-password').value;
            const newPass = document.getElementById('new-password').value;
            const confirm = document.getElementById('confirm-new-password').value;
            
            if (!current || !newPass || !confirm) {
                showToast(' Please fill in all password fields');
                return;
            }
            
            if (newPass !== confirm) {
                showToast(' New passwords do not match');
                return;
            }
            
            showLoading(true);
            try {
                const response = await fetch(`${API_BASE}/auth/password`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        ...getAuthHeaders()
                    },
                    body: JSON.stringify({
                        current_password: current,
                        new_password: newPass
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    document.getElementById('current-password').value = '';
                    document.getElementById('new-password').value = '';
                    document.getElementById('confirm-new-password').value = '';
                    showToast(' Password changed successfully');
                } else {
                    showToast(' ' + data.error);
                }
            } catch (e) {
                showToast(' Failed to change password');
            }
            showLoading(false);
        }
        
        async function handleDeleteAccount() {
            const password = prompt('Enter your password to confirm account deletion:');
            if (!password) return;
            
            if (!confirm('Are you SURE you want to delete your account? This cannot be undone!')) return;
            
            showLoading(true);
            try {
                const response = await fetch(`${API_BASE}/auth/account`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json',
                        ...getAuthHeaders()
                    },
                    body: JSON.stringify({ password })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    authState = { isLoggedIn: false, user: null, accessToken: null, refreshToken: null };
                    localStorage.removeItem('auth');
                    updateAuthUI();
                    navigate('home');
                    showToast(' Account deleted. Goodbye!');
                } else {
                    showToast(' ' + data.error);
                }
            } catch (e) {
                showToast(' Failed to delete account');
            }
            showLoading(false);
        }
        
        // ============================================================================
        // SYSTEM LIMITS
        // ============================================================================
        
        async function loadSystemLimits() {
            try {
                const response = await fetch(`${API_BASE}/limits`);
                const data = await response.json();
                if (data.success) {
                    systemLimits = data.limits;
                }
            } catch (e) {
                console.error('Failed to load limits:', e);
            }
        }

        function updateStats(type, time) {
            if (type === 'encode') stats.encodes++;
            if (type === 'decode') stats.decodes++;
            stats.totalTime += time;
            stats.operations++;

            document.getElementById('stat-encodes').textContent = stats.encodes;
            document.getElementById('stat-decodes').textContent = stats.decodes;
            document.getElementById('stat-speed').textContent = Math.round(stats.totalTime / stats.operations) + 'ms';
            
            // Animate progress bars
            const maxOps = Math.max(stats.encodes, stats.decodes, 1);
            document.querySelector('.stat-card:nth-child(1) .stat-bar-fill').style.width = (stats.encodes / maxOps * 100) + '%';
            document.querySelector('.stat-card:nth-child(2) .stat-bar-fill').style.width = (stats.decodes / maxOps * 100) + '%';
            
            // Update chart
            if (window.qualityChart) {
                updateChart();
            }
        }

        // Sample demos
        function loadTextSample() {
            navigate('text-encode');
            setTimeout(() => {
                document.getElementById('text-encode-cover').value = `Subject: Q4 Marketing Campaign Update

Dear Marketing Team,

I hope this email finds you well. I wanted to share some exciting updates regarding our Q4 marketing campaign performance.

Our recent social media initiatives have shown promising results:
- Instagram engagement increased by 34%
- Twitter followers grew by 2,150 users
- Facebook reach expanded to 45,000 impressions

The content calendar for next month has been finalized, and we're ready to launch the holiday season promotions starting December 1st.

Please review the attached analytics report and let me know if you have any questions during our Friday meeting.

Best regards,
Sarah Mitchell
Senior Marketing Manager
TechCorp Solutions`;

                document.getElementById('text-encode-secret').value = `CONFIDENTIAL: Project Phoenix launch date moved to March 15th. Budget approved $2.5M. Key stakeholders: Anderson, Chen, Rodriguez. Competitor analysis shows 6-month lead advantage. Board approval secured. NDA required for all participants.`;
                
                document.getElementById('text-encode-password').value = "SecurePass2024!";
                
                showToast(' Realistic business email loaded with hidden corporate intel! Click "Hide Message" below');
            }, 300);
        }

        function loadJournalistSample() {
            navigate('text-encode');
            setTimeout(() => {
                document.getElementById('text-encode-cover').value = `Breaking: Tech Giant Announces New Privacy Initiative

San Francisco, CA - In a major policy shift, TechCorp announced today a comprehensive overhaul of its user data protection policies. The company's CEO stated that user privacy will become a "fundamental pillar" of all future products.

The initiative includes end-to-end encryption for all communications, enhanced transparency reports, and a new user data control dashboard. Industry analysts believe this move could pressure competitors to follow suit.

The changes will roll out gradually over the next six months, with full implementation expected by Q2 2024. Users will receive notifications as new features become available.

For more information, visit the company's privacy portal or contact their press office.`;

                document.getElementById('text-encode-secret').value = `SOURCE PROTECTED: Whistleblower identity: Dr. Lisa Chen, Senior Engineer. Meeting location: Golden Gate Park, north entrance, Dec 5th 3PM. Documents prove data breach cover-up. Use encrypted channel only. Code word: "Firefly"`;
                
                document.getElementById('text-encode-password').value = "journalist2024";
                
                showToast(' News article loaded with protected source information!');
            }, 300);
        }

        function loadSocialSample() {
            navigate('text-encode');
            setTimeout(() => {
                document.getElementById('text-encode-cover').value = `Just had the most amazing coffee at this new spot downtown!  

The vibes are immaculate and the barista made the perfect latte art  Definitely my new favorite hangout spot for getting work done.

Anyone else been here? Drop your fave coffee shops in the comments! 

#CoffeeLovers #CafeVibes #WorkFromCafe #LatteArt #LocalBusiness #CoffeeCommunity`;

                document.getElementById('text-encode-secret').value = `Flash mob dance performance this Saturday at Central Park fountain, 2PM sharp. Wear red. Learn the routine: bit.ly/flashdance2024. Surprise for Emma's birthday. Don't tell her!`;
                
                document.getElementById('text-encode-password').value = "";
                
                showToast(' Social media post loaded with hidden event coordinates!');
            }, 300);
        }

        function loadEncryptedSample() {
            navigate('text-encode');
            setTimeout(() => {
                document.getElementById('text-encode-cover').value = `MEMORANDUM

TO: All Department Heads
FROM: Office of Administration
DATE: November 24, 2025
RE: Annual Strategic Planning Meeting

The annual strategic planning meeting has been scheduled for January 15-17, 2026, at the corporate headquarters conference center.

All department heads are required to submit their preliminary budget proposals and strategic objectives by December 20, 2025. Please use the standardized template available on the intranet.

Key discussion topics will include:
 Departmental goals and KPIs for 2026
 Cross-functional collaboration initiatives  
 Technology infrastructure upgrades
 Talent acquisition and retention strategies

Please confirm your attendance by responding to this memo. Contact HR for travel arrangements if required.

Thank you for your cooperation.`;

                document.getElementById('text-encode-secret').value = `CLASSIFIED: Merger talks with GlobalTech progressing. Acquisition target $4.2B. Due diligence phase complete. Announcement planned for Feb 1st. Stock ticker: GBTC. Insider trading restrictions active. Legal team: Morrison & Associates. Board vote scheduled Jan 10th.`;
                
                document.getElementById('text-encode-password').value = "TopSecret!2024";
                
                showToast(' Password-protected corporate memo loaded with merger intel!');
            }, 300);
        }

        function loadImageSample() {
            showToast(' Image samples require uploading your own image. Try the text sample first!');
            navigate('text-encode');
        }

        // Method switcher for process explanation
        function showMethod(method) {
            document.querySelectorAll('.method-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.method-animation').forEach(anim => anim.classList.remove('active'));
            
            event.target.closest('.method-tab').classList.add('active');
            document.getElementById('method-' + method).classList.add('active');
        }

        // Initialize quality comparison chart
        let qualityChart = null;
        function initChart() {
            const ctx = document.getElementById('qualityChart');
            if (!ctx) return;

            qualityChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['LSB Method', 'DCT Method', 'Wavelet Method', 'Spread Spectrum'],
                    datasets: [{
                        label: 'PSNR (dB) - Higher is Better',
                        data: [48.2, 42.5, 45.8, 40.3],
                        backgroundColor: [
                            'rgba(138, 43, 226, 0.8)',
                            'rgba(255, 20, 147, 0.8)',
                            'rgba(30, 144, 255, 0.8)',
                            'rgba(50, 205, 50, 0.8)'
                        ],
                        borderColor: [
                            'rgba(138, 43, 226, 1)',
                            'rgba(255, 20, 147, 1)',
                            'rgba(30, 144, 255, 1)',
                            'rgba(50, 205, 50, 1)'
                        ],
                        borderWidth: 2,
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                font: {
                                    size: 14,
                                    weight: 'bold',
                                    family: 'Poppins'
                                },
                                padding: 20
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleFont: {
                                size: 16,
                                family: 'Poppins',
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 14,
                                family: 'Poppins'
                            },
                            padding: 12,
                            cornerRadius: 8,
                            callbacks: {
                                label: function(context) {
                                    return context.parsed.y + ' dB (Excellent quality preserved)';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 60,
                            ticks: {
                                font: {
                                    size: 12,
                                    family: 'Poppins',
                                    weight: '600'
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            ticks: {
                                font: {
                                    size: 12,
                                    family: 'Poppins',
                                    weight: '600'
                                }
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    animation: {
                        duration: 2000,
                        easing: 'easeInOutQuart'
                    }
                }
            });
        }

        function updateChart() {
            if (!qualityChart) return;
            
            // Simulate dynamic updates based on actual operations
            const randomVariation = () => (Math.random() - 0.5) * 2;
            qualityChart.data.datasets[0].data = [
                48.2 + randomVariation(),
                42.5 + randomVariation(),
                45.8 + randomVariation(),
                40.3 + randomVariation()
            ];
            qualityChart.update();
        }

        // Initialize auth and chart when page loads
        document.addEventListener('DOMContentLoaded', () => {
            // Restore auth state from localStorage
            const savedAuth = localStorage.getItem('auth');
            if (savedAuth) {
                try {
                    authState = JSON.parse(savedAuth);
                    // Verify token is still valid by refreshing
                    if (authState.refreshToken) {
                        refreshAccessToken();
                    }
                } catch (e) {
                    localStorage.removeItem('auth');
                }
            }
            updateAuthUI();
            
            // Load system limits
            loadSystemLimits();
            
            // Initialize chart
            setTimeout(initChart, 500);
        });

        // Navigation
        // Tutorial System
        let tutorialStep = 0;
        const tutorialSteps = [
            {
                title: "Welcome to Steganography Pro! ",
                description: "This comprehensive tutorial will guide you step-by-step through all features: hiding messages in text, revealing them, encrypting with passwords, working with images, and more. Let's begin!",
                spotlight: null,
                cardPosition: { top: '50%', left: '50%', transform: 'translate(-50%, -50%)' },
                action: null
            },
            {
                title: "1 Navigation Overview",
                description: "The navigation menu has 6 main sections: Home, Hide in Text, Reveal from Text, Hide in Image, Reveal from Image, and How It Works. Each handles a specific task in the steganography process.",
                spotlight: '.nav-menu',
                cardPosition: { top: '140px', left: '50%', transform: 'translateX(-50%)' },
                action: null
            },
            {
                title: "2 Hide Messages in Text",
                description: "Click 'Hide in Text' to encode secret messages inside normal text using invisible Unicode characters. The text looks completely normal but contains hidden data. Let's go there now!",
                spotlight: '.nav-menu li:nth-child(2)',
                cardPosition: { top: '140px', left: '20%', transform: 'translateX(-50%)' },
                action: () => navigate('text-encode')
            },
            {
                title: "3 Enter Your Cover Text",
                description: "This is your 'cover text' - the normal-looking text that will carry your hidden message. Type or paste any text here. The longer it is, the more data you can hide. Try the samples below for examples!",
                spotlight: '#text-encode-cover',
                cardPosition: { top: '200px', left: '50%', transform: 'translateX(-50%)' },
                action: () => { navigate('text-encode'); setTimeout(() => window.scrollTo({ top: 300, behavior: 'smooth' }), 100); }
            },
            {
                title: "4 Enter Your Secret Message",
                description: "Type your secret message here. This is what you want to hide inside the cover text. Only people who use this tool can extract it!",
                spotlight: '#text-encode-secret',
                cardPosition: { top: '400px', left: '50%', transform: 'translateX(-50%)' },
                action: () => { navigate('text-encode'); setTimeout(() => window.scrollTo({ top: 500, behavior: 'smooth' }), 100); }
            },
            {
                title: "5 Add Password (Optional)",
                description: "Want extra security? Add a password to encrypt your message with AES-128 military-grade encryption. Without the password, nobody can read your secret - even if they extract it!",
                spotlight: '#text-encode-password',
                cardPosition: { top: '600px', left: '50%', transform: 'translateX(-50%)' },
                action: () => { navigate('text-encode'); setTimeout(() => window.scrollTo({ top: 700, behavior: 'smooth' }), 100); }
            },
            {
                title: "6 Reveal Hidden Messages",
                description: "Now let's learn how to extract hidden messages! Click 'Reveal from Text' to decode messages that were hidden in text. You'll paste the stego-text here.",
                spotlight: '.nav-menu li:nth-child(3)',
                cardPosition: { top: '140px', left: '30%', transform: 'translateX(-50%)' },
                action: () => navigate('text-decode')
            },
            {
                title: "7 Paste Encoded Text",
                description: "Paste the text containing the hidden message here. The tool will automatically extract the secret message embedded in the invisible characters.",
                spotlight: '#text-decode-input',
                cardPosition: { top: '300px', left: '50%', transform: 'translateX(-50%)' },
                action: () => { navigate('text-decode'); setTimeout(() => window.scrollTo({ top: 300, behavior: 'smooth' }), 100); }
            },
            {
                title: "8 Hide Messages in Images",
                description: "You can also hide messages inside image files! Click 'Hide in Image' to use LSB (Least Significant Bit) steganography. The image looks identical but contains your secret data.",
                spotlight: '.nav-menu li:nth-child(4)',
                cardPosition: { top: '140px', left: '50%', transform: 'translateX(-50%)' },
                action: () => navigate('image-encode')
            },
            {
                title: "9 Upload & Extract from Images",
                description: "Upload a cover image, type your secret message, optionally add a password, and click 'Hide Message'. To reveal, go to 'Reveal from Image', upload the stego-image, enter the password if used, and extract!",
                spotlight: '.workspace-card',
                cardPosition: { top: '250px', left: '50%', transform: 'translateX(-50%)' },
                action: () => { navigate('image-encode'); setTimeout(() => window.scrollTo({ top: 300, behavior: 'smooth' }), 100); }
            },
            {
                title: " Tutorial Complete!",
                description: "You now know how to: hide & reveal text messages, encrypt with passwords, work with images, and use all features! Try the sample buttons on the home page to practice. Happy encoding! ",
                spotlight: null,
                cardPosition: { top: '50%', left: '50%', transform: 'translate(-50%, -50%)' },
                action: () => navigate('home')
            }
        ];

        function startTutorial() {
            tutorialStep = 0;
            document.getElementById('tutorial-overlay').classList.add('active');
            showTutorialStep();
        }

        function nextTutorialStep() {
            tutorialStep++;
            if (tutorialStep >= tutorialSteps.length) {
                skipTutorial();
                return;
            }
            showTutorialStep();
        }

        function skipTutorial() {
            document.getElementById('tutorial-overlay').classList.remove('active');
            tutorialStep = 0;
        }

        function showTutorialStep() {
            const step = tutorialSteps[tutorialStep];
            const card = document.getElementById('tutorial-card');
            const spotlight = document.getElementById('tutorial-spotlight');
            
            // Execute action if any
            if (step.action) {
                step.action();
            }
            
            // Update content
            document.getElementById('tutorial-title').textContent = step.title;
            document.getElementById('tutorial-description').textContent = step.description;
            document.getElementById('tutorial-step-badge').textContent = `Step ${tutorialStep + 1} of ${tutorialSteps.length}`;
            
            // Update button text
            const nextBtn = document.getElementById('tutorial-next');
            nextBtn.textContent = tutorialStep === tutorialSteps.length - 1 ? 'Finish' : 'Next';
            
            // Update progress dots
            const dots = document.querySelectorAll('.tutorial-dot');
            dots.forEach((dot, i) => {
                dot.classList.toggle('active', i === tutorialStep);
            });
            
            // Position card
            Object.assign(card.style, step.cardPosition);
            
            // Handle spotlight
            if (step.spotlight) {
                const target = document.querySelector(step.spotlight);
                if (target) {
                    const rect = target.getBoundingClientRect();
                    const padding = 10;
                    spotlight.style.display = 'block';
                    spotlight.style.top = (rect.top - padding) + 'px';
                    spotlight.style.left = (rect.left - padding) + 'px';
                    spotlight.style.width = (rect.width + padding * 2) + 'px';
                    spotlight.style.height = (rect.height + padding * 2) + 'px';
                    
                    // Apply clip-path to overlay to create a "hole" for the spotlight
                    const overlay = document.getElementById('tutorial-overlay');
                    const top = rect.top - padding;
                    const left = rect.left - padding;
                    const right = rect.right + padding;
                    const bottom = rect.bottom + padding;
                    const w = window.innerWidth;
                    const h = window.innerHeight;
                    overlay.style.clipPath = `polygon(
                        0 0, ${w}px 0, ${w}px ${h}px, 0 ${h}px, 0 0,
                        ${left}px ${top}px, ${left}px ${bottom}px, ${right}px ${bottom}px, ${right}px ${top}px, ${left}px ${top}px
                    )`;
                }
            } else {
                spotlight.style.display = 'none';
                document.getElementById('tutorial-overlay').style.clipPath = 'none';
            }
        }

        function navigate(page) {
            // Hide all pages
            document.querySelectorAll('.page-section').forEach(p => p.classList.remove('active'));
            
            // Deactivate all nav links
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            
            // Check if auth required for page
            if ((page === 'history' || page === 'account') && !authState.isLoggedIn) {
                openAuthModal('login');
                return;
            }
            
            // Show target page
            const targetPage = document.getElementById('page-' + page);
            if (targetPage) {
                targetPage.classList.add('active');
            }
            
            // Load data for specific pages
            if (page === 'history') {
                loadHistory();
            }
            if (page === 'account' && authState.user) {
                document.getElementById('account-username').textContent = authState.user.username;
                document.getElementById('account-email').textContent = authState.user.email;
                document.getElementById('account-avatar-letter').textContent = authState.user.username.charAt(0).toUpperCase();
                document.getElementById('account-display-name').textContent = authState.user.username;
                document.getElementById('account-email-display').textContent = authState.user.email;
                if (authState.user.created_at) {
                    document.getElementById('account-created').textContent = new Date(authState.user.created_at).toLocaleDateString();
                }
                // Load account stats
                loadAccountStats();
            }
            
            // Activate nav link
            // Find the link that calls this function with the same page argument
            const links = document.querySelectorAll('.nav-link');
            links.forEach(link => {
                const onclick = link.getAttribute('onclick');
                if (onclick && onclick.includes(`'${page}'`)) {
                    link.classList.add('active');
                }
            });
            
            closeUserDropdown();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Utilities
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        function showLoading(show) {
            document.getElementById('loading').classList.toggle('hidden', !show);
        }
        
        function showNotification(message, type = 'info') {
            // Use toast for simple notifications
            showToast(message);
        }
        
        // Speed metrics display
        function showSpeedMetrics(resultContainerId, metrics) {
            const container = document.getElementById(resultContainerId);
            if (!container) return;
            
            // Remove existing speed metrics
            const existingMetrics = container.querySelector('.speed-metrics');
            if (existingMetrics) {
                existingMetrics.remove();
            }
            
            const metricsHtml = `
                <div class="speed-metrics">
                    <div class="speed-metric">
                        <span class="speed-metric-icon"></span>
                        <span class="speed-metric-value">${metrics.time}s</span>
                        <span class="speed-metric-label">Processing Time</span>
                    </div>
                    <div class="speed-metric">
                        <span class="speed-metric-icon"></span>
                        <span class="speed-metric-value">${formatBytes(metrics.inputSize)}</span>
                        <span class="speed-metric-label">Input Size</span>
                    </div>
                    <div class="speed-metric">
                        <span class="speed-metric-icon"></span>
                        <span class="speed-metric-value">${formatBytes(metrics.outputSize)}</span>
                        <span class="speed-metric-label">Output Size</span>
                    </div>
                    <div class="speed-metric">
                        <span class="speed-metric-icon">${metrics.encrypted ? '' : ''}</span>
                        <span class="speed-metric-value">${metrics.encrypted ? 'AES-128' : 'None'}</span>
                        <span class="speed-metric-label">Encryption</span>
                    </div>
                </div>
            `;
            
            // Insert after result header
            const resultHeader = container.querySelector('.result-header');
            if (resultHeader) {
                resultHeader.insertAdjacentHTML('afterend', metricsHtml);
            }
        }
        
        function formatBytes(bytes) {
            if (bytes < 1024) return bytes + ' chars';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        }
        
        // Encryption visualization functions
        function showEncryptionVisualization(containerId, hasPassword) {
            if (!hasPassword) return;
            
            const container = document.getElementById(containerId);
            if (!container) return;
            
            container.style.display = 'block';
            const roundsContainer = document.getElementById(containerId.replace('-viz', '-rounds'));
            const progressBar = document.getElementById(containerId.replace('-viz', '-progress'));
            const statusEl = document.getElementById(containerId.replace('-viz', '-viz-status'));
            
            // AES-128 has 10 rounds
            const totalRounds = 10;
            roundsContainer.innerHTML = '';
            
            for (let i = 0; i <= totalRounds; i++) {
                const roundName = i === 0 ? 'Init' : i === totalRounds ? 'Final' : `R${i}`;
                const roundEl = document.createElement('div');
                roundEl.className = 'encryption-round';
                roundEl.id = `${containerId}-round-${i}`;
                roundEl.innerHTML = `
                    <div class="encryption-round-number">${roundName}</div>
                    <div class="encryption-round-data">---</div>
                `;
                roundsContainer.appendChild(roundEl);
            }
            
            // Animate the rounds
            animateEncryptionRounds(containerId, totalRounds, progressBar, statusEl);
        }
        
        async function animateEncryptionRounds(containerId, totalRounds, progressBar, statusEl) {
            const fakeData = ['AddKey', 'SubByt', 'ShfRow', 'MxCol', 'AddKey', 'SubByt', 'ShfRow', 'MxCol', 'AddKey', 'SubByt', 'Final'];
            
            for (let i = 0; i <= totalRounds; i++) {
                const roundEl = document.getElementById(`${containerId}-round-${i}`);
                if (!roundEl) continue;
                
                // Remove active from previous
                const prevEl = document.getElementById(`${containerId}-round-${i-1}`);
                if (prevEl) {
                    prevEl.classList.remove('active');
                    prevEl.classList.add('completed');
                }
                
                // Set current as active
                roundEl.classList.add('active');
                roundEl.querySelector('.encryption-round-data').textContent = fakeData[i] || '---';
                
                // Update progress
                const progress = ((i + 1) / (totalRounds + 1)) * 100;
                progressBar.style.width = progress + '%';
                
                await new Promise(resolve => setTimeout(resolve, 100));
            }
            
            // Mark last as completed
            const lastEl = document.getElementById(`${containerId}-round-${totalRounds}`);
            if (lastEl) {
                lastEl.classList.remove('active');
                lastEl.classList.add('completed');
            }
            
            statusEl.textContent = ' Complete!';
        }
        
        function hideEncryptionVisualization(containerId) {
            const container = document.getElementById(containerId);
            if (container) {
                container.style.display = 'none';
            }
        }
        
        function updateCharCounter(elementId, maxLength) {
            const element = document.getElementById(elementId);
            const counter = document.getElementById(elementId + '-counter');
            if (!element || !counter) return;
            
            const length = element.value.length;
            counter.textContent = `${length.toLocaleString()} / ${maxLength.toLocaleString()} characters`;
            
            // Update styling based on usage
            counter.classList.remove('warning', 'error');
            if (length > maxLength) {
                counter.classList.add('error');
            } else if (length > maxLength * 0.9) {
                counter.classList.add('warning');
            }
        }

        // TEXT ENCODE
        async function performTextEncode() {
            const cover = document.getElementById('text-encode-cover').value.trim();
            const secret = document.getElementById('text-encode-secret').value.trim();
            const password = document.getElementById('text-encode-password').value;

            if (!cover || !secret) {
                showToast(' Please fill in both cover text and secret message');
                return;
            }
            
            // Check limits
            if (cover.length > systemLimits.max_text_length) {
                showToast(` Cover text exceeds ${systemLimits.max_text_length.toLocaleString()} character limit`);
                return;
            }
            if (secret.length > systemLimits.max_secret_length) {
                showToast(` Secret message exceeds ${systemLimits.max_secret_length.toLocaleString()} character limit`);
                return;
            }

            showLoading(true);
            const startTime = performance.now();
            
            // Show encryption visualization if password is used
            if (password) {
                showEncryptionVisualization('text-encode-viz', true);
            }
            
            try {
                const response = await fetch(`${API_BASE}/encode`, {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        ...getAuthHeaders()
                    },
                    body: JSON.stringify({
                        algorithm: 'zwc',
                        cover_text: cover,
                        secret_message: secret,
                        password: password || undefined
                    })
                });

                const data = await response.json();
                const endTime = performance.now();
                const processingTime = ((endTime - startTime) / 1000).toFixed(2);
                
                if (data.success) {
                    document.getElementById('text-encode-output').value = data.stego_text;
                    document.getElementById('text-encode-result').classList.remove('hidden');
                    
                    // Show speed metrics
                    showSpeedMetrics('text-encode-result', {
                        time: processingTime,
                        inputSize: cover.length + secret.length,
                        outputSize: data.stego_text.length,
                        encrypted: !!password
                    });
                    
                    showToast(` Message hidden in ${processingTime}s!`);
                    updateStats('encode', endTime - startTime);
                } else {
                    showToast(' Error: ' + data.error);
                }
            } catch (error) {
                showToast(' Connection error. Make sure the server is running.');
            }
            showLoading(false);
        }

        // TEXT DECODE
        async function performTextDecode() {
            const stego = document.getElementById('text-decode-input').value.trim();
            const password = document.getElementById('text-decode-password').value;

            if (!stego) {
                showToast(' Please paste the text to decode');
                return;
            }

            showLoading(true);
            const startTime = performance.now();
            
            try {
                const response = await fetch(`${API_BASE}/decode`, {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        ...getAuthHeaders()
                    },
                    body: JSON.stringify({
                        algorithm: 'zwc',
                        stego_text: stego,
                        password: password || undefined
                    })
                });

                const data = await response.json();
                const endTime = performance.now();
                const processingTime = ((endTime - startTime) / 1000).toFixed(2);
                
                if (data.success) {
                    document.getElementById('text-decode-output').textContent = data.secret_message;
                    document.getElementById('text-decode-result').classList.remove('hidden');
                    
                    // Show speed metrics
                    showSpeedMetrics('text-decode-result', {
                        time: processingTime,
                        inputSize: stego.length,
                        outputSize: data.secret_message.length,
                        encrypted: !!password
                    });
                    
                    showToast(` Secret revealed in ${processingTime}s!`);
                    updateStats('decode', endTime - startTime);
                } else {
                    showToast(' ' + (data.error || 'No hidden message found'));
                }
            } catch (error) {
                showToast(' Connection error');
            }
            showLoading(false);
        }

        // IMAGE ENCODE
        document.getElementById('image-encode-file').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    coverImageData = e.target.result;
                    document.getElementById('image-encode-preview-img').src = coverImageData;
                    document.getElementById('image-encode-preview').classList.remove('hidden');
                    showToast(' Image loaded: ' + file.name);
                };
                reader.readAsDataURL(file);
            }
        });

        async function performImageEncode() {
            if (!coverImageData) {
                showToast(' Please upload an image first');
                return;
            }

            const secret = document.getElementById('image-encode-secret').value.trim();
            const password = document.getElementById('image-encode-password').value;

            if (!secret) {
                showToast(' Please enter a secret message');
                return;
            }
            
            // Check secret length limit
            if (secret.length > systemLimits.max_secret_length) {
                showToast(` Secret message exceeds ${systemLimits.max_secret_length.toLocaleString()} character limit`);
                return;
            }

            showLoading(true);
            const startTime = performance.now();
            
            // Show encryption visualization if password is used
            if (password) {
                showEncryptionVisualization('image-encode-viz', true);
            }
            
            try {
                const response = await fetch(`${API_BASE}/encode`, {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        ...getAuthHeaders()
                    },
                    body: JSON.stringify({
                        algorithm: 'lsb',
                        cover_image: coverImageData,
                        secret_message: secret,
                        password: password || undefined,
                        bits_per_pixel: 2
                    })
                });

                const data = await response.json();
                const endTime = performance.now();
                const processingTime = ((endTime - startTime) / 1000).toFixed(2);
                
                if (data.success) {
                    stegoImageData = 'data:image/png;base64,' + data.stego_image;
                    
                    // Analyze quality
                    const analyzeRes = await fetch(`${API_BASE}/analyze`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            original_image: coverImageData,
                            stego_image: stegoImageData
                        })
                    });
                    const analyzeData = await analyzeRes.json();
                    
                    if (analyzeData.success) {
                        document.getElementById('img-quality').textContent = analyzeData.metrics.quality_assessment;
                        document.getElementById('img-mse').textContent = analyzeData.metrics.mse.toFixed(4);
                        document.getElementById('img-psnr').textContent = analyzeData.metrics.psnr === 'Inf' ? '' : analyzeData.metrics.psnr.toFixed(2);
                        document.getElementById('img-ssim').textContent = analyzeData.metrics.ssim.toFixed(4);
                    }

                    document.getElementById('image-encode-output').src = stegoImageData;
                    document.getElementById('image-download-link').href = stegoImageData;
                    document.getElementById('image-encode-result').classList.remove('hidden');
                    
                    // Show speed metrics
                    showSpeedMetrics('image-encode-result', {
                        time: processingTime,
                        inputSize: coverImageData.length,
                        outputSize: stegoImageData.length,
                        encrypted: !!password
                    });
                    
                    showToast(` Image encoded in ${processingTime}s!`);
                    updateStats('encode', endTime - startTime);
                } else {
                    showToast(' ' + data.error);
                }
            } catch (error) {
                showToast(' Connection error');
            }
            showLoading(false);
        }

        // IMAGE DECODE
        document.getElementById('image-decode-file').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    decodeImageData = e.target.result;
                    document.getElementById('image-decode-preview-img').src = decodeImageData;
                    document.getElementById('image-decode-preview').classList.remove('hidden');
                    showToast(' Image loaded: ' + file.name);
                };
                reader.readAsDataURL(file);
            }
        });

        async function performImageDecode() {
            if (!decodeImageData) {
                showToast(' Please upload an image');
                return;
            }

            const password = document.getElementById('image-decode-password').value;

            showLoading(true);
            const startTime = performance.now();
            
            try {
                const response = await fetch(`${API_BASE}/decode`, {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        ...getAuthHeaders()
                    },
                    body: JSON.stringify({
                        algorithm: 'lsb',
                        stego_image: decodeImageData,
                        password: password || undefined
                    })
                });

                const data = await response.json();
                const endTime = performance.now();
                const processingTime = ((endTime - startTime) / 1000).toFixed(2);
                
                if (data.success) {
                    document.getElementById('image-decode-output').textContent = data.secret_message;
                    document.getElementById('image-decode-result').classList.remove('hidden');
                    
                    // Show speed metrics
                    showSpeedMetrics('image-decode-result', {
                        time: processingTime,
                        inputSize: decodeImageData.length,
                        outputSize: data.secret_message.length,
                        encrypted: !!password
                    });
                    
                    showToast(` Secret extracted in ${processingTime}s!`);
                    updateStats('decode', endTime - startTime);
                } else {
                    showToast(' ' + (data.error || 'No hidden message found'));
                }
            } catch (error) {
                showToast(' Connection error');
            }
            showLoading(false);
        }

        // Copy functions
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            element.select();
            document.execCommand('copy');
            showToast(' Copied to clipboard!');
        }

        function copySecretText() {
            const text = document.getElementById('text-decode-output').textContent;
            navigator.clipboard.writeText(text).then(() => {
                showToast(' Secret copied to clipboard!');
            });
        }

        function copyImageSecret() {
            const text = document.getElementById('image-decode-output').textContent;
            navigator.clipboard.writeText(text).then(() => {
                showToast(' Secret copied to clipboard!');
            });
        }
    </script>

</body>
</html>
