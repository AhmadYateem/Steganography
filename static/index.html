<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Steganography Pro - Hide Messages Securely</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="chatbot.css">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Light theme (default) */
            --purple-900: #3b0764;
            --purple-800: #5b21b6;
            --purple-700: #7c3aed;
            --purple-600: #8b5cf6;
            --purple-500: #a855f7;
            --purple-400: #c084fc;
            --purple-300: #d8b4fe;
            --purple-200: #e9d5ff;
            --purple-100: #f3e8ff;
            --purple-50: #faf5ff;
            
            --white: #ffffff;
            --gray-50: #fafafa;
            --gray-100: #f4f4f5;
            --gray-200: #e4e4e7;
            --gray-700: #3f3f46;
            --gray-900: #18181b;
            
            --bg-primary: #ffffff;
            --bg-secondary: #fafafa;
            --bg-tertiary: #f4f4f5;
            --text-primary: #18181b;
            --text-secondary: #3f3f46;
            --text-muted: #71717a;
            --border-color: rgba(0, 0, 0, 0.1);
            --card-bg: #ffffff;
            --input-bg: #ffffff;
            --navbar-bg: rgba(255, 255, 255, 0.8);
            
            --gradient-purple: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
            --gradient-pink: linear-gradient(135deg, #ec4899 0%, #f472b6 100%);
            --gradient-blue: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%);
            --gradient-green: linear-gradient(135deg, #10b981 0%, #34d399 100%);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 40px rgba(124, 58, 237, 0.15);
            --shadow-glow: 0 0 30px rgba(124, 58, 237, 0.4);
        }

        /* Dark theme */
        [data-theme="dark"] {
            --purple-900: #e9d5ff;
            --purple-800: #d8b4fe;
            --purple-700: #a855f7;
            --purple-600: #c084fc;
            --purple-500: #d8b4fe;
            --purple-400: #e9d5ff;
            --purple-300: #7c3aed;
            --purple-200: #5b21b6;
            --purple-100: #4c1d95;
            --purple-50: #2e1065;
            
            --white: #18181b;
            --gray-50: #27272a;
            --gray-100: #3f3f46;
            --gray-200: #52525b;
            --gray-700: #d4d4d8;
            --gray-900: #fafafa;
            
            --bg-primary: #0f0f10;
            --bg-secondary: #18181b;
            --bg-tertiary: #27272a;
            --text-primary: #fafafa;
            --text-secondary: #d4d4d8;
            --text-muted: #a1a1aa;
            --border-color: rgba(255, 255, 255, 0.1);
            --card-bg: #1f1f23;
            --input-bg: #27272a;
            --navbar-bg: rgba(15, 15, 16, 0.9);
            
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.4);
            --shadow-xl: 0 20px 40px rgba(124, 58, 237, 0.25);
            --shadow-glow: 0 0 30px rgba(168, 85, 247, 0.5);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
            transition: background 0.3s ease, color 0.3s ease;
        }

        [data-theme="light"] body {
            background: linear-gradient(180deg, var(--purple-50) 0%, var(--white) 100%);
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 20%, rgba(124, 58, 237, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(236, 72, 153, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        [data-theme="dark"] body::before {
            background: 
                radial-gradient(circle at 20% 20%, rgba(124, 58, 237, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(168, 85, 247, 0.1) 0%, transparent 50%);
        }

        /* Theme Toggle Button */
        .theme-toggle {
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: 50px;
            padding: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            margin-right: 12px;
        }

        .theme-toggle:hover {
            border-color: var(--purple-500);
            transform: scale(1.05);
        }

        .theme-toggle-icon {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }

        [data-theme="dark"] .theme-toggle-icon.sun {
            display: inline;
        }

        [data-theme="dark"] .theme-toggle-icon.moon {
            display: none;
        }

        [data-theme="light"] .theme-toggle-icon.sun {
            display: none;
        }

        [data-theme="light"] .theme-toggle-icon.moon {
            display: inline;
        }

        /* ============== NAVIGATION ============== */
        .navbar {
            background: var(--navbar-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: 1rem 2rem;
            transition: background 0.3s ease;
        }

        .nav-container {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 24px;
            flex-wrap: wrap;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 800;
            background: var(--gradient-purple);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.5px;
            cursor: pointer;
        }

        /* Auth Buttons in Nav */
        .nav-auth {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-shrink: 0;
        }

        .nav-auth-btn {
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            font-family: 'Poppins', sans-serif;
            white-space: nowrap;
            min-width: 100px;
            text-align: center;
        }

        .nav-auth-btn.login {
            background: transparent;
            color: var(--purple-700);
            border: 2px solid var(--purple-300);
        }

        .nav-auth-btn.login:hover {
            background: var(--purple-50);
            border-color: var(--purple-500);
        }

        .nav-auth-btn.signup {
            background: var(--gradient-purple);
            color: white;
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
        }

        .nav-auth-btn.signup:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(124, 58, 237, 0.4);
        }

        .user-menu {
            position: relative;
            display: none;
        }

        .user-menu.active {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient-purple);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .user-avatar:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.4);
        }

        .user-dropdown {
            position: absolute;
            top: 50px;
            right: 0;
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            padding: 16px;
            min-width: 220px;
            display: none;
            z-index: 1001;
            border: 2px solid var(--border-color);
        }

        [data-theme="dark"] .user-dropdown {
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
        }

        .user-dropdown.show {
            display: block;
            animation: dropdownSlide 0.3s ease;
        }

        @keyframes dropdownSlide {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .user-dropdown-header {
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border-color);
            margin-bottom: 12px;
        }

        .user-dropdown-name {
            font-weight: 700;
            color: var(--text-primary);
        }

        .user-dropdown-email {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .user-dropdown-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .user-dropdown-item:hover {
            background: var(--purple-50);
            color: var(--purple-700);
        }

        [data-theme="dark"] .user-dropdown-item:hover {
            background: rgba(139, 92, 246, 0.2);
            color: var(--purple-300);
        }

        .user-dropdown-item.danger {
            color: #ef4444;
        }

        .user-dropdown-item.danger:hover {
            background: #fef2f2;
        }

        [data-theme="dark"] .user-dropdown-item.danger:hover {
            background: rgba(239, 68, 68, 0.2);
        }

        /* ============== UNIFIED NAVIGATION MENU ============== */
        .nav-menu {
            display: flex;
            align-items: center;
            gap: 4px;
            list-style: none;
            background: var(--bg-tertiary);
            padding: 6px;
            border-radius: 100px;
            margin: 0;
        }

        .nav-menu > li {
            display: flex;
            align-items: center;
        }

        .nav-link,
        .nav-dropdown-btn {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.9rem;
            padding: 10px 18px;
            border-radius: 100px;
            transition: all 0.2s ease;
            cursor: pointer;
            white-space: nowrap;
            border: none;
            background: transparent;
            display: flex;
            align-items: center;
            gap: 4px;
            line-height: 1;
        }

        .nav-link:hover,
        .nav-dropdown-btn:hover {
            color: var(--purple-700);
            background: rgba(255,255,255,0.6);
        }

        [data-theme="dark"] .nav-link:hover,
        [data-theme="dark"] .nav-dropdown-btn:hover {
            background: rgba(139, 92, 246, 0.15);
            color: var(--purple-400);
        }

        .nav-link.active {
            background: white;
            color: var(--purple-700);
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            font-weight: 700;
        }

        [data-theme="dark"] .nav-link.active {
            background: var(--purple-600);
            color: white;
        }

        /* Dropdown arrow styling */
        .nav-dropdown-btn::after {
            content: '';
            border: 4px solid transparent;
            border-top-color: currentColor;
            margin-left: 2px;
            margin-top: 2px;
            transition: transform 0.2s;
        }

        .nav-dropdown:hover .nav-dropdown-btn::after {
            transform: rotate(180deg);
        }

        /* ============== MAIN CONTAINER ============== */
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 24px;
            position: relative;
            z-index: 1;
        }

        /* ============== PAGE SECTIONS ============== */
        .page-section {
            display: none;
            animation: pageSlideIn 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .page-section.active {
            display: block;
        }

        @keyframes pageSlideIn {
            from { 
                opacity: 0; 
                transform: translateY(30px) scale(0.98);
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1);
            }
        }

        /* ============== HOME PAGE ============== */
        .hero {
            text-align: center;
            padding: 80px 20px;
            position: relative;
        }

        .hero-badge {
            display: inline-block;
            padding: 12px 28px;
            background: linear-gradient(135deg, var(--purple-100) 0%, var(--purple-200) 100%);
            border: 3px solid var(--purple-300);
            border-radius: 50px;
            color: var(--purple-900);
            font-weight: 800;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 32px;
            animation: badgeFloat 3s ease-in-out infinite;
            box-shadow: 0 8px 20px rgba(124, 58, 237, 0.2);
        }

        @keyframes badgeFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .hero-title {
            font-size: 5rem;
            font-weight: 900;
            line-height: 1.1;
            margin-bottom: 32px;
            background: var(--gradient-purple);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -3px;
            animation: titleScale 1s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes titleScale {
            0% { transform: scale(0.9); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .hero-subtitle {
            font-size: 1.5rem;
            color: var(--text-secondary);
            font-weight: 600;
            max-width: 800px;
            margin: 0 auto 50px;
            line-height: 1.8;
            animation: fadeInUp 1s ease 0.2s both;
        }

        [data-theme="dark"] .hero-badge {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2) 0%, rgba(139, 92, 246, 0.3) 100%);
            border-color: var(--purple-400);
            color: var(--purple-300);
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .cta-buttons {
            display: flex;
            gap: 24px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 60px;
        }

        .btn-cta {
            padding: 22px 48px;
            background: var(--gradient-purple);
            color: white;
            border: none;
            border-radius: 16px;
            font-weight: 900;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 15px 40px rgba(124, 58, 237, 0.4);
            position: relative;
            overflow: hidden;
        }

        .btn-cta::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn-cta:hover::before {
            width: 400px;
            height: 400px;
        }

        .btn-cta:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 20px 60px rgba(124, 58, 237, 0.6);
        }

        .btn-cta:active {
            transform: translateY(-2px) scale(1.02);
        }

        .btn-secondary {
            padding: 22px 48px;
            background: var(--card-bg);
            color: var(--purple-700);
            border: 4px solid var(--purple-300);
            border-radius: 16px;
            font-weight: 900;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        [data-theme="dark"] .btn-secondary {
            color: var(--purple-300);
        }

        .btn-secondary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: var(--gradient-purple);
            transition: left 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: -1;
        }

        .btn-secondary:hover::before {
            left: 0;
        }

        .btn-secondary:hover {
            color: white;
            border-color: var(--purple-500);
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 15px 40px rgba(124, 58, 237, 0.3);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 32px;
            margin-top: 80px;
        }

        .feature-card {
            background: var(--card-bg);
            padding: 48px;
            border-radius: 24px;
            border: 3px solid var(--border-color);
            text-align: center;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .feature-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: var(--gradient-purple);
            opacity: 0;
            transition: opacity 0.4s;
        }

        .feature-card:hover::before {
            opacity: 0.05;
            animation: rotate 3s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .feature-card:hover {
            transform: translateY(-10px) scale(1.03);
            box-shadow: var(--shadow-xl);
            border-color: var(--purple-500);
        }

        .feature-icon {
            font-size: 4rem;
            margin-bottom: 24px;
            display: inline-block;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            filter: drop-shadow(0 4px 8px rgba(124, 58, 237, 0.3));
        }

        .feature-card:hover .feature-icon {
            transform: scale(1.2) rotate(10deg);
            animation: iconBounce 0.6s ease-in-out;
        }

        @keyframes iconBounce {
            0%, 100% { transform: scale(1.2) rotate(10deg) translateY(0); }
            50% { transform: scale(1.2) rotate(10deg) translateY(-15px); }
        }

        .feature-title {
            font-size: 1.5rem;
            font-weight: 900;
            margin-bottom: 16px;
            color: var(--text-primary);
            position: relative;
            z-index: 1;
        }

        .feature-desc {
            font-size: 1.05rem;
            color: var(--text-secondary);
            line-height: 1.7;
            font-weight: 500;
            position: relative;
            z-index: 1;
        }

        /* ============== STATS DASHBOARD ============== */
        .stats-dashboard {
            padding: 80px 50px;
            background: linear-gradient(135deg, #ec4899, #3b82f6);
            margin: 80px 0 0 0;
            border-radius: 30px;
        }

        .section-title {
            font-size: 2.8rem;
            font-weight: 800;
            color: white;
            text-align: center;
            margin-bottom: 15px;
            animation: titleScale 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .section-subtitle {
            text-align: center;
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 50px;
            animation: fadeIn 0.8s ease;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 50px;
        }

        .stat-card {
            background: white;
            padding: 35px 25px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
            animation: slideUp 0.6s ease backwards;
        }

        .stat-card:nth-child(1) { animation-delay: 0.1s; }
        .stat-card:nth-child(2) { animation-delay: 0.2s; }
        .stat-card:nth-child(3) { animation-delay: 0.3s; }
        .stat-card:nth-child(4) { animation-delay: 0.4s; }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(138, 43, 226, 0.1), transparent);
            transition: left 0.6s ease;
        }

        .stat-card:hover::before {
            left: 100%;
        }

        .stat-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 20px 60px rgba(138, 43, 226, 0.3);
        }

        .stat-icon {
            font-size: 3.5rem;
            margin-bottom: 15px;
            animation: iconBounce 2s ease-in-out infinite;
        }

        .stat-value {
            font-size: 3rem;
            font-weight: 900;
            color: var(--purple-700);
            margin-bottom: 10px;
            font-variant-numeric: tabular-nums;
        }

        .stat-label {
            font-size: 1rem;
            color: #666;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .stat-bar {
            height: 8px;
            background: #f0f0f0;
            border-radius: 10px;
            overflow: hidden;
        }

        .stat-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--purple-700), var(--purple-500));
            border-radius: 10px;
            transition: width 1s cubic-bezier(0.65, 0, 0.35, 1);
        }

        /* ============== SHOWCASE SECTION ============== */
        .showcase-section {
            padding: 80px 50px;
            max-width: 1200px;
            margin: 60px auto;
        }

        .showcase-section .section-title {
            color: var(--gray-900);
        }

        .showcase-section .section-subtitle {
            color: #666;
        }

        .samples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 30px;
            margin-top: 50px;
        }

        .sample-card {
            background: white;
            padding: 40px 30px;
            border-radius: 25px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            border: 3px solid transparent;
        }

        .sample-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(
                transparent,
                var(--purple-700),
                transparent 30%
            );
            animation: rotate 4s linear infinite;
            opacity: 0;
            transition: opacity 0.4s;
        }

        .sample-card::after {
            content: '';
            position: absolute;
            inset: 3px;
            background: white;
            border-radius: 22px;
            z-index: 1;
        }

        [data-theme="dark"] .sample-card {
            background: var(--card-bg);
        }

        [data-theme="dark"] .sample-card::after {
            background: var(--card-bg);
        }

        .sample-card > * {
            position: relative;
            z-index: 2;
        }

        .sample-card:hover::before {
            opacity: 1;
        }

        .sample-card:hover {
            transform: translateY(-15px) scale(1.02);
            box-shadow: 0 25px 60px rgba(138, 43, 226, 0.25);
        }

        .sample-badge {
            display: inline-block;
            padding: 8px 18px;
            background: linear-gradient(135deg, var(--purple-700), var(--purple-500));
            color: white;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(138, 43, 226, 0.3);
        }

        .sample-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: iconFloat 3s ease-in-out infinite;
        }

        @keyframes iconFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-12px); }
        }

        .sample-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 15px;
        }

        .sample-desc {
            font-size: 1.05rem;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 25px;
        }

        .sample-btn {
            background: linear-gradient(135deg, var(--purple-700), var(--purple-500));
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(138, 43, 226, 0.3);
            position: relative;
            overflow: hidden;
        }

        .sample-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .sample-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .sample-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(138, 43, 226, 0.4);
        }

        /* ============== CHART SECTION ============== */
        .chart-section {
            padding: 80px 50px;
            background: linear-gradient(135deg, #f8f9ff, #fff5fb);
            margin: 60px 0;
            border-radius: 30px;
        }

        .chart-section .section-title {
            color: var(--gray-900);
        }

        .chart-section .section-subtitle {
            color: #666;
        }

        .chart-container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 25px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.1);
            animation: slideUp 0.8s ease;
        }

        @keyframes rotate {
            100% { transform: rotate(360deg); }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ============== ANIMATED PROCESS EXPLANATION ============== */
        .process-explanation {
            padding: 80px 50px;
            max-width: 1400px;
            margin: 60px auto;
            background: var(--card-bg);
            border-radius: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.08);
        }

        [data-theme="dark"] .process-explanation {
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .process-methods {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 60px;
        }

        .method-tab {
            padding: 18px 40px;
            background: var(--card-bg);
            border: 3px solid var(--purple-200);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            font-weight: 700;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--text-primary);
        }

        [data-theme="dark"] .method-tab {
            border-color: var(--purple-300);
        }

        .method-tab:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(138, 43, 226, 0.2);
            border-color: var(--purple-500);
        }

        .method-tab.active {
            background: var(--gradient-purple);
            color: white;
            border-color: var(--purple-700);
            box-shadow: 0 10px 30px rgba(138, 43, 226, 0.4);
        }

        .method-icon {
            font-size: 1.5rem;
        }

        .method-animation {
            display: none;
            animation: fadeIn 0.6s ease;
        }

        .method-animation.active {
            display: block;
        }

        .animation-stage {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 30px;
            margin-bottom: 60px;
            padding: 40px;
            background: linear-gradient(135deg, var(--purple-50), var(--purple-100));
            border-radius: 25px;
            flex-wrap: wrap;
        }

        [data-theme="dark"] .animation-stage {
            background: linear-gradient(135deg, rgba(124, 58, 237, 0.15), rgba(168, 85, 247, 0.1));
        }

        .stage-step {
            flex: 1;
            min-width: 180px;
            animation: slideUp 0.8s ease backwards;
        }

        .stage-step.stage-1 { animation-delay: 0.2s; }
        .stage-step.stage-2 { animation-delay: 0.4s; }
        .stage-step.stage-3 { animation-delay: 0.6s; }

        .step-visual {
            margin-bottom: 25px;
        }

        .visual-box {
            background: var(--card-bg);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
            min-height: 220px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            transition: all 0.4s ease;
            position: relative;
        }

        [data-theme="dark"] .visual-box {
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .visual-box:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 40px rgba(138, 43, 226, 0.25);
        }

        .visual-box.processing {
            background: linear-gradient(135deg, #fff7ed, #ffedd5);
            animation: pulse-glow 2s ease-in-out infinite;
        }

        [data-theme="dark"] .visual-box.processing {
            background: linear-gradient(135deg, rgba(251, 146, 60, 0.2), rgba(251, 146, 60, 0.1));
        }

        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 10px 30px rgba(251, 146, 60, 0.3); }
            50% { box-shadow: 0 15px 50px rgba(251, 146, 60, 0.6); }
        }

        .visual-box.success {
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
            border: 3px solid #10b981;
        }

        .visual-icon {
            font-size: 3.5rem;
            margin-bottom: 15px;
            animation: iconBounce 2s ease-in-out infinite;
        }

        .visual-label {
            font-weight: 800;
            font-size: 1.1rem;
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .visual-content {
            font-family: 'Courier New', monospace;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--purple-700);
            padding: 12px;
            background: rgba(124, 58, 237, 0.1);
            border-radius: 10px;
            margin-top: 10px;
        }

        .process-particles {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }

        .particle {
            font-size: 2rem;
            animation: float-particle 2s ease-in-out infinite;
            display: inline-block;
        }

        .particle:nth-child(1) { animation-delay: 0s; }
        .particle:nth-child(2) { animation-delay: 0.3s; }
        .particle:nth-child(3) { animation-delay: 0.6s; }

        @keyframes float-particle {
            0%, 100% { transform: translateY(0) rotate(0deg); opacity: 0.3; }
            50% { transform: translateY(-20px) rotate(180deg); opacity: 1; }
        }

        .invisible-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #10b981;
            color: white;
            padding: 6px 14px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 800;
            animation: badge-pulse 2s ease-in-out infinite;
        }

        @keyframes badge-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .animated-arrow {
            font-size: 3rem;
            color: var(--purple-500);
            font-weight: 900;
            animation: arrow-move 1.5s ease-in-out infinite;
            flex-shrink: 0;
        }

        @keyframes arrow-move {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(10px); }
        }

        .step-description {
            text-align: center;
        }

        .step-num {
            width: 50px;
            height: 50px;
            background: var(--gradient-purple);
            color: white;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1.5rem;
            margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(124, 58, 237, 0.4);
        }

        .step-description h3 {
            font-size: 1.4rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .step-description p {
            font-size: 1rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Image-specific visuals */
        .image-preview {
            position: relative;
        }

        .pixel-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            max-width: 180px;
            margin: 0 auto;
        }

        .pixel {
            aspect-ratio: 1;
            border-radius: 8px;
            animation: pixel-shimmer 3s ease-in-out infinite;
        }

        @keyframes pixel-shimmer {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .difference-badge {
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            background: #10b981;
            color: white;
            padding: 6px 12px;
            border-radius: 10px;
            font-size: 0.75rem;
            font-weight: 800;
            white-space: nowrap;
        }

        .lsb-demo {
            padding: 20px;
        }

        .binary-display {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .byte {
            display: flex;
            gap: 6px;
        }

        .bit {
            width: 32px;
            height: 32px;
            background: #e0e7ff;
            color: #3730a3;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            transition: all 0.3s;
        }

        .bit.lsb {
            background: #fef3c7;
            color: #92400e;
            border: 2px solid #f59e0b;
        }

        .byte.modified .bit.lsb {
            background: #dcfce7;
            color: #166534;
            border: 2px solid #10b981;
            animation: bit-change 1s ease-in-out infinite;
        }

        @keyframes bit-change {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .arrow-down {
            font-size: 2rem;
            color: var(--purple-500);
            animation: arrow-bounce 1s ease-in-out infinite;
        }

        @keyframes arrow-bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(10px); }
        }

        /* Tech Details */
        .tech-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .tech-card {
            background: linear-gradient(135deg, var(--purple-50), var(--card-bg));
            padding: 30px;
            border-radius: 20px;
            border: 2px solid var(--purple-200);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            animation: slideUp 0.6s ease backwards;
        }

        [data-theme="dark"] .tech-card {
            background: linear-gradient(135deg, rgba(124, 58, 237, 0.1), var(--card-bg));
            border-color: var(--purple-300);
        }

        .tech-card:nth-child(1) { animation-delay: 0.8s; }
        .tech-card:nth-child(2) { animation-delay: 0.9s; }
        .tech-card:nth-child(3) { animation-delay: 1s; }

        .tech-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(138, 43, 226, 0.2);
            border-color: var(--purple-500);
        }

        .tech-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .tech-title {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .tech-desc {
            font-size: 1rem;
            color: var(--text-secondary);
            line-height: 1.7;
        }

        /* ============== WORKSPACE CARDS ============== */
        .workspace-card {
            background: var(--card-bg);
            border-radius: 24px;
            border: 3px solid var(--purple-200);
            box-shadow: var(--shadow-xl);
            overflow: hidden;
            margin-bottom: 40px;
            animation: slideUp 0.6s ease backwards;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        [data-theme="dark"] .workspace-card {
            border-color: var(--purple-300);
        }

        .workspace-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 70px rgba(138, 43, 226, 0.2);
        }

        .card-header {
            background: linear-gradient(135deg, var(--purple-50) 0%, var(--card-bg) 100%);
            padding: 32px 40px;
            border-bottom: 2px solid var(--purple-200);
            position: relative;
            overflow: hidden;
        }

        [data-theme="dark"] .card-header {
            border-bottom-color: var(--purple-300);
        }

        .card-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(138, 43, 226, 0.1), transparent);
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(-30px, -30px); }
        }

        .card-title {
            font-size: 2rem;
            font-weight: 900;
            color: var(--text-primary);
            margin-bottom: 8px;
            position: relative;
        }

        .card-subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
            font-weight: 500;
            position: relative;
        }

        .card-body {
            padding: 48px;
        }

        /* ============== PASSWORD GENERATOR ============== */
        .password-input-group {
            display: flex;
            gap: 8px;
            align-items: stretch;
        }

        .password-input-group .input-field {
            flex: 1;
        }

        .btn-generate {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 0;
            width: 48px;
            height: 48px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
        }

        .btn-generate:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
        }

        .btn-generate:active {
            transform: translateY(0);
        }

        .btn-copy {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 0;
            width: 48px;
            height: 48px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
        }

        .btn-copy:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        }

        .btn-copy:active {
            transform: translateY(0);
        }

        /* ============== SPEED METRICS ============== */
        .speed-metrics {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            margin-top: 16px;
            padding: 16px;
            background: var(--bg-tertiary);
            border-radius: 12px;
        }

        .speed-metric {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: var(--card-bg);
            border-radius: 8px;
            font-size: 0.9rem;
        }

        .speed-metric-icon {
            font-size: 1.2rem;
        }

        .speed-metric-value {
            font-weight: 700;
            color: var(--purple-600);
        }

        .speed-metric-label {
            color: var(--text-muted);
        }

        /* ============== ENCRYPTION VISUALIZATION ============== */
        .encryption-viz {
            background: var(--bg-tertiary);
            border-radius: 16px;
            padding: 24px;
            margin: 20px 0;
            overflow: hidden;
        }

        .encryption-viz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .encryption-viz-title {
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .encryption-rounds {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding: 8px 0;
        }

        .encryption-round {
            min-width: 80px;
            padding: 12px;
            background: var(--card-bg);
            border-radius: 12px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .encryption-round.active {
            border-color: var(--purple-500);
            background: var(--purple-50);
        }

        .encryption-round.completed {
            border-color: #10b981;
            background: #ecfdf5;
        }

        [data-theme="dark"] .encryption-round.completed {
            background: #064e3b;
        }

        .encryption-round-number {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .encryption-round-data {
            font-family: 'Consolas', monospace;
            font-size: 0.75rem;
            color: var(--purple-600);
            word-break: break-all;
            margin-top: 4px;
        }

        .encryption-progress {
            height: 4px;
            background: var(--bg-secondary);
            border-radius: 2px;
            overflow: hidden;
            margin-top: 12px;
        }

        .encryption-progress-bar {
            height: 100%;
            background: var(--gradient-purple);
            transition: width 0.3s ease;
            border-radius: 2px;
        }

        /* ============== STEPS ============== */
        .step-container {
            margin-bottom: 40px;
            animation: fadeIn 0.5s ease backwards;
        }

        .step-container:nth-child(1) { animation-delay: 0.1s; }
        .step-container:nth-child(2) { animation-delay: 0.2s; }
        .step-container:nth-child(3) { animation-delay: 0.3s; }
        .step-container:nth-child(4) { animation-delay: 0.4s; }

        .step-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 16px;
        }

        .step-number {
            min-width: 50px;
            height: 50px;
            background: var(--gradient-purple);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1.4rem;
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); box-shadow: 0 6px 20px rgba(124, 58, 237, 0.5); }
        }

        .step-title {
            font-size: 1.4rem;
            font-weight: 800;
            color: var(--text-primary);
        }

        .step-description {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 16px;
            padding-left: 66px;
            line-height: 1.7;
        }

        .step-help {
            padding: 16px 24px;
            background: var(--purple-50);
            border-left: 4px solid var(--purple-500);
            border-radius: 8px;
            margin-bottom: 16px;
            margin-left: 66px;
            font-size: 0.95rem;
            color: var(--purple-900);
            font-weight: 500;
        }

        [data-theme="dark"] .step-help {
            background: rgba(139, 92, 246, 0.1);
            color: var(--purple-300);
        }

        /* ============== FORM INPUTS ============== */
        .input-field {
            width: 100%;
            padding: 20px 24px;
            border: 3px solid var(--border-color);
            border-radius: 16px;
            font-family: 'Poppins', sans-serif;
            font-size: 1.1rem;
            font-weight: 500;
            line-height: 1.8;
            transition: all 0.3s;
            background: var(--input-bg);
            color: var(--text-primary);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--purple-500);
            background: var(--card-bg);
            box-shadow: 0 0 0 4px var(--purple-100);
            transform: translateY(-2px);
        }

        [data-theme="dark"] .input-field:focus {
            box-shadow: 0 0 0 4px rgba(139, 92, 246, 0.2);
        }

        .input-field::placeholder {
            color: var(--text-muted);
            font-style: italic;
        }

        textarea.input-field {
            min-height: 400px;
            max-height: 600px;
            resize: vertical;
            line-height: 1.9;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 1rem;
            letter-spacing: 0.5px;
            padding: 24px;
            font-weight: 500;
        }

        textarea.input-field[readonly] {
            min-height: 400px;
            background: var(--bg-tertiary);
            cursor: default;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
        }

        /* ============== LIMITS INFO & CHAR COUNTER ============== */
        .limits-info-box {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 1px solid #7dd3fc;
            border-radius: 16px;
            padding: 20px 24px;
            margin-bottom: 24px;
        }

        [data-theme="dark"] .limits-info-box {
            background: linear-gradient(135deg, #0c4a6e 0%, #075985 100%);
            border-color: #0284c7;
        }
        
        .limits-info-title {
            font-size: 1rem;
            font-weight: 700;
            color: #0284c7;
            margin: 0 0 12px 0;
        }

        [data-theme="dark"] .limits-info-title {
            color: #7dd3fc;
        }
        
        .limits-info-list {
            margin: 0;
            padding: 0 0 0 20px;
            color: #0369a1;
        }

        [data-theme="dark"] .limits-info-list {
            color: #bae6fd;
        }
        
        .limits-info-list li {
            margin-bottom: 6px;
            font-size: 0.9rem;
        }
        
        .limits-info-list li:last-child {
            margin-bottom: 0;
        }
        
        .char-counter {
            text-align: right;
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-top: 8px;
            font-weight: 500;
        }
        
        .char-counter.warning {
            color: #f59e0b;
        }
        
        .char-counter.error {
            color: #ef4444;
            font-weight: 700;
        }

        /* ============== UPLOAD ZONE ============== */
        .upload-zone {
            position: relative;
            border: 4px dashed var(--purple-300);
            border-radius: 24px;
            padding: 60px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            background: linear-gradient(135deg, var(--purple-50) 0%, var(--card-bg) 100%);
            overflow: hidden;
        }

        .upload-zone::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(circle, rgba(138, 43, 226, 0.1), transparent);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .upload-zone:hover::before {
            width: 500px;
            height: 500px;
        }

        .upload-zone:hover {
            border-color: var(--purple-500);
            background: var(--purple-100);
            transform: scale(1.02);
            box-shadow: 0 15px 40px rgba(138, 43, 226, 0.15);
        }

        [data-theme="dark"] .upload-zone:hover {
            background: rgba(139, 92, 246, 0.2);
        }

        .upload-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: iconBounce 2s ease-in-out infinite;
            position: relative;
            z-index: 1;
        }

        .upload-title {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--purple-700);
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
        }

        [data-theme="dark"] .upload-title {
            color: var(--purple-400);
        }

        .upload-subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
            position: relative;
            z-index: 1;
        }

        .file-input {
            position: absolute;
            width: 0;
            height: 0;
            opacity: 0;
            pointer-events: none;
        }

        .preview-box {
            margin-top: 24px;
            padding: 24px;
            background: var(--bg-tertiary);
            border: 3px solid var(--border-color);
            border-radius: 16px;
        }

        .preview-box img {
            width: 100%;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
        }

        /* ============== BUTTONS ============== */
        .btn-primary {
            width: 100%;
            padding: 22px;
            background: var(--gradient-purple);
            border: none;
            border-radius: 16px;
            color: white;
            font-family: 'Poppins', sans-serif;
            font-size: 1.3rem;
            font-weight: 900;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 10px 30px rgba(124, 58, 237, 0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn-primary:hover::before {
            width: 400px;
            height: 400px;
        }

        .btn-primary:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 20px 50px rgba(124, 58, 237, 0.6);
        }

        .btn-primary:active {
            transform: translateY(-1px) scale(0.98);
        }

        .btn-primary.btn-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            box-shadow: 0 10px 30px rgba(239, 68, 68, 0.4);
        }
        .btn-primary.btn-danger:hover {
            box-shadow: 0 20px 50px rgba(239, 68, 68, 0.6);
        }

        /* ============== FILTER BUTTONS ============== */
        .btn-filter {
            padding: 10px 20px;
            border-radius: 100px;
            border: 2px solid var(--border-color);
            background: var(--card-bg);
            color: var(--text-secondary);
            font-weight: 700;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .btn-filter:hover {
            border-color: var(--purple-500);
            color: var(--purple-700);
        }
        .btn-filter.active {
            background: var(--gradient-purple);
            color: white;
            border-color: transparent;
        }
        .btn-filter.easy { border-color: #10b981; color: #10b981; }
        .btn-filter.easy:hover, .btn-filter.easy.active { background: #10b981; color: white; border-color: #10b981; }
        .btn-filter.medium { border-color: #f59e0b; color: #f59e0b; }
        .btn-filter.medium:hover, .btn-filter.medium.active { background: #f59e0b; color: white; border-color: #f59e0b; }
        .btn-filter.hard { border-color: #ef4444; color: #ef4444; }
        .btn-filter.hard:hover, .btn-filter.hard.active { background: #ef4444; color: white; border-color: #ef4444; }

        /* ============== IMAGE SOURCE TOGGLE ============== */
        .image-source-toggle {
            display: flex;
            gap: 12px;
            margin-top: 12px;
        }
        .source-btn {
            flex: 1;
            padding: 12px 20px;
            border-radius: 12px;
            border: 2px solid var(--border-color);
            background: var(--card-bg);
            color: var(--text-secondary);
            font-weight: 700;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .source-btn:hover {
            border-color: var(--purple-500);
            color: var(--purple-700);
        }
        .source-btn.active {
            background: var(--gradient-purple);
            color: white;
            border-color: transparent;
        }

        /* ============== SCANNER TABS ============== */
        .scanner-tab {
            flex: 1;
            padding: 14px 24px;
            border: 2px solid var(--border-color);
            background: var(--card-bg);
            color: var(--text-secondary);
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        .scanner-tab:first-child { border-radius: 12px 0 0 12px; }
        .scanner-tab:last-child { border-radius: 0 12px 12px 0; border-left: none; }
        .scanner-tab:hover { color: var(--purple-700); }
        .scanner-tab.active {
            background: var(--gradient-purple);
            color: white;
            border-color: var(--purple-700);
        }
        .scanner-tab .demo-badge {
            display: inline-block;
            background: #f59e0b;
            color: white;
            padding: 2px 8px;
            border-radius: 100px;
            font-size: 0.7rem;
            font-weight: 700;
            margin-left: 6px;
            vertical-align: middle;
        }
        .demo-notice {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 2px solid #f59e0b;
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 20px;
            font-size: 0.95rem;
            color: #92400e;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .demo-notice span { font-size: 1.4rem; }
        [data-theme="dark"] .demo-notice {
            background: rgba(245, 158, 11, 0.15);
            color: #fcd34d;
        }

        /* ============== UPLOAD ZONE ============== */
        .upload-zone {
            border: 3px dashed var(--border-color);
            border-radius: 16px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: var(--bg-tertiary);
        }
        .upload-zone:hover {
            border-color: var(--purple-500);
            background: var(--purple-50);
        }
        .upload-zone.dragover {
            border-color: var(--purple-600);
            background: var(--purple-100);
            transform: scale(1.02);
        }
        .upload-zone .upload-icon { font-size: 3rem; margin-bottom: 12px; }
        .upload-zone .upload-text, .upload-zone .upload-title { font-weight: 700; color: var(--text-primary); margin-bottom: 4px; }
        .upload-zone .upload-hint, .upload-zone .upload-subtitle { font-size: 0.9rem; color: var(--text-muted); }
        .upload-zone.has-file { border-style: solid; border-color: var(--purple-500); background: var(--purple-50); }

        /* ============== CHALLENGES GRID ============== */
        .challenges-grid {
            display: grid;
            gap: 16px;
        }
        .challenge-card {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 16px;
            padding: 20px;
            transition: all 0.3s;
        }
        .challenge-card:hover {
            border-color: var(--purple-500);
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }
        .challenge-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px; }
        .challenge-title { font-weight: 800; font-size: 1.1rem; color: var(--text-primary); }
        .challenge-points { font-weight: 900; font-size: 1.3rem; color: var(--purple-700); }
        .challenge-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 100px;
            font-size: 0.75rem;
            font-weight: 800;
            text-transform: uppercase;
            margin-top: 4px;
        }
        .challenge-badge.easy { background: #dcfce7; color: #166534; }
        .challenge-badge.medium { background: #fef3c7; color: #92400e; }
        .challenge-badge.hard { background: #fee2e2; color: #991b1b; }
        .challenge-desc { color: var(--text-secondary); font-size: 0.95rem; margin-bottom: 16px; }
        .challenge-meta { display: flex; justify-content: space-between; align-items: center; }
        .challenge-solved { font-size: 0.85rem; color: var(--text-muted); }

        /* ============== POINTS BANNER ============== */
        .points-banner {
            background: linear-gradient(135deg, var(--purple-600) 0%, var(--purple-800) 100%);
            border-radius: 16px;
            padding: 20px 32px;
            margin-bottom: 24px;
            color: white;
        }
        .points-info {
            display: flex;
            justify-content: center;
            gap: 48px;
            flex-wrap: wrap;
        }
        .points-stat {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }
        .points-value {
            font-size: 2rem;
            font-weight: 900;
            line-height: 1;
        }
        .points-label {
            font-size: 0.85rem;
            font-weight: 600;
            opacity: 0.9;
        }

        /* ============== CHALLENGES LAYOUT ============== */
        .challenges-layout {
            display: grid;
            grid-template-columns: 1fr 320px;
            gap: 24px;
        }
        @media (max-width: 1024px) {
            .challenges-layout {
                grid-template-columns: 1fr;
            }
            .leaderboard-card {
                order: -1;
            }
        }
        .challenges-main {
            min-width: 0;
        }

        /* ============== LEADERBOARD CARD ============== */
        .leaderboard-card {
            height: fit-content;
            position: sticky;
            top: 100px;
        }
        .leaderboard-entry {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 12px;
            margin-bottom: 8px;
            transition: background 0.2s;
        }
        .leaderboard-entry:hover {
            background: var(--bg-tertiary);
        }
        .leaderboard-entry.top-1 {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
        }
        .leaderboard-entry.top-2 {
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
        }
        .leaderboard-entry.top-3 {
            background: linear-gradient(135deg, #fed7aa 0%, #fdba74 100%);
        }
        .leaderboard-rank {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 0.9rem;
            border-radius: 50%;
            background: var(--bg-secondary);
            color: var(--text-secondary);
            flex-shrink: 0;
        }
        .leaderboard-entry.top-1 .leaderboard-rank { background: #f59e0b; color: white; }
        .leaderboard-entry.top-2 .leaderboard-rank { background: #9ca3af; color: white; }
        .leaderboard-entry.top-3 .leaderboard-rank { background: #f97316; color: white; }
        
        /* Current user highlighting */
        .leaderboard-entry.current-user {
            background: linear-gradient(135deg, var(--purple-100) 0%, var(--purple-200) 100%);
            border: 2px solid var(--purple-500);
            box-shadow: 0 0 12px rgba(139, 92, 246, 0.3);
        }
        .leaderboard-entry.current-user .leaderboard-username {
            color: var(--purple-700);
        }
        .leaderboard-entry.current-user .leaderboard-username::after {
            content: " (You)";
            font-weight: 500;
            font-size: 0.8rem;
            opacity: 0.8;
        }
        
        .leaderboard-user {
            flex: 1;
            min-width: 0;
        }
        .leaderboard-username {
            font-weight: 700;
            font-size: 0.95rem;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .leaderboard-solved {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        .leaderboard-points {
            font-weight: 900;
            font-size: 1.1rem;
            color: var(--purple-700);
            flex-shrink: 0;
        }
        .leaderboard-empty {
            text-align: center;
            padding: 32px;
            color: var(--text-muted);
        }
        .leaderboard-empty-icon {
            font-size: 2.5rem;
            margin-bottom: 8px;
        }

        /* ============== RESULT BOX ============== */
        .result-box {
            background: var(--bg-tertiary);
            border-radius: 16px;
            padding: 20px;
            margin-top: 20px;
        }
        .result-box.success {
            background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
            border: 2px solid #10b981;
        }
        .result-box.error {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            border: 2px solid #ef4444;
        }

        /* ============== SCANNER RESULTS ============== */
        .scanner-result {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 16px;
            padding: 24px;
            margin-top: 20px;
        }
        .scanner-meter {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }
        .scanner-score {
            font-size: 3rem;
            font-weight: 900;
            line-height: 1;
        }
        .scanner-score.clean { color: #10b981; }
        .scanner-score.suspicious { color: #f59e0b; }
        .scanner-score.likely { color: #ef4444; }
        .scanner-verdict {
            font-weight: 700;
            text-transform: uppercase;
            font-size: 0.9rem;
        }
        .scanner-indicators {
            background: var(--bg-tertiary);
            border-radius: 12px;
            padding: 16px;
        }
        .scanner-indicators h4 { margin: 0 0 12px 0; font-weight: 700; }
        .scanner-indicators ul { margin: 0; padding-left: 20px; }
        .scanner-indicators li { margin-bottom: 6px; color: var(--text-secondary); }

        .btn-action {
            padding: 16px 36px;
            background: white;
            border: 3px solid var(--purple-300);
            border-radius: 14px;
            color: var(--purple-700);
            font-weight: 700;
            font-size: 1.05rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
            font-family: 'Poppins', sans-serif;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .btn-action::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(138, 43, 226, 0.1), transparent);
            transition: left 0.5s;
        }

        .btn-action:hover::before {
            left: 100%;
        }

        .btn-action:hover {
            background: var(--purple-50);
            border-color: var(--purple-500);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(138, 43, 226, 0.2);
        }

        /* ============== RESULTS ============== */
        .result-container {
            margin-top: 48px;
            padding: 48px;
            background: linear-gradient(135deg, #10b981 0%, #3b82f6 100%);
            border-radius: 24px;
            animation: celebration 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 0 20px 50px rgba(16, 185, 129, 0.3);
            position: relative;
            overflow: hidden;
        }

        .result-container::before {
            content: '';
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 3rem;
            animation: spin 3s linear infinite;
        }

        @keyframes celebration {
            0% { opacity: 0; transform: scale(0.8) translateY(30px); }
            50% { transform: scale(1.05) translateY(-10px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
        }

        .result-icon {
            font-size: 3rem;
        }

        .result-title {
            font-size: 2rem;
            font-weight: 900;
            color: white;
        }

        .result-content {
            background: var(--card-bg);
            padding: 32px;
            border-radius: 16px;
            box-shadow: var(--shadow-lg);
        }

        .result-actions {
            display: flex;
            gap: 20px;
            margin-top: 24px;
            justify-content: flex-end;
            flex-wrap: wrap;
        }

        /* ============== ANALYTICS ============== */
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 24px;
            margin: 32px 0;
        }

        .metric-card {
            background: var(--card-bg);
            padding: 28px;
            border-radius: 16px;
            text-align: center;
            box-shadow: var(--shadow-lg);
            border: 2px solid var(--border-color);
        }

        [data-theme="dark"] .metric-card {
            border-color: var(--purple-300);
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: 900;
            background: var(--gradient-purple);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .metric-label {
            font-size: 0.9rem;
            color: var(--gray-700);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* ============== GUIDE SECTION ============== */
        .guide-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .guide-card {
            background: var(--card-bg);
            padding: 40px;
            border-radius: 20px;
            border: 2px solid var(--border-color);
            margin-bottom: 24px;
        }

        .guide-number {
            display: inline-block;
            width: 40px;
            height: 40px;
            background: var(--gradient-purple);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 40px;
            font-weight: 900;
            margin-bottom: 16px;
        }

        .guide-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 12px;
        }

        .guide-text {
            font-size: 1.05rem;
            line-height: 1.8;
            color: var(--text-secondary);
        }

        /* ============== STEGANOGRAPHY HISTORY TIMELINE ============== */
        .stego-timeline {
            position: relative;
            padding-left: 40px;
        }

        .stego-timeline::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(to bottom, var(--purple-400), var(--purple-600));
            border-radius: 3px;
        }

        .timeline-item {
            position: relative;
            margin-bottom: 32px;
            padding-left: 24px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -25px;
            top: 8px;
            width: 14px;
            height: 14px;
            background: var(--purple-600);
            border: 3px solid var(--card-bg);
            border-radius: 50%;
            box-shadow: 0 0 0 3px var(--purple-200);
        }

        .timeline-date {
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--purple-600);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .timeline-content {
            background: var(--card-bg);
            padding: 20px 24px;
            border-radius: 16px;
            border: 2px solid var(--border-color);
            transition: all 0.2s;
        }

        .timeline-content:hover {
            border-color: var(--purple-300);
            transform: translateX(4px);
        }

        .timeline-content h3 {
            font-size: 1.1rem;
            margin: 0 0 8px 0;
            color: var(--text-primary);
        }

        .timeline-content p {
            font-size: 0.95rem;
            color: var(--text-secondary);
            margin: 0;
            line-height: 1.6;
        }

        /* Techniques Grid */
        .techniques-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .technique-card {
            background: var(--card-bg);
            padding: 24px;
            border-radius: 16px;
            border: 2px solid var(--border-color);
            text-align: center;
            transition: all 0.2s;
        }

        .technique-card:hover {
            border-color: var(--purple-400);
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(124, 58, 237, 0.15);
        }

        .technique-icon {
            font-size: 2.5rem;
            margin-bottom: 12px;
        }

        .technique-card h4 {
            font-size: 1.1rem;
            margin: 0 0 8px 0;
            color: var(--text-primary);
        }

        .technique-card p {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin: 0;
            line-height: 1.5;
        }

        /* Uses Grid */
        .uses-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .use-card {
            background: linear-gradient(135deg, var(--purple-50) 0%, var(--card-bg) 100%);
            padding: 24px;
            border-radius: 16px;
            border: 2px solid var(--purple-200);
        }

        [data-theme="dark"] .use-card {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, var(--card-bg) 100%);
            border-color: rgba(139, 92, 246, 0.3);
        }

        .use-card h4 {
            font-size: 1.05rem;
            margin: 0 0 8px 0;
            color: var(--text-primary);
        }

        .use-card p {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin: 0;
            line-height: 1.5;
        }

        /* ============== TUTORIAL OVERLAY ============== */
        .tutorial-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(2px);
            z-index: 10001;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .tutorial-overlay.active {
            display: flex;
        }

        .tutorial-spotlight {
            position: absolute;
            border: 4px solid var(--purple-500);
            border-radius: 16px;
            box-shadow: 0 0 40px var(--purple-500), 0 0 60px rgba(124, 58, 237, 0.6);
            pointer-events: none;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 10002;
            background: transparent;
        }

        .tutorial-card {
            position: fixed;
            background: var(--card-bg);
            border-radius: 24px;
            padding: 40px;
            max-width: 500px;
            box-shadow: 0 25px 70px rgba(124, 58, 237, 0.4);
            z-index: 10003;
            animation: tutorialSlideIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes tutorialSlideIn {
            from { opacity: 0; transform: translateY(30px) scale(0.9); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .tutorial-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
        }

        .tutorial-step-badge {
            background: var(--gradient-purple);
            color: white;
            padding: 8px 20px;
            border-radius: 100px;
            font-weight: 800;
            font-size: 0.9rem;
        }

        .tutorial-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--gray-900);
            margin-bottom: 16px;
        }

        .tutorial-description {
            font-size: 1.1rem;
            color: var(--gray-700);
            line-height: 1.7;
            margin-bottom: 32px;
        }

        /* ============== AUTH MODAL ============== */
        .auth-modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(8px);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .auth-modal.active {
            display: flex;
        }

        .auth-modal-content {
            background: var(--card-bg);
            border-radius: 24px;
            padding: 40px;
            max-width: 440px;
            width: 100%;
            box-shadow: 0 25px 70px rgba(0, 0, 0, 0.3);
            animation: modalSlideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        @keyframes modalSlideIn {
            from { opacity: 0; transform: translateY(-30px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .auth-modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--bg-secondary);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.3s;
            color: var(--text-primary);
        }

        .auth-modal-close:hover {
            background: var(--bg-tertiary);
            transform: rotate(90deg);
        }

        .auth-modal-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .auth-modal-icon {
            font-size: 3rem;
            margin-bottom: 16px;
        }

        .auth-modal-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .auth-modal-subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
        }

        .auth-form-group {
            margin-bottom: 20px;
        }

        .auth-form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .auth-form-input {
            width: 100%;
            padding: 14px 18px;
            border: 3px solid var(--border-color);
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s;
            background: var(--input-bg);
            color: var(--text-primary);
        }

        .auth-form-input:focus {
            outline: none;
            border-color: var(--purple-500);
            box-shadow: 0 0 0 4px var(--purple-100);
        }

        [data-theme="dark"] .auth-form-input:focus {
            box-shadow: 0 0 0 4px rgba(139, 92, 246, 0.2);
        }

        .auth-form-input.error {
            border-color: #ef4444;
            box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1);
        }

        .auth-form-error {
            color: #ef4444;
            font-size: 0.85rem;
            margin-top: 6px;
            display: none;
        }

        .auth-form-error.show {
            display: block;
        }

        .auth-form-hint {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 6px;
        }

        .auth-submit-btn {
            width: 100%;
            padding: 16px;
            background: var(--gradient-purple);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Poppins', sans-serif;
            margin-top: 10px;
        }

        .auth-submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(124, 58, 237, 0.4);
        }

        .auth-submit-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }

        .auth-submit-btn .btn-spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin-right: 10px;
        }

        .auth-submit-btn.loading .btn-spinner {
            display: inline-block;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .auth-switch {
            text-align: center;
            margin-top: 20px;
            color: var(--gray-700);
        }

        .auth-switch-link {
            color: var(--purple-700);
            font-weight: 600;
            cursor: pointer;
        }

        .auth-switch-link:hover {
            text-decoration: underline;
        }

        .password-strength {
            height: 6px;
            border-radius: 3px;
            background: var(--gray-200);
            margin-top: 8px;
            overflow: hidden;
        }

        .password-strength-bar {
            height: 100%;
            border-radius: 3px;
            transition: all 0.3s;
            width: 0%;
        }

        .password-strength-bar.weak { width: 25%; background: #ef4444; }
        .password-strength-bar.fair { width: 50%; background: #f59e0b; }
        .password-strength-bar.good { width: 75%; background: #10b981; }
        .password-strength-bar.strong { width: 100%; background: #059669; }

        /* ============== LIMITS INFO BOX ============== */
        .limits-info {
            background: linear-gradient(135deg, var(--purple-50) 0%, var(--purple-100) 100%);
            border: 2px solid var(--purple-200);
            border-radius: 16px;
            padding: 20px 24px;
            margin-bottom: 24px;
        }

        .limits-info-title {
            font-weight: 700;
            color: var(--purple-900);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .limits-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
        }

        .limits-info-item {
            background: white;
            padding: 12px;
            border-radius: 10px;
            text-align: center;
        }

        .limits-info-value {
            font-weight: 800;
            color: var(--purple-700);
            font-size: 1.1rem;
        }

        .limits-info-label {
            font-size: 0.8rem;
            color: var(--gray-700);
        }

        .char-counter {
            text-align: right;
            font-size: 0.85rem;
            color: var(--gray-700);
            margin-top: 8px;
        }

        .char-counter.warning {
            color: #f59e0b;
        }

        .char-counter.danger {
            color: #ef4444;
        }

        /* ============== HISTORY PANEL ============== */
        .history-panel {
            background: var(--card-bg);
            border-radius: 24px;
            border: 3px solid var(--border-color);
            box-shadow: var(--shadow-xl);
            overflow: hidden;
            margin-bottom: 40px;
        }

        .history-header {
            background: linear-gradient(135deg, var(--purple-50) 0%, var(--card-bg) 100%);
            padding: 24px 32px;
            border-bottom: 2px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        [data-theme="dark"] .history-header {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, var(--card-bg) 100%);
        }

        .history-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--text-primary);
        }

        .history-actions {
            display: flex;
            gap: 12px;
        }

        .history-list {
            max-height: 500px;
            overflow-y: auto;
        }

        .history-item:hover {
            background: var(--bg-tertiary);
        }

        .history-item-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .history-item-icon.encode {
            background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
        }

        .history-item-icon.decode {
            background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%);
        }

        .history-item-content {
            flex: 1;
        }

        .history-item-title {
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .history-item-meta {
            font-size: 0.85rem;
            color: var(--text-secondary);
            display: flex;
            gap: 16px;
        }

        .history-item-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .history-item-badge.text {
            background: #dbeafe;
            color: #1d4ed8;
        }

        .history-item-badge.image {
            background: #fce7f3;
            color: #be185d;
        }

        .history-item-badge.encrypted {
            background: #dcfce7;
            color: #166534;
        }

        [data-theme="dark"] .history-item-badge.text {
            background: rgba(59, 130, 246, 0.2);
            color: #60a5fa;
        }

        [data-theme="dark"] .history-item-badge.image {
            background: rgba(236, 72, 153, 0.2);
            color: #f472b6;
        }

        [data-theme="dark"] .history-item-badge.encrypted {
            background: rgba(16, 185, 129, 0.2);
            color: #34d399;
        }

        .history-item-delete {
            opacity: 0;
            transition: opacity 0.2s;
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            color: #ef4444;
        }

        .history-item:hover .history-item-delete {
            opacity: 1;
        }

        .history-item-delete:hover {
            background: #fef2f2;
        }

        .history-item-wrapper {
            border-bottom: 1px solid var(--border-color);
        }

        .history-item {
            padding: 20px 32px;
            display: flex;
            align-items: center;
            gap: 16px;
            transition: all 0.2s;
            cursor: pointer;
        }

        .history-item-expand {
            color: var(--text-secondary);
            transition: transform 0.3s;
            font-size: 0.8rem;
        }

        .history-item-wrapper.expanded .history-item-expand {
            transform: rotate(180deg);
        }

        .history-item-details {
            display: none;
            padding: 0 32px 24px 32px;
            background: var(--bg-secondary);
            animation: slideDown 0.3s ease;
        }

        .history-item-wrapper.expanded .history-item-details {
            display: block;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .history-details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 16px;
        }

        .history-detail-section {
            background: var(--bg-tertiary);
            padding: 16px;
            border-radius: 12px;
        }

        .history-detail-section h4 {
            margin: 0 0 12px 0;
            font-size: 0.95rem;
            color: var(--text-primary);
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 8px;
        }

        .history-detail-row {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            font-size: 0.9rem;
        }

        .history-detail-label {
            color: var(--text-secondary);
        }

        .history-detail-value {
            color: var(--text-primary);
            font-weight: 500;
            text-transform: capitalize;
        }

        .history-detail-previews {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 16px;
        }

        .history-preview-box {
            background: var(--bg-tertiary);
            padding: 16px;
            border-radius: 12px;
        }

        .history-preview-box h4 {
            margin: 0 0 12px 0;
            font-size: 0.95rem;
            color: var(--text-primary);
        }

        .history-preview-content {
            background: var(--bg-primary);
            padding: 12px;
            border-radius: 8px;
            font-family: 'Fira Code', 'Consolas', monospace;
            font-size: 0.85rem;
            color: var(--text-secondary);
            max-height: 150px;
            overflow-y: auto;
            word-break: break-all;
            white-space: pre-wrap;
        }

        .history-empty {
            padding: 60px 20px;
            text-align: center;
            color: var(--gray-700);
        }

        .history-empty-icon {
            font-size: 4rem;
            margin-bottom: 16px;
        }

        .tutorial-controls {
            display: flex;
            gap: 12px;
            justify-content: space-between;
        }

        .tutorial-btn {
            padding: 14px 28px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
        }

        .tutorial-btn-primary {
            background: var(--gradient-purple);
            color: white;
            flex: 1;
        }

        .tutorial-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(124, 58, 237, 0.4);
        }

        .tutorial-btn-secondary {
            background: var(--gray-100);
            color: var(--gray-700);
        }

        .tutorial-btn-secondary:hover {
            background: var(--gray-200);
        }

        .tutorial-progress {
            display: flex;
            gap: 8px;
            margin-top: 24px;
            justify-content: center;
        }

        .tutorial-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--gray-200);
            transition: all 0.3s;
        }

        .tutorial-dot.active {
            background: var(--purple-500);
            width: 30px;
            border-radius: 5px;
        }

        /* ============== UTILITIES ============== */
        .hidden { display: none !important; }

        .toast {
            position: fixed;
            bottom: 40px;
            right: 40px;
            padding: 20px 32px;
            background: var(--gray-900);
            color: white;
            border-radius: 16px;
            font-weight: 700;
            font-size: 1.1rem;
            box-shadow: var(--shadow-xl);
            transform: translateX(400px);
            transition: transform 0.4s;
            z-index: 10000;
        }

        .toast.show {
            transform: translateX(0);
        }

        .loading-overlay {
            position: fixed;
            inset: 0;
            background: rgba(124, 58, 237, 0.95);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .spinner {
            width: 80px;
            height: 80px;
            border: 8px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            color: white;
            font-size: 1.5rem;
            font-weight: 800;
            margin-top: 24px;
        }

        /* ============== ACCOUNT SETTINGS PAGE ============== */
        .account-hero {
            text-align: center;
            padding: 60px 40px;
            background: linear-gradient(135deg, var(--purple-100), var(--purple-50));
            border-radius: 30px;
            margin-bottom: 40px;
            position: relative;
            overflow: hidden;
        }

        [data-theme="dark"] .account-hero {
            background: linear-gradient(135deg, rgba(124, 58, 237, 0.2), rgba(168, 85, 247, 0.1));
        }

        .account-hero::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -30%;
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(124, 58, 237, 0.15), transparent 70%);
            animation: float 8s ease-in-out infinite;
        }

        .account-avatar-large {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: var(--gradient-purple);
            margin: 0 auto 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: white;
            font-weight: 800;
            box-shadow: 0 10px 40px rgba(124, 58, 237, 0.4);
            position: relative;
            z-index: 1;
        }

        .account-name {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--text-primary);
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
        }

        .account-email-display {
            font-size: 1.1rem;
            color: var(--text-secondary);
            margin-bottom: 32px;
            position: relative;
            z-index: 1;
        }

        .account-stats-row {
            display: flex;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
            position: relative;
            z-index: 1;
        }

        .account-stat {
            text-align: center;
        }

        .account-stat-value {
            display: block;
            font-size: 2rem;
            font-weight: 900;
            color: var(--purple-700);
        }

        .account-stat-label {
            font-size: 0.9rem;
            color: var(--text-muted);
            font-weight: 600;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
            gap: 30px;
        }

        .settings-card {
            background: var(--card-bg);
            border-radius: 24px;
            border: 2px solid var(--purple-200);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        [data-theme="dark"] .settings-card {
            border-color: var(--purple-300);
        }

        .settings-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 50px rgba(124, 58, 237, 0.15);
        }

        .settings-card.danger {
            border-color: #fecaca;
        }

        .settings-card.danger:hover {
            box-shadow: 0 15px 50px rgba(239, 68, 68, 0.15);
        }

        [data-theme="dark"] .settings-card.danger {
            border-color: rgba(239, 68, 68, 0.4);
        }

        .settings-card-header {
            padding: 24px 28px;
            background: linear-gradient(135deg, var(--purple-50), transparent);
            border-bottom: 2px solid var(--purple-100);
            display: flex;
            align-items: center;
            gap: 16px;
        }

        [data-theme="dark"] .settings-card-header {
            background: linear-gradient(135deg, rgba(124, 58, 237, 0.1), transparent);
            border-bottom-color: var(--purple-200);
        }

        .settings-card.danger .settings-card-header {
            background: linear-gradient(135deg, #fef2f2, transparent);
            border-bottom-color: #fecaca;
        }

        [data-theme="dark"] .settings-card.danger .settings-card-header {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), transparent);
        }

        .settings-card-icon {
            width: 50px;
            height: 50px;
            border-radius: 14px;
            background: var(--gradient-purple);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .settings-card-icon.danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .settings-card-title {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--text-primary);
        }

        .settings-card-title.danger {
            color: #ef4444;
        }

        .settings-card-body {
            padding: 28px;
        }

        .profile-info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .profile-info-row:last-child {
            border-bottom: none;
        }

        .profile-label {
            font-weight: 600;
            color: var(--text-muted);
        }

        .profile-value {
            font-weight: 700;
            color: var(--text-primary);
        }

        .settings-btn {
            width: 100%;
            padding: 16px 24px;
            border-radius: 14px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            font-family: 'Poppins', sans-serif;
            margin-top: 16px;
        }

        .settings-btn.primary {
            background: var(--gradient-purple);
            color: white;
            box-shadow: 0 4px 15px rgba(124, 58, 237, 0.3);
        }

        .settings-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(124, 58, 237, 0.4);
        }

        .settings-btn.danger {
            background: #fef2f2;
            color: #ef4444;
            border: 2px solid #fecaca;
        }

        .settings-btn.danger:hover {
            background: #fee2e2;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.2);
        }

        [data-theme="dark"] .settings-btn.danger {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.4);
        }

        [data-theme="dark"] .settings-btn.danger:hover {
            background: rgba(239, 68, 68, 0.2);
        }

        .danger-warning {
            color: var(--text-secondary);
            line-height: 1.7;
            margin-bottom: 8px;
        }

        /* ============== STEGANOGRAPHY HISTORY PAGE ============== */
        .history-section {
            margin-bottom: 48px;
        }

        .history-section-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 3px solid var(--purple-200);
        }

        /* Timeline */
        .history-timeline {
            position: relative;
            padding-left: 40px;
        }

        .history-timeline::before {
            content: '';
            position: absolute;
            left: 12px;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--gradient-purple);
            border-radius: 2px;
        }

        .timeline-item {
            position: relative;
            margin-bottom: 32px;
            padding-left: 24px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -34px;
            top: 8px;
            width: 16px;
            height: 16px;
            background: var(--purple-500);
            border-radius: 50%;
            border: 4px solid var(--card-bg);
            box-shadow: 0 0 0 4px var(--purple-200);
        }

        .timeline-year {
            display: inline-block;
            background: var(--gradient-purple);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .timeline-content h4 {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .timeline-content p {
            color: var(--text-secondary);
            line-height: 1.7;
        }

        /* Cases Grid */
        .history-cases-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
        }

        .history-case-card {
            background: var(--bg-tertiary);
            border-radius: 16px;
            padding: 24px;
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .history-case-card:hover {
            transform: translateY(-4px);
            border-color: var(--purple-400);
            box-shadow: 0 12px 40px rgba(138, 43, 226, 0.15);
        }

        .case-icon {
            font-size: 2.5rem;
            margin-bottom: 12px;
        }

        .history-case-card h4 {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .history-case-card p {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 12px;
        }

        .case-tag {
            display: inline-block;
            background: var(--purple-100);
            color: var(--purple-700);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        [data-theme="dark"] .case-tag {
            background: rgba(139, 92, 246, 0.2);
            color: var(--purple-300);
        }

        /* Attack Grid */
        .attack-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 24px;
        }

        .attack-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 24px;
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .attack-card:hover {
            border-color: var(--purple-400);
        }

        .attack-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .attack-icon {
            font-size: 1.8rem;
        }

        .attack-header h4 {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .attack-card p {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 16px;
        }

        .attack-effectiveness {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .effectiveness-bar {
            flex: 1;
            height: 8px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            overflow: hidden;
        }

        .effectiveness-bar div {
            height: 100%;
            background: var(--gradient-purple);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        /* Techniques Grid */
        .techniques-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
        }

        .technique-card {
            background: var(--bg-tertiary);
            border-radius: 16px;
            padding: 24px;
            border: 2px solid var(--border-color);
        }

        .technique-card h4 {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 16px;
        }

        .technique-card ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .technique-card li {
            padding: 8px 0;
            color: var(--text-secondary);
            font-size: 0.95rem;
            border-bottom: 1px solid var(--border-color);
        }

        .technique-card li:last-child {
            border-bottom: none;
        }

        .technique-card li strong {
            color: var(--purple-600);
        }

        [data-theme="dark"] .technique-card li strong {
            color: var(--purple-400);
        }

        /* Fun Facts */
        .fun-facts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .fun-fact {
            display: flex;
            gap: 16px;
            align-items: flex-start;
            background: linear-gradient(135deg, var(--purple-50) 0%, var(--card-bg) 100%);
            padding: 20px;
            border-radius: 12px;
            border: 2px solid var(--purple-200);
        }

        [data-theme="dark"] .fun-fact {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, var(--card-bg) 100%);
        }

        .fun-fact-icon {
            font-size: 2rem;
            flex-shrink: 0;
        }

        .fun-fact p {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.6;
            margin: 0;
        }

        /* ============== RESPONSIVE ============== */
        @media (max-width: 1200px) {
            .nav-container {
                padding: 0 16px;
            }
            
            .nav-menu {
                gap: 0.25rem;
            }
            
            .nav-link {
                padding: 0.6rem 1rem;
                font-size: 0.85rem;
            }
            
            .nav-auth-btn {
                padding: 10px 18px;
                font-size: 0.85rem;
                min-width: 80px;
            }
        }
        
        @media (max-width: 992px) {
            .nav-container {
                flex-direction: column;
                gap: 16px;
            }
            
            .nav-menu {
                order: 3;
                width: 100%;
            }
            
            .logo {
                order: 1;
            }
            
            .nav-auth, .user-menu {
                order: 2;
            }
        }
        
        @media (max-width: 768px) {
            .hero-title { font-size: 2.5rem; }
            
            .nav-menu {
                flex-wrap: wrap;
                justify-content: center;
                gap: 4px;
                padding: 6px;
                width: 100%;
                border-radius: 16px;
            }
            
            .nav-link,
            .nav-dropdown-btn {
                padding: 8px 12px;
                font-size: 0.8rem;
            }

            .nav-dropdown-btn::after {
                border-width: 3px;
            }
            
            .nav-dropdown-content {
                min-width: 180px;
                padding: 6px;
            }

            .nav-dropdown-item {
                padding: 8px 10px;
                font-size: 0.85rem;
            }
            
            .nav-auth-btn {
                padding: 8px 16px;
                font-size: 0.8rem;
                min-width: 70px;
            }

            .card-body { padding: 24px; }
            .main-container { padding: 16px; }

            /* Timeline responsive */
            .stego-timeline {
                padding-left: 30px;
            }

            .timeline-item {
                padding-left: 16px;
            }

            .timeline-content {
                padding: 16px;
            }

            .techniques-grid,
            .uses-grid {
                grid-template-columns: 1fr;
            }
        }

        /* ============== DROPDOWN MENU ============== */
        .nav-dropdown {
            position: relative;
        }

        .nav-dropdown-content {
            visibility: hidden;
            opacity: 0;
            position: absolute;
            top: calc(100% + 4px);
            left: 50%;
            transform: translateX(-50%) translateY(-8px);
            background: var(--card-bg);
            min-width: 200px;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
            z-index: 1001;
            padding: 8px;
            border: 1px solid var(--border-color);
            transition: all 0.2s ease;
        }

        /* Invisible bridge to prevent gap hover issues */
        .nav-dropdown::before {
            content: '';
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            height: 10px;
            background: transparent;
        }

        .nav-dropdown:hover .nav-dropdown-content,
        .nav-dropdown:focus-within .nav-dropdown-content {
            visibility: visible;
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        .nav-dropdown-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            border-radius: 8px;
            cursor: pointer;
            color: var(--text-secondary);
            font-weight: 500;
            font-size: 0.9rem;
            transition: all 0.15s;
            text-decoration: none;
        }

        .nav-dropdown-item:hover {
            background: var(--purple-100);
            color: var(--purple-700);
        }

        .nav-dropdown-item .item-icon {
            font-size: 1rem;
            width: 24px;
            text-align: center;
        }

        [data-theme="dark"] .nav-dropdown-content {
            background: var(--card-bg);
            box-shadow: 0 8px 30px rgba(0,0,0,0.4);
            border-color: rgba(255,255,255,0.1);
        }

        [data-theme="dark"] .nav-dropdown-item:hover {
            background: rgba(139, 92, 246, 0.2);
            color: var(--purple-300);
        }

        /* ============== LEARN PAGE STYLES ============== */
        .learn-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 24px;
        }

        .learn-hero {
            text-align: center;
            margin-bottom: 48px;
        }

        .learn-title {
            font-size: 2.8rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--purple-600), var(--purple-400));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 12px;
        }

        .learn-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
        }

        /* Navigation Cards Grid */
        .learn-nav-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 16px;
            margin-bottom: 48px;
        }

        .learn-nav-card {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 16px;
            padding: 24px 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.25s ease;
        }

        .learn-nav-card:hover {
            border-color: var(--purple-400);
            transform: translateY(-4px);
            box-shadow: 0 12px 32px rgba(124, 58, 237, 0.2);
        }

        .learn-nav-card.active {
            border-color: var(--purple-500);
            background: linear-gradient(135deg, var(--purple-50), var(--card-bg));
        }

        [data-theme="dark"] .learn-nav-card.active {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.15), var(--card-bg));
        }

        .learn-nav-icon {
            font-size: 2.5rem;
            margin-bottom: 12px;
        }

        .learn-nav-card h3 {
            font-size: 1rem;
            font-weight: 700;
            margin: 0 0 6px 0;
            color: var(--text-primary);
        }

        .learn-nav-card p {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin: 0;
        }

        /* Content Sections */
        .learn-section {
            display: none;
        }

        .learn-section.active {
            display: block;
            animation: fadeSlideIn 0.4s ease;
        }

        @keyframes fadeSlideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .learn-welcome-box {
            text-align: center;
            padding: 80px 40px;
            background: var(--card-bg);
            border-radius: 24px;
            border: 2px dashed var(--border-color);
        }

        .learn-welcome-icon {
            font-size: 4rem;
            margin-bottom: 24px;
            opacity: 0.8;
        }

        .learn-welcome-box h2 {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin: 0 0 8px 0;
        }

        .learn-welcome-box p {
            color: var(--text-secondary);
            margin: 0;
        }

        /* Section Header */
        .learn-section-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 32px;
            padding-bottom: 16px;
            border-bottom: 2px solid var(--border-color);
        }

        .learn-section-header .section-icon {
            font-size: 2rem;
        }

        .learn-section-header h2 {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--text-primary);
            margin: 0;
        }

        /* Info Cards Grid */
        .learn-cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 24px;
        }

        .learn-info-card {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 20px;
            padding: 28px;
            position: relative;
            overflow: hidden;
        }

        .learn-info-card .info-number {
            position: absolute;
            top: -10px;
            right: -10px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--purple-500), var(--purple-600));
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 800;
            opacity: 0.2;
        }

        .learn-info-card h3 {
            font-size: 1.15rem;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0 0 12px 0;
        }

        .learn-info-card p {
            color: var(--text-secondary);
            line-height: 1.7;
            margin: 0;
        }

        /* Modern Timeline */
        .history-timeline-modern {
            position: relative;
            padding-left: 50px;
        }

        .history-timeline-modern::before {
            content: '';
            position: absolute;
            left: 20px;
            top: 20px;
            bottom: 20px;
            width: 4px;
            background: linear-gradient(to bottom, var(--purple-300), var(--purple-600));
            border-radius: 4px;
        }

        .timeline-era {
            display: flex;
            align-items: center;
            gap: 16px;
            margin: 32px 0 16px -50px;
            padding-left: 50px;
        }

        .era-marker {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .era-marker.ancient { background: linear-gradient(135deg, #b8860b, #daa520); }
        .era-marker.medieval { background: linear-gradient(135deg, #8b4513, #a0522d); }
        .era-marker.modern { background: linear-gradient(135deg, #2f4f4f, #556b2f); }
        .era-marker.digital { background: linear-gradient(135deg, var(--purple-500), var(--purple-700)); }

        .era-label {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .timeline-event {
            position: relative;
            margin-bottom: 24px;
            padding-left: 20px;
        }

        .timeline-event::before {
            content: '';
            position: absolute;
            left: -30px;
            top: 12px;
            width: 12px;
            height: 12px;
            background: var(--purple-500);
            border-radius: 50%;
            border: 3px solid var(--body-bg);
        }

        .timeline-event .event-date {
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--purple-500);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .timeline-event .event-content {
            background: var(--card-bg);
            padding: 20px 24px;
            border-radius: 16px;
            border: 2px solid var(--border-color);
            transition: all 0.2s;
        }

        .timeline-event .event-content:hover {
            border-color: var(--purple-300);
            transform: translateX(8px);
        }

        .timeline-event .event-content h4 {
            font-size: 1.05rem;
            margin: 0 0 8px 0;
            color: var(--text-primary);
        }

        .timeline-event .event-content p {
            font-size: 0.92rem;
            color: var(--text-secondary);
            line-height: 1.6;
            margin: 0;
        }

        /* Techniques Showcase */
        .technique-showcase {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .technique-item {
            display: flex;
            gap: 24px;
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 20px;
            padding: 24px;
            transition: all 0.2s;
        }

        .technique-item:hover {
            border-color: var(--purple-300);
        }

        .technique-visual {
            flex: 0 0 180px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--purple-50), transparent);
            border-radius: 12px;
            padding: 16px;
        }

        [data-theme="dark"] .technique-visual {
            background: rgba(139, 92, 246, 0.1);
        }

        .pixel-demo {
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: monospace;
            font-size: 0.9rem;
        }

        .pixel-demo .pixel {
            background: var(--card-bg);
            padding: 8px 10px;
            border-radius: 6px;
            border: 1px solid var(--border-color);
        }

        .pixel-demo .lsb {
            color: var(--purple-600);
            font-weight: 700;
        }

        .pixel-demo .lsb.changed {
            color: #ef4444;
        }

        .pixel-demo .pixel-arrow {
            color: var(--text-secondary);
        }

        .zwc-demo {
            font-size: 1.1rem;
            text-align: center;
        }

        .zwc-demo .zwc-char {
            background: var(--purple-200);
            padding: 0 4px;
            border-radius: 2px;
        }

        .zwc-demo .zwc-reveal {
            font-size: 0.7rem;
            color: var(--text-secondary);
            margin-top: 8px;
            font-family: monospace;
        }

        .audio-demo, .video-demo, .network-demo, .doc-demo {
            font-size: 1.2rem;
            color: var(--text-secondary);
        }

        .technique-info {
            flex: 1;
        }

        .technique-info h3 {
            font-size: 1.2rem;
            margin: 0 0 12px 0;
            color: var(--text-primary);
        }

        .technique-info p {
            color: var(--text-secondary);
            line-height: 1.6;
            margin: 0 0 16px 0;
        }

        .technique-stats {
            display: flex;
            gap: 16px;
        }

        .technique-stats .stat {
            font-size: 0.8rem;
            padding: 6px 12px;
            background: var(--purple-100);
            color: var(--purple-700);
            border-radius: 20px;
            font-weight: 600;
        }

        [data-theme="dark"] .technique-stats .stat {
            background: rgba(139, 92, 246, 0.2);
            color: var(--purple-300);
        }

        /* Cases Showcase */
        .cases-showcase {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 24px;
        }

        .case-card-modern {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 20px;
            padding: 28px;
            position: relative;
            overflow: hidden;
            transition: all 0.2s;
        }

        .case-card-modern:hover {
            transform: translateY(-4px);
            border-color: var(--purple-300);
        }

        .case-badge {
            position: absolute;
            top: 16px;
            right: 16px;
            font-size: 0.7rem;
            font-weight: 700;
            padding: 4px 10px;
            border-radius: 20px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .case-badge.wartime { background: #fef3c7; color: #92400e; }
        .case-badge.espionage { background: #fee2e2; color: #991b1b; }
        .case-badge.classic { background: #e0e7ff; color: #3730a3; }
        .case-badge.forensics { background: #d1fae5; color: #065f46; }
        .case-badge.entertainment { background: #fce7f3; color: #9d174d; }
        .case-badge.modern { background: #ede9fe; color: #5b21b6; }

        [data-theme="dark"] .case-badge.wartime { background: rgba(251, 191, 36, 0.2); color: #fbbf24; }
        [data-theme="dark"] .case-badge.espionage { background: rgba(239, 68, 68, 0.2); color: #f87171; }
        [data-theme="dark"] .case-badge.classic { background: rgba(99, 102, 241, 0.2); color: #a5b4fc; }
        [data-theme="dark"] .case-badge.forensics { background: rgba(16, 185, 129, 0.2); color: #6ee7b7; }
        [data-theme="dark"] .case-badge.entertainment { background: rgba(236, 72, 153, 0.2); color: #f9a8d4; }
        [data-theme="dark"] .case-badge.modern { background: rgba(139, 92, 246, 0.2); color: #c4b5fd; }

        .case-icon-large {
            font-size: 2.5rem;
            margin-bottom: 16px;
        }

        .case-card-modern h3 {
            font-size: 1.15rem;
            margin: 0 0 12px 0;
            color: var(--text-primary);
        }

        .case-card-modern p {
            font-size: 0.92rem;
            color: var(--text-secondary);
            line-height: 1.6;
            margin: 0;
        }

        /* Detection Section */
        .detection-intro {
            background: linear-gradient(135deg, var(--purple-50), transparent);
            padding: 24px;
            border-radius: 16px;
            margin-bottom: 32px;
            text-align: center;
        }

        [data-theme="dark"] .detection-intro {
            background: rgba(139, 92, 246, 0.1);
        }

        .detection-intro p {
            font-size: 1.05rem;
            color: var(--text-secondary);
            margin: 0;
            line-height: 1.7;
        }

        .detection-methods {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .detection-card {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 16px;
            padding: 24px;
        }

        .detection-card .detection-icon {
            font-size: 2rem;
            margin-bottom: 12px;
        }

        .detection-card h3 {
            font-size: 1.1rem;
            margin: 0 0 10px 0;
            color: var(--text-primary);
        }

        .detection-card p {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.6;
            margin: 0 0 16px 0;
        }

        .effectiveness-meter {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .meter-bar {
            flex: 1;
            height: 8px;
            background: var(--border-color);
            border-radius: 4px;
            overflow: hidden;
        }

        .meter-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--purple-400), var(--purple-600));
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .detection-tip {
            background: linear-gradient(135deg, var(--purple-100), var(--purple-50));
            padding: 20px 24px;
            border-radius: 12px;
            border-left: 4px solid var(--purple-500);
            color: var(--text-secondary);
        }

        [data-theme="dark"] .detection-tip {
            background: rgba(139, 92, 246, 0.15);
        }

        .detection-tip a {
            color: var(--purple-600);
            font-weight: 600;
        }

        /* Best Practices */
        .practices-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }

        .practice-card {
            background: var(--card-bg);
            border-radius: 20px;
            overflow: hidden;
            border: 2px solid var(--border-color);
        }

        .practice-card.do .practice-header { background: linear-gradient(135deg, #10b981, #059669); }
        .practice-card.dont .practice-header { background: linear-gradient(135deg, #ef4444, #dc2626); }

        .practice-header {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px 20px;
            color: white;
        }

        .practice-icon {
            font-size: 1.5rem;
        }

        .practice-header h3 {
            margin: 0;
            font-size: 1.2rem;
        }

        .practice-list {
            padding: 20px 24px;
            margin: 0;
            list-style: none;
        }

        .practice-list li {
            padding: 10px 0;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-secondary);
            font-size: 0.92rem;
            line-height: 1.5;
        }

        .practice-list li:last-child {
            border-bottom: none;
        }

        .practice-card.do .practice-list li::before {
            content: ' ';
            color: #10b981;
            font-weight: 700;
        }

        .practice-card.dont .practice-list li::before {
            content: ' ';
            color: #ef4444;
            font-weight: 700;
        }

        /* Security Levels */
        .security-levels h3 {
            text-align: center;
            font-size: 1.4rem;
            margin-bottom: 24px;
            color: var(--text-primary);
        }

        .level-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .level-card {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 16px;
            padding: 24px;
            text-align: center;
        }

        .level-badge {
            display: inline-block;
            font-size: 0.75rem;
            font-weight: 700;
            padding: 6px 14px;
            border-radius: 20px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 16px;
        }

        .level-card.basic .level-badge { background: #fef3c7; color: #92400e; }
        .level-card.medium .level-badge { background: #dbeafe; color: #1e40af; }
        .level-card.high .level-badge { background: #d1fae5; color: #065f46; }

        [data-theme="dark"] .level-card.basic .level-badge { background: rgba(251, 191, 36, 0.2); color: #fbbf24; }
        [data-theme="dark"] .level-card.medium .level-badge { background: rgba(59, 130, 246, 0.2); color: #60a5fa; }
        [data-theme="dark"] .level-card.high .level-badge { background: rgba(16, 185, 129, 0.2); color: #6ee7b7; }

        .level-card h4 {
            font-size: 1.1rem;
            margin: 0 0 10px 0;
            color: var(--text-primary);
        }

        .level-card p {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin: 0 0 16px 0;
            line-height: 1.5;
        }

        .level-use {
            font-size: 0.8rem;
            color: var(--purple-600);
            font-weight: 600;
        }

        /* Responsive for Learn Page */
        @media (max-width: 768px) {
            .learn-title { font-size: 2rem; }
            .learn-nav-grid { grid-template-columns: repeat(2, 1fr); gap: 12px; }
            .learn-nav-card { padding: 16px 12px; }
            .learn-nav-icon { font-size: 2rem; }
            .technique-item { flex-direction: column; }
            .technique-visual { flex: none; width: 100%; }
            .history-timeline-modern { padding-left: 30px; }
            .timeline-era { margin-left: -30px; padding-left: 30px; }
        }
    </style>
</head>
<body>

    <!-- Loading Overlay -->
    <div id="loading" class="loading-overlay hidden">
        <div class="spinner"></div>
        <div class="loading-text">Processing...</div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">Notification</div>

    <!-- Tutorial Overlay -->
    <div id="tutorial-overlay" class="tutorial-overlay">
        <div id="tutorial-spotlight" class="tutorial-spotlight"></div>
        <div id="tutorial-card" class="tutorial-card">
            <div class="tutorial-header">
                <span id="tutorial-step-badge" class="tutorial-step-badge">Step 1 of 5</span>
            </div>
            <h2 id="tutorial-title" class="tutorial-title">Welcome to the Tutorial!</h2>
            <p id="tutorial-description" class="tutorial-description">Let's take a quick tour of the key features.</p>
            <div class="tutorial-controls">
                <button class="tutorial-btn tutorial-btn-secondary" onclick="skipTutorial()">Skip</button>
                <button id="tutorial-next" class="tutorial-btn tutorial-btn-primary" onclick="nextTutorialStep()">Next</button>
            </div>
            <div class="tutorial-progress" id="tutorial-progress">
                <div class="tutorial-dot active"></div>
                <div class="tutorial-dot"></div>
                <div class="tutorial-dot"></div>
                <div class="tutorial-dot"></div>
                <div class="tutorial-dot"></div>
                <div class="tutorial-dot"></div>
                <div class="tutorial-dot"></div>
                <div class="tutorial-dot"></div>
                <div class="tutorial-dot"></div>
                <div class="tutorial-dot"></div>
            </div>
        </div>
    </div>

    <!-- Auth Modal -->
    <div id="auth-modal" class="auth-modal">
        <div class="auth-modal-content">
            <button class="auth-modal-close" onclick="closeAuthModal()"></button>
            
            <!-- Login Form -->
            <div id="login-form" class="auth-form">
                <div class="auth-modal-header">
                    <div class="auth-modal-icon"></div>
                    <h2 class="auth-modal-title">Welcome Back</h2>
                    <p class="auth-modal-subtitle">Sign in to access your history and saved operations</p>
                </div>
                
                <div class="auth-form-group">
                    <label class="auth-form-label">Username or Email</label>
                    <input type="text" id="login-username" class="auth-form-input" placeholder="Enter username or email">
                    <div id="login-username-error" class="auth-form-error"></div>
                </div>
                
                <div class="auth-form-group">
                    <label class="auth-form-label">Password</label>
                    <input type="password" id="login-password" class="auth-form-input" placeholder="Enter your password">
                    <div id="login-password-error" class="auth-form-error"></div>
                </div>
                
                <button id="login-btn" onclick="handleLogin()" class="auth-submit-btn">
                    <span class="btn-spinner"></span>
                    <span class="btn-text">Sign In</span>
                </button>
                
                <p class="auth-switch">
                    Don't have an account? <span class="auth-switch-link" onclick="showSignupForm()">Create one</span>
                </p>
            </div>
            
            <!-- Signup Form -->
            <div id="signup-form" class="auth-form hidden">
                <div class="auth-modal-header">
                    <div class="auth-modal-icon"></div>
                    <h2 class="auth-modal-title">Create Account</h2>
                    <p class="auth-modal-subtitle">Sign up to save your history and access from anywhere</p>
                </div>
                
                <div class="auth-form-group">
                    <label class="auth-form-label">Username</label>
                    <input type="text" id="signup-username" class="auth-form-input" placeholder="Choose a username">
                    <div class="auth-form-hint">3-30 characters, letters, numbers, and underscores only</div>
                    <div id="signup-username-error" class="auth-form-error"></div>
                </div>
                
                <div class="auth-form-group">
                    <label class="auth-form-label">Email</label>
                    <input type="email" id="signup-email" class="auth-form-input" placeholder="Enter your email">
                    <div id="signup-email-error" class="auth-form-error"></div>
                </div>
                
                <div class="auth-form-group">
                    <label class="auth-form-label">Password</label>
                    <input type="password" id="signup-password" class="auth-form-input" placeholder="Create a strong password" oninput="updatePasswordStrength()">
                    <div class="password-strength">
                        <div id="password-strength-bar" class="password-strength-bar"></div>
                    </div>
                    <div class="auth-form-hint">Min 8 chars with uppercase, lowercase, number, and special character</div>
                    <div id="signup-password-error" class="auth-form-error"></div>
                </div>
                
                <div class="auth-form-group">
                    <label class="auth-form-label">Confirm Password</label>
                    <input type="password" id="signup-confirm" class="auth-form-input" placeholder="Confirm your password">
                    <div id="signup-confirm-error" class="auth-form-error"></div>
                </div>
                
                <button id="signup-btn" onclick="handleSignup()" class="auth-submit-btn">
                    <span class="btn-spinner"></span>
                    <span class="btn-text">Create Account</span>
                </button>
                
                <p class="auth-switch">
                    Already have an account? <span class="auth-switch-link" onclick="showLoginForm()">Sign in</span>
                </p>
            </div>
        </div>
    </div>

    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo" onclick="navigate('home')">Steganography Pro</div>
            
            <!-- Theme Toggle Button -->
            <button class="theme-toggle" onclick="toggleTheme()" title="Toggle dark mode" aria-label="Toggle dark mode">
                <span class="theme-icon-sun"></span>
                <span class="theme-icon-moon"></span>
            </button>
            
            <ul class="nav-menu">
                <li><a class="nav-link active" onclick="navigate('home')">Home</a></li>
                
                <!-- Encode Dropdown -->
                <li class="nav-dropdown">
                    <button class="nav-dropdown-btn">Encode</button>
                    <div class="nav-dropdown-content">
                        <a class="nav-dropdown-item" onclick="navigate('text-encode')">
                            <span class="item-icon"></span> Hide in Text
                        </a>
                        <a class="nav-dropdown-item" onclick="navigate('image-encode')">
                            <span class="item-icon"></span> Hide in Image
                        </a>
                        <a class="nav-dropdown-item" onclick="navigate('multi-file'); setMultiFileMode('encode')">
                            <span class="item-icon"></span> Multi-File Split
                        </a>
                    </div>
                </li>
                
                <!-- Decode Dropdown -->
                <li class="nav-dropdown">
                    <button class="nav-dropdown-btn">Decode</button>
                    <div class="nav-dropdown-content">
                        <a class="nav-dropdown-item" onclick="navigate('text-decode')">
                            <span class="item-icon"></span> Reveal from Text
                        </a>
                        <a class="nav-dropdown-item" onclick="navigate('image-decode')">
                            <span class="item-icon"></span> Reveal from Image
                        </a>
                        <a class="nav-dropdown-item" onclick="navigate('multi-file'); setMultiFileMode('decode')">
                            <span class="item-icon"></span> Multi-File Combine
                        </a>
                    </div>
                </li>
                
                <!-- Tools Dropdown -->
                <li class="nav-dropdown">
                    <button class="nav-dropdown-btn">Tools</button>
                    <div class="nav-dropdown-content">
                        <a class="nav-dropdown-item" onclick="navigate('scanner')">
                            <span class="item-icon"></span> Stego Scanner
                        </a>
                        <a class="nav-dropdown-item" onclick="navigate('challenges')">
                            <span class="item-icon"></span> Challenges
                        </a>
                    </div>
                </li>
                
                <li><a class="nav-link" onclick="navigate('history')">History</a></li>
                <li><a class="nav-link" onclick="navigate('learn')">Learn</a></li>
            </ul>
            
            <!-- Auth Buttons (shown when logged out) -->
            <div id="auth-buttons" class="nav-auth">
                <button class="nav-auth-btn login" onclick="openAuthModal('login')">Log In</button>
                <button class="nav-auth-btn signup" onclick="openAuthModal('signup')">Sign Up</button>
            </div>
            
            <!-- User Menu (shown when logged in) -->
            <div id="user-menu" class="user-menu">
                <div class="user-avatar" onclick="toggleUserDropdown()" id="user-avatar">U</div>
                <div id="user-dropdown" class="user-dropdown">
                    <div class="user-dropdown-header">
                        <div class="user-dropdown-name" id="user-dropdown-name">Username</div>
                        <div class="user-dropdown-email" id="user-dropdown-email">email@example.com</div>
                    </div>
                    <div class="user-dropdown-item" onclick="navigate('history')">
                         My History
                    </div>
                    <div class="user-dropdown-item" onclick="navigate('account')">
                         Account Settings
                    </div>
                    <div class="user-dropdown-item danger" onclick="handleLogout()">
                         Log Out
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="main-container">

        <!-- ========================================
             HOME PAGE
        ======================================== -->
        <section id="page-home" class="page-section active">
            <div class="hero">
                <div class="hero-badge">Professional Security Tool</div>
                <h1 class="hero-title">Hide Messages<br>Inside Text & Images</h1>
                <p class="hero-subtitle">
                    Military-grade steganography made simple. Hide confidential messages in plain sight with AES encryption and zero-knowledge security.
                </p>
                <div class="cta-buttons">
                    <button class="btn-cta" onclick="navigate('text-encode')">Start Hiding Messages</button>
                    <button class="btn-secondary" onclick="navigate('guide')">Learn How It Works</button>
                </div>
            </div>

            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon"></div>
                    <div class="feature-title">AES-128 Encryption</div>
                    <div class="feature-desc">Military-grade encryption protects your secrets with password-based security</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"></div>
                    <div class="feature-title">Completely Invisible</div>
                    <div class="feature-desc">Messages are hidden using Unicode steganography - undetectable to the human eye</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"></div>
                    <div class="feature-title">Quality Analysis</div>
                    <div class="feature-desc">Advanced metrics (MSE, PSNR, SSIM) ensure perfect image quality after encoding</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"></div>
                    <div class="feature-title">Lightning Fast</div>
                    <div class="feature-desc">Process messages and images in milliseconds with optimized algorithms</div>
                </div>
            </div>

            <!-- Live Statistics Dashboard -->
            <div class="stats-dashboard">
                <h2 class="section-title">Live Usage Statistics</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon"></div>
                        <div class="stat-value" id="stat-encodes">0</div>
                        <div class="stat-label">Messages Hidden</div>
                        <div class="stat-bar">
                            <div class="stat-bar-fill" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"></div>
                        <div class="stat-value" id="stat-decodes">0</div>
                        <div class="stat-label">Messages Revealed</div>
                        <div class="stat-bar">
                            <div class="stat-bar-fill" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"></div>
                        <div class="stat-value" id="stat-speed">0ms</div>
                        <div class="stat-label">Avg Processing Time</div>
                        <div class="stat-bar">
                            <div class="stat-bar-fill" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"></div>
                        <div class="stat-value" id="stat-success">100%</div>
                        <div class="stat-label">Success Rate</div>
                        <div class="stat-bar">
                            <div class="stat-bar-fill" style="width: 100%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sample Showcase -->
            <div class="showcase-section">
                <h2 class="section-title">See It In Action</h2>
                <p class="section-subtitle">Click on any sample to try it instantly</p>
                
                <div class="samples-grid">
                    <div class="sample-card" onclick="loadTextSample()">
                        <div class="sample-badge"> Popular</div>
                        <div class="sample-icon"></div>
                        <h3 class="sample-title">Corporate Email</h3>
                        <p class="sample-desc">Professional marketing email hiding confidential project details and budget info</p>
                        <button class="sample-btn">Try This Demo </button>
                    </div>
                    
                    <div class="sample-card" onclick="loadJournalistSample()">
                        <div class="sample-badge"> Trending</div>
                        <div class="sample-icon"></div>
                        <h3 class="sample-title">News Article</h3>
                        <p class="sample-desc">Public news story concealing protected source information and whistleblower contact</p>
                        <button class="sample-btn">Try This Demo </button>
                    </div>
                    
                    <div class="sample-card" onclick="loadSocialSample()">
                        <div class="sample-badge"> Creative</div>
                        <div class="sample-icon"></div>
                        <h3 class="sample-title">Social Media Post</h3>
                        <p class="sample-desc">Casual Instagram caption hiding secret meet-up coordinates and event details</p>
                        <button class="sample-btn">Try This Demo </button>
                    </div>
                    
                    <div class="sample-card" onclick="loadImageSample()">
                        <div class="sample-badge"> Advanced</div>
                        <div class="sample-icon"></div>
                        <h3 class="sample-title">Image Steganography</h3>
                        <p class="sample-desc">Upload your own photo and hide messages with 99.6% visual similarity</p>
                        <button class="sample-btn">Upload Image </button>
                    </div>
                    
                    <div class="sample-card" onclick="loadEncryptedSample()">
                        <div class="sample-badge"> Secure</div>
                        <div class="sample-icon"></div>
                        <h3 class="sample-title">Password Protected</h3>
                        <p class="sample-desc">Military-grade AES encryption protecting sensitive diplomatic communications</p>
                        <button class="sample-btn">Try This Demo </button>
                    </div>
                    
                    <div class="sample-card" onclick="navigate('guide')">
                        <div class="sample-badge"> Documentation</div>
                        <div class="sample-icon"></div>
                        <h3 class="sample-title">Learn The Science</h3>
                        <p class="sample-desc">Complete guide to zero-width characters, LSB encoding, and cryptographic techniques</p>
                        <button class="sample-btn">Read Guide </button>
                    </div>
                </div>
            </div>

            <!-- Animated Process Explanation -->
            <div class="process-explanation">
                <h2 class="section-title" style="color: var(--text-primary);">How The Magic Works</h2>
                <p class="section-subtitle" style="color: var(--text-secondary);">Watch the steganography process step-by-step</p>
                
                <div class="process-methods">
                    <div class="method-tab active" onclick="showMethod('text')">
                        <span class="method-icon"></span>
                        <span>Text Steganography</span>
                    </div>
                    <div class="method-tab" onclick="showMethod('image')">
                        <span class="method-icon"></span>
                        <span>Image Steganography</span>
                    </div>
                </div>

                <!-- Text Method Animation -->
                <div id="method-text" class="method-animation active">
                    <div class="animation-stage">
                        <div class="stage-step stage-1">
                            <div class="step-visual">
                                <div class="visual-box">
                                    <div class="visual-icon"></div>
                                    <div class="visual-label">Cover Text</div>
                                    <div class="visual-content">"Hello World"</div>
                                </div>
                            </div>
                            <div class="step-description">
                                <div class="step-num">1</div>
                                <h3>Input Cover Text</h3>
                                <p>Start with innocent-looking text that will carry your secret message</p>
                            </div>
                        </div>

                        <div class="animated-arrow"></div>

                        <div class="stage-step stage-2">
                            <div class="step-visual">
                                <div class="visual-box processing">
                                    <div class="visual-icon"></div>
                                    <div class="visual-label">Secret Message</div>
                                    <div class="visual-content">"TOP SECRET"</div>
                                    <div class="process-particles">
                                        <span class="particle"></span>
                                        <span class="particle"></span>
                                        <span class="particle"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="step-description">
                                <div class="step-num">2</div>
                                <h3>Zero-Width Encoding</h3>
                                <p>Secret is converted to invisible zero-width characters (  )</p>
                            </div>
                        </div>

                        <div class="animated-arrow"></div>

                        <div class="stage-step stage-3">
                            <div class="step-visual">
                                <div class="visual-box success">
                                    <div class="visual-icon"></div>
                                    <div class="visual-label">Stego Text</div>
                                    <div class="visual-content">"Hello World"</div>
                                    <div class="invisible-badge">Hidden Inside!</div>
                                </div>
                            </div>
                            <div class="step-description">
                                <div class="step-num">3</div>
                                <h3>Embedding Complete</h3>
                                <p>Zero-width characters inserted between normal text - completely invisible!</p>
                            </div>
                        </div>
                    </div>

                    <div class="tech-details">
                        <div class="tech-card">
                            <div class="tech-icon"></div>
                            <div class="tech-title">Zero-Width Characters</div>
                            <div class="tech-desc">Uses Unicode characters U+200B, U+200C, U+200D that are invisible but readable by computers</div>
                        </div>
                        <div class="tech-card">
                            <div class="tech-icon"></div>
                            <div class="tech-title">AES Encryption</div>
                            <div class="tech-desc">Optional password protection with military-grade 128-bit AES encryption</div>
                        </div>
                        <div class="tech-card">
                            <div class="tech-icon"></div>
                            <div class="tech-title">100% Invisible</div>
                            <div class="tech-desc">Completely undetectable to human eyes - looks like normal text</div>
                        </div>
                    </div>
                </div>

                <!-- Image Method Animation -->
                <div id="method-image" class="method-animation">
                    <div class="animation-stage">
                        <div class="stage-step stage-1">
                            <div class="step-visual">
                                <div class="visual-box">
                                    <div class="image-preview">
                                        <div class="pixel-grid">
                                            <div class="pixel" style="background: #ff6b6b;"></div>
                                            <div class="pixel" style="background: #4ecdc4;"></div>
                                            <div class="pixel" style="background: #45b7d1;"></div>
                                            <div class="pixel" style="background: #f9ca24;"></div>
                                            <div class="pixel" style="background: #6c5ce7;"></div>
                                            <div class="pixel" style="background: #a29bfe;"></div>
                                        </div>
                                    </div>
                                    <div class="visual-label">Cover Image</div>
                                </div>
                            </div>
                            <div class="step-description">
                                <div class="step-num">1</div>
                                <h3>Select Cover Image</h3>
                                <p>Choose any PNG/JPG image to hide your secret message inside</p>
                            </div>
                        </div>

                        <div class="animated-arrow"></div>

                        <div class="stage-step stage-2">
                            <div class="step-visual">
                                <div class="visual-box processing">
                                    <div class="lsb-demo">
                                        <div class="binary-display">
                                            <div class="byte">
                                                <span class="bit">1</span>
                                                <span class="bit">1</span>
                                                <span class="bit">0</span>
                                                <span class="bit">1</span>
                                                <span class="bit">0</span>
                                                <span class="bit">0</span>
                                                <span class="bit">1</span>
                                                <span class="bit lsb">0</span>
                                            </div>
                                            <div class="arrow-down"></div>
                                            <div class="byte modified">
                                                <span class="bit">1</span>
                                                <span class="bit">1</span>
                                                <span class="bit">0</span>
                                                <span class="bit">1</span>
                                                <span class="bit">0</span>
                                                <span class="bit">0</span>
                                                <span class="bit">1</span>
                                                <span class="bit lsb">1</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="visual-label">LSB Modification</div>
                                </div>
                            </div>
                            <div class="step-description">
                                <div class="step-num">2</div>
                                <h3>Bit Manipulation</h3>
                                <p>Message encoded in least significant bits of pixel RGB values</p>
                            </div>
                        </div>

                        <div class="animated-arrow"></div>

                        <div class="stage-step stage-3">
                            <div class="step-visual">
                                <div class="visual-box success">
                                    <div class="image-preview">
                                        <div class="pixel-grid">
                                            <div class="pixel" style="background: #ff6b6c;"></div>
                                            <div class="pixel" style="background: #4ecdc5;"></div>
                                            <div class="pixel" style="background: #45b7d0;"></div>
                                            <div class="pixel" style="background: #f9ca25;"></div>
                                            <div class="pixel" style="background: #6c5ce6;"></div>
                                            <div class="pixel" style="background: #a29bff;"></div>
                                        </div>
                                        <div class="difference-badge">1 color diff</div>
                                    </div>
                                    <div class="visual-label">Stego Image</div>
                                </div>
                            </div>
                            <div class="step-description">
                                <div class="step-num">3</div>
                                <h3>Imperceptible Changes</h3>
                                <p>Image looks identical - only 1 pixel value change (99.6% similar!)</p>
                            </div>
                        </div>
                    </div>

                    <div class="tech-details">
                        <div class="tech-card">
                            <div class="tech-icon"></div>
                            <div class="tech-title">LSB Algorithm</div>
                            <div class="tech-desc">Modifies only the last bit of each color channel - changes invisible to human eye</div>
                        </div>
                        <div class="tech-card">
                            <div class="tech-icon"></div>
                            <div class="tech-title">High PSNR</div>
                            <div class="tech-desc">Peak Signal-to-Noise Ratio >40dB ensures exceptional visual quality</div>
                        </div>
                        <div class="tech-card">
                            <div class="tech-icon"></div>
                            <div class="tech-title">Good Capacity</div>
                            <div class="tech-desc">Hide ~1 character per 8 pixels - 1MB image can hide 100KB+ of text</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Performance Chart -->
            <div class="chart-section">
                <h2 class="section-title">Quality Comparison</h2>
                <p class="section-subtitle">See how different encoding methods affect image quality</p>
                <div class="chart-container">
                    <canvas id="qualityChart"></canvas>
                </div>
            </div>
        </section>

        <!-- ========================================
             CHALLENGES PAGE
        ======================================== -->
        <section id="page-challenges" class="page-section">
            <!-- User Points Banner (shown when logged in) -->
            <div id="user-points-banner" class="points-banner" style="display: none;">
                <div class="points-info">
                    <div class="points-stat">
                        <span class="points-value" id="user-total-points">0</span>
                        <span class="points-label">Total Points</span>
                    </div>
                    <div class="points-stat">
                        <span class="points-value" id="user-challenges-solved">0</span>
                        <span class="points-label">Challenges Solved</span>
                    </div>
                    <div class="points-stat">
                        <span class="points-value" id="user-rank">#-</span>
                        <span class="points-label">Your Rank</span>
                    </div>
                </div>
            </div>

            <div class="challenges-layout">
                <!-- Challenges Section -->
                <div class="workspace-card challenges-main">
                    <div class="card-header">
                        <h2 class="card-title"> Stego Challenges</h2>
                        <p class="card-subtitle">Test your steganography skills! Find hidden messages in puzzles and earn points.</p>
                    </div>
                    <div class="card-body">
                        <div class="challenge-filters">
                            <button class="btn-filter active" onclick="filterChallenges('')">All</button>
                            <button class="btn-filter" onclick="filterChallenges('easy')"> Easy</button>
                            <button class="btn-filter" onclick="filterChallenges('medium')"> Medium</button>
                            <button class="btn-filter" onclick="filterChallenges('hard')"> Hard</button>
                        </div>
                        <div id="challenges-grid" class="challenges-grid">
                            <!-- Challenges loaded dynamically -->
                        </div>
                    </div>
                </div>

                <!-- Leaderboard Sidebar -->
                <div class="workspace-card leaderboard-card">
                    <div class="card-header">
                        <h2 class="card-title"> Leaderboard</h2>
                        <p class="card-subtitle">Top cryptographers</p>
                    </div>
                    <div class="card-body">
                        <div id="leaderboard-container">
                            <!-- Leaderboard loaded dynamically -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================================
             MULTI-FILE PAGE
        ======================================== -->
        <section id="page-multi-file" class="page-section">
            <div class="workspace-card">
                <div class="card-header">
                    <h2 class="card-title"> Multi-File Steganography</h2>
                    <p class="card-subtitle">Split secrets across multiple images. All parts required for decoding - maximum security!</p>
                </div>
                <div class="card-body">
                    <!-- Mode Toggle -->
                    <div class="mode-toggle">
                        <button class="mode-btn active" onclick="setMultiFileMode('encode')" id="mf-mode-encode">
                            <span class="mode-icon"></span> Encode
                        </button>
                        <button class="mode-btn" onclick="setMultiFileMode('decode')" id="mf-mode-decode">
                            <span class="mode-icon"></span> Decode
                        </button>
                    </div>
                    
                    <!-- Encode Section -->
                    <div id="mf-encode-section">
                        <div class="step-container">
                            <div class="step-header">
                                <div class="step-number">1</div>
                                <div class="step-title">Enter Your Secret</div>
                            </div>
                            <p class="step-description">This message will be cryptographically split. Missing even one part makes decoding impossible.</p>
                            <textarea id="mf-secret" class="input-field" rows="4" placeholder="Enter your ultra-secret message..."></textarea>
                        </div>
                        
                        <div class="step-container">
                            <div class="step-header">
                                <div class="step-number">2</div>
                                <div class="step-title">Number of Parts</div>
                            </div>
                            <p class="step-description">More parts = more security. Distribute to different people or locations.</p>
                            <div class="parts-selector">
                                <button class="part-btn" onclick="setMfParts(2)">2</button>
                                <button class="part-btn active" onclick="setMfParts(3)">3</button>
                                <button class="part-btn" onclick="setMfParts(4)">4</button>
                                <button class="part-btn" onclick="setMfParts(5)">5</button>
                                <input type="hidden" id="mf-parts" value="3" />
                            </div>
                        </div>
                        
                        <div class="step-container">
                            <div class="step-header">
                                <div class="step-number">3</div>
                                <div class="step-title">Cover Images</div>
                            </div>
                            <p class="step-description">Choose to use auto-generated gradient images or upload your own custom images.</p>
                            <div class="image-source-toggle">
                                <button class="source-btn active" onclick="setMfImageSource('generated')" id="mf-source-generated">
                                     Auto-Generate
                                </button>
                                <button class="source-btn" onclick="setMfImageSource('custom')" id="mf-source-custom">
                                     Upload Custom
                                </button>
                            </div>
                            <div id="mf-custom-upload-section" style="display: none; margin-top: 12px;">
                                <div class="upload-zone" onclick="document.getElementById('mf-encode-upload').click()">
                                    <input type="file" id="mf-encode-upload" accept="image/*" multiple onchange="handleMfEncodeUpload(event)" style="display:none" />
                                    <div class="upload-icon"></div>
                                    <div class="upload-text">Upload cover images</div>
                                    <div class="upload-hint">Upload as many images as parts you selected</div>
                                </div>
                                <div id="mf-encode-preview" class="mf-preview-grid"></div>
                            </div>
                        </div>
                        
                        <button class="btn-primary" onclick="multiFileEncode()">
                            <span> Split & Create Images</span>
                        </button>
                    </div>
                    
                    <!-- Decode Section (hidden by default) -->
                    <div id="mf-decode-section" style="display: none;">
                        <div class="step-container">
                            <div class="step-header">
                                <div class="step-number">1</div>
                                <div class="step-title">Upload All Parts</div>
                            </div>
                            <p class="step-description">You need ALL parts to recover the message. Upload them in any order.</p>
                            <div class="upload-zone" id="mf-dropzone" onclick="document.getElementById('mf-upload').click()">
                                <input type="file" id="mf-upload" accept="image/*" multiple onchange="handleMultiFileUpload(event)" style="display:none" />
                                <div class="upload-icon"></div>
                                <div class="upload-text">Click or drag image parts here</div>
                                <div class="upload-hint">Upload all parts to decode</div>
                            </div>
                            <div id="mf-preview" class="mf-preview-grid"></div>
                        </div>
                        
                        <button class="btn-primary" onclick="multiFileDecode()">
                            <span> Reconstruct Message</span>
                        </button>
                    </div>
                    
                    <div id="mf-results"></div>
                </div>
            </div>
        </section>

        <!-- ========================================
             SCANNER PAGE
        ======================================== -->
        <section id="page-scanner" class="page-section">
            <div class="workspace-card">
                <div class="card-header">
                    <h2 class="card-title"> Steganography Scanner</h2>
                    <p class="card-subtitle">Detect hidden data using statistical analysis, chi-square tests, and pattern recognition.</p>
                </div>
                <div class="card-body">
                    <div class="scanner-tabs">
                        <button class="scanner-tab active" onclick="switchScannerTab('text')">
                             Text Analysis
                        </button>
                        <button class="scanner-tab" onclick="switchScannerTab('image')">
                             Image Analysis <span class="demo-badge">Demo</span>
                        </button>
                    </div>
                    
                    <!-- Text Scanner (Now Primary) -->
                    <div id="scanner-text-section" class="scanner-section active">
                        <div class="step-container">
                            <p class="step-description">Paste text to check for zero-width characters and other hidden data.</p>
                            <textarea id="scanner-text" class="input-field" rows="6" placeholder="Paste suspicious text here..."></textarea>
                        </div>
                        <button class="btn-primary" onclick="scanText()">
                            <span> Scan Text</span>
                        </button>
                        <div id="scanner-text-output"></div>
                    </div>
                    
                    <!-- Image Scanner (Demo) -->
                    <div id="scanner-image-section" class="scanner-section">
                        <div class="demo-notice">
                            <span></span> Image steganalysis is experimental and may produce false positives.
                        </div>
                        <div class="upload-zone" id="scanner-dropzone" onclick="document.getElementById('scanner-file').click()">
                            <input type="file" id="scanner-file" accept="image/*" onchange="handleScannerFile(this)" style="display:none" />
                            <div class="upload-icon"></div>
                            <div class="upload-text">Drop image to analyze</div>
                            <div class="upload-hint">PNG, JPG, BMP  Max 10MB</div>
                        </div>
                        <div id="scanner-preview"></div>
                        <button class="btn-primary" onclick="scanImage()">
                            <span> Run Analysis</span>
                        </button>
                        <div id="scanner-output"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================================
             TEXT ENCODE PAGE
        ======================================== -->
        <section id="page-text-encode" class="page-section">
            <div class="workspace-card">
                <div class="card-header">
                    <h2 class="card-title">Hide Message in Text</h2>
                    <p class="card-subtitle">Embed a secret message inside normal-looking text that only the recipient can read</p>
                </div>
                <div class="card-body">
                    
                    <!-- Limits Info Box -->
                    <div class="limits-info-box">
                        <h4 class="limits-info-title"> Input Limits</h4>
                        <ul class="limits-info-list">
                            <li>Cover text: <strong>100,000</strong> characters max</li>
                            <li>Secret message: <strong>50,000</strong> characters max</li>
                            <li>Password: <strong>Optional</strong> (AES-128 encryption)</li>
                        </ul>
                    </div>
                    
                    <div class="step-container">
                        <div class="step-header">
                            <div class="step-number">1</div>
                            <div class="step-title">Write Your Cover Text</div>
                        </div>
                        <div class="step-description">
                            This is the public message that everyone will see. Make it look natural and innocent - like a normal email or message.
                        </div>
                        <div class="step-help">
                             <strong>Example:</strong> "Hi Sarah! The meeting went great today. Looking forward to our coffee next week. Have a nice evening!"
                        </div>
                        <textarea id="text-encode-cover" class="input-field" placeholder="Type your public cover message here..." oninput="updateCharCounter('text-encode-cover', 100000)"></textarea>
                        <div class="char-counter" id="text-encode-cover-counter">0 / 100,000 characters</div>
                    </div>

                    <div class="step-container">
                        <div class="step-header">
                            <div class="step-number">2</div>
                            <div class="step-title">Enter Your Secret Message</div>
                        </div>
                        <div class="step-description">
                            This is the confidential information you want to hide. It will be completely invisible in the final output.
                        </div>
                        <div class="step-help">
                             <strong>Example:</strong> "Access code: BLUE-SKY-2024"
                        </div>
                        <textarea id="text-encode-secret" class="input-field" placeholder="Type your secret message here..." oninput="updateCharCounter('text-encode-secret', 50000)"></textarea>
                        <div class="char-counter" id="text-encode-secret-counter">0 / 50,000 characters</div>
                    </div>

                    <div class="step-container">
                        <div class="step-header">
                            <div class="step-number">3</div>
                            <div class="step-title">Set a Password (Recommended)</div>
                        </div>
                        <div class="step-description">
                            Add an extra layer of security. Only people with this password will be able to decrypt and read your secret.
                        </div>
                        <div class="step-help">
                             <strong>Tip:</strong> Use a strong password that you share separately with the recipient
                        </div>
                        <div class="password-input-group">
                            <input type="text" id="text-encode-password" class="input-field" placeholder="Enter a secure password (optional)">
                            <button type="button" class="btn-generate" onclick="generatePassword('text-encode-password')" title="Generate random password">
                                
                            </button>
                            <button type="button" class="btn-copy" onclick="copyPasswordToClipboard('text-encode-password')" title="Copy password">
                                
                            </button>
                        </div>
                        
                        <!-- Encryption Visualization -->
                        <div id="text-encode-viz" class="encryption-viz" style="display: none;">
                            <div class="encryption-viz-header">
                                <span class="encryption-viz-title"> AES-128 Encryption Process</span>
                                <span id="text-encode-viz-status">Encrypting...</span>
                            </div>
                            <div class="encryption-rounds" id="text-encode-rounds">
                                <!-- Rounds will be populated by JavaScript -->
                            </div>
                            <div class="encryption-progress">
                                <div class="encryption-progress-bar" id="text-encode-progress" style="width: 0%;"></div>
                            </div>
                        </div>
                    </div>

                    <button onclick="performTextEncode()" class="btn-primary"> Hide Message Now</button>

                    <div id="text-encode-result" class="result-container hidden">
                        <div class="result-header">
                            <span class="result-icon"></span>
                            <span class="result-title">Success! Message Hidden</span>
                        </div>
                        <div class="result-content">
                            <p style="margin-bottom: 16px; color: var(--gray-700); font-weight: 600;">Your text with the hidden message:</p>
                            <textarea id="text-encode-output" class="input-field" readonly style="background: var(--purple-50);"></textarea>
                        </div>
                        <div class="result-actions">
                            <button onclick="copyTextEncodeOutput()" class="btn-action"> Copy to Clipboard</button>
                            <button onclick="navigate('text-decode')" class="btn-action"> Test Decoding</button>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <!-- ========================================
             TEXT DECODE PAGE
        ======================================== -->
        <section id="page-text-decode" class="page-section">
            <div class="workspace-card">
                <div class="card-header">
                    <h2 class="card-title">Reveal Hidden Message from Text</h2>
                    <p class="card-subtitle">Extract the secret message hidden inside text</p>
                </div>
                <div class="card-body">
                    
                    <div class="step-container">
                        <div class="step-header">
                            <div class="step-number">1</div>
                            <div class="step-title">Paste the Text with Hidden Message</div>
                        </div>
                        <div class="step-description">
                            Copy and paste the text that contains the hidden message you want to reveal.
                        </div>
                        <textarea id="text-decode-input" class="input-field" placeholder="Paste the text here..."></textarea>
                    </div>

                    <div class="step-container">
                        <div class="step-header">
                            <div class="step-number">2</div>
                            <div class="step-title">Enter Password (If Required)</div>
                        </div>
                        <div class="step-description">
                            If the message was encrypted with a password, enter it here to decrypt the secret.
                        </div>
                        <input type="password" id="text-decode-password" class="input-field" placeholder="Enter password if the message is encrypted">
                    </div>

                    <button onclick="performTextDecode()" class="btn-primary"> Reveal Secret</button>

                    <div id="text-decode-result" class="result-container hidden">
                        <div class="result-header">
                            <span class="result-icon"></span>
                            <span class="result-title">Secret Message Found!</span>
                        </div>
                        <div class="result-content">
                            <p id="text-decode-output" style="font-size: 1.2rem; line-height: 1.8; font-weight: 600; color: var(--purple-900);"></p>
                        </div>
                        <div class="result-actions">
                            <button onclick="copySecretText()" class="btn-action"> Copy Secret</button>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <!-- ========================================
             IMAGE ENCODE PAGE
        ======================================== -->
        <section id="page-image-encode" class="page-section">
            <div class="workspace-card">
                <div class="card-header">
                    <h2 class="card-title">Hide Message in Image</h2>
                    <p class="card-subtitle">Embed a secret message inside image pixels using LSB steganography</p>
                </div>
                <div class="card-body">
                    
                    <!-- Limits Info Box -->
                    <div class="limits-info-box">
                        <h4 class="limits-info-title"> Input Limits</h4>
                        <ul class="limits-info-list">
                            <li>Image size: <strong>4096x4096</strong> pixels max</li>
                            <li>File size: <strong>16 MB</strong> max</li>
                            <li>Secret message: <strong>50,000</strong> characters max</li>
                            <li>Formats: <strong>PNG, JPG, BMP</strong></li>
                        </ul>
                    </div>
                    
                    <div class="step-container">
                        <div class="step-header">
                            <div class="step-number">1</div>
                            <div class="step-title">Choose Your Cover Image</div>
                        </div>
                        <div class="step-description">
                            Select an image file (PNG, JPG, or BMP). Your secret will be hidden in the pixels without any visible change.
                        </div>
                        <div class="upload-zone" onclick="document.getElementById('image-encode-file').click()">
                            <input type="file" id="image-encode-file" class="file-input" style="pointer-events:none;">
                            <div class="upload-icon"></div>
                            <div class="upload-title">Drop Your Image Here</div>
                            <div class="upload-subtitle">or click to browse (PNG, JPG, BMP supported)</div>
                        </div>
                        <div id="image-encode-preview" class="preview-box hidden">
                            <img id="image-encode-preview-img" alt="Cover Image">
                        </div>
                    </div>

                    <div class="step-container">
                        <div class="step-header">
                            <div class="step-number">2</div>
                            <div class="step-title">Enter Your Secret Message</div>
                        </div>
                        <div class="step-description">
                            Type the confidential message you want to hide inside the image.
                        </div>
                        <textarea id="image-encode-secret" class="input-field" placeholder="Type your secret message..." oninput="updateCharCounter('image-encode-secret', 50000)"></textarea>
                        <div class="char-counter" id="image-encode-secret-counter">0 / 50,000 characters</div>
                    </div>

                    <div class="step-container">
                        <div class="step-header">
                            <div class="step-number">3</div>
                            <div class="step-title">Set Password (Recommended)</div>
                        </div>
                        <div class="step-description">
                            Encrypt your message with a password for maximum security.
                        </div>
                        <div class="password-input-group">
                            <input type="text" id="image-encode-password" class="input-field" placeholder="Enter a secure password">
                            <button type="button" class="btn-generate" onclick="generatePassword('image-encode-password')" title="Generate random password">
                                
                            </button>
                            <button type="button" class="btn-copy" onclick="copyPasswordToClipboard('image-encode-password')" title="Copy password">
                                
                            </button>
                        </div>
                        
                        <!-- Encryption Visualization (hidden until encoding starts) -->
                        <div id="image-encode-viz" class="encryption-viz" style="display: none;">
                            <div class="encryption-viz-header">
                                <span class="encryption-viz-title"> AES-128 Encryption Process</span>
                                <span id="image-encode-viz-status">Encrypting...</span>
                            </div>
                            <div class="encryption-rounds" id="image-encode-rounds">
                                <!-- Rounds will be populated by JavaScript -->
                            </div>
                            <div class="encryption-progress">
                                <div class="encryption-progress-bar" id="image-encode-progress" style="width: 0%;"></div>
                            </div>
                        </div>
                    </div>

                    <button onclick="performImageEncode()" class="btn-primary"> Hide Message in Image</button>

                    <div id="image-encode-result" class="result-container hidden">
                        <div class="result-header">
                            <span class="result-icon"></span>
                            <span class="result-title">Image Encoded Successfully!</span>
                        </div>

                        <div class="analytics-grid">
                            <div class="metric-card">
                                <div class="metric-value" id="img-quality">Excellent</div>
                                <div class="metric-label">Quality Rating</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value" id="img-mse">0.00</div>
                                <div class="metric-label">MSE Score</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value" id="img-psnr"></div>
                                <div class="metric-label">PSNR (dB)</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value" id="img-ssim">1.000</div>
                                <div class="metric-label">SSIM Index</div>
                            </div>
                        </div>

                        <div class="result-content">
                            <img id="image-encode-output" style="width: 100%; border-radius: 12px;" alt="Encoded Image">
                        </div>
                        <div class="result-actions">
                            <a id="image-download-link" href="#" download="secret_image.png" class="btn-primary" style="display: inline-block; text-align: center; text-decoration: none; width: auto;"> Download Image</a>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <!-- ========================================
             IMAGE DECODE PAGE
        ======================================== -->
        <section id="page-image-decode" class="page-section">
            <div class="workspace-card">
                <div class="card-header">
                    <h2 class="card-title">Extract Message from Image</h2>
                    <p class="card-subtitle">Reveal the hidden message embedded in image pixels</p>
                </div>
                <div class="card-body">
                    
                    <div class="step-container">
                        <div class="step-header">
                            <div class="step-number">1</div>
                            <div class="step-title">Upload Image with Hidden Message</div>
                        </div>
                        <div class="step-description">
                            Select the image file that contains the hidden message you want to extract.
                        </div>
                        <div class="upload-zone" onclick="document.getElementById('image-decode-file').click()">
                            <input type="file" id="image-decode-file" class="file-input" style="pointer-events:none;">
                            <div class="upload-icon"></div>
                            <div class="upload-title">Drop Image to Decode</div>
                            <div class="upload-subtitle">or click to browse</div>
                        </div>
                        <div id="image-decode-preview" class="preview-box hidden">
                            <img id="image-decode-preview-img" alt="Image to Decode">
                        </div>
                    </div>

                    <div class="step-container">
                        <div class="step-header">
                            <div class="step-number">2</div>
                            <div class="step-title">Enter Password (If Encrypted)</div>
                        </div>
                        <div class="step-description">
                            If the message was encrypted, you need the password to decrypt it.
                        </div>
                        <input type="password" id="image-decode-password" class="input-field" placeholder="Enter password if required">
                    </div>

                    <button onclick="performImageDecode()" class="btn-primary"> Extract Secret Message</button>

                    <div id="image-decode-result" class="result-container hidden">
                        <div class="result-header">
                            <span class="result-icon"></span>
                            <span class="result-title">Message Extracted!</span>
                        </div>
                        <div class="result-content">
                            <p id="image-decode-output" style="font-size: 1.2rem; line-height: 1.8; font-weight: 600; color: var(--purple-900);"></p>
                        </div>
                        <div class="result-actions">
                            <button onclick="copyImageSecret()" class="btn-action"> Copy Secret</button>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <!-- ========================================
             LEARN / EDUCATION PAGE (Combined Guide + History)
        ======================================== -->
        <section id="page-learn" class="page-section">
            <div class="learn-container">
                <!-- Hero Header -->
                <div class="learn-hero">
                    <h1 class="learn-title"> Steganography Academy</h1>
                    <p class="learn-subtitle">Master the art of hiding secrets in plain sight</p>
                </div>

                <!-- Navigation Cards -->
                <div class="learn-nav-grid">
                    <div class="learn-nav-card" onclick="showLearnSection('basics')">
                        <div class="learn-nav-icon"></div>
                        <h3>The Basics</h3>
                        <p>Learn how steganography works</p>
                    </div>
                    <div class="learn-nav-card" onclick="showLearnSection('history')">
                        <div class="learn-nav-icon"></div>
                        <h3>History</h3>
                        <p>From ancient Greece to digital age</p>
                    </div>
                    <div class="learn-nav-card" onclick="showLearnSection('techniques')">
                        <div class="learn-nav-icon"></div>
                        <h3>Techniques</h3>
                        <p>Methods and algorithms explained</p>
                    </div>
                    <div class="learn-nav-card" onclick="showLearnSection('cases')">
                        <div class="learn-nav-icon"></div>
                        <h3>Famous Cases</h3>
                        <p>Real-world espionage and secrets</p>
                    </div>
                    <div class="learn-nav-card" onclick="showLearnSection('detection')">
                        <div class="learn-nav-icon"></div>
                        <h3>Detection</h3>
                        <p>Steganalysis and countermeasures</p>
                    </div>
                    <div class="learn-nav-card" onclick="showLearnSection('practice')">
                        <div class="learn-nav-icon"></div>
                        <h3>Best Practices</h3>
                        <p>Security tips and recommendations</p>
                    </div>
                </div>

                <!-- Section Content Areas -->
                <div id="learn-content-area">
                    <!-- Default/Welcome Message -->
                    <div id="learn-welcome" class="learn-section active">
                        <div class="learn-welcome-box">
                            <div class="learn-welcome-icon"></div>
                            <h2>Select a Topic Above</h2>
                            <p>Click any card to explore that topic in depth</p>
                        </div>
                    </div>

                    <!-- BASICS Section -->
                    <div id="learn-basics" class="learn-section">
                        <div class="learn-section-header">
                            <span class="section-icon"></span>
                            <h2>Understanding Steganography</h2>
                        </div>
                        
                        <div class="learn-cards-grid">
                            <div class="learn-info-card">
                                <div class="info-number">1</div>
                                <h3>What is Steganography?</h3>
                                <p>Steganography is the art of hiding secret information inside ordinary-looking data. Unlike encryption (which scrambles data), steganography conceals the very existence of the message. To an observer, the carrier text or image appears completely normal.</p>
                            </div>
                            
                            <div class="learn-info-card">
                                <div class="info-number">2</div>
                                <h3>Steganography vs Cryptography</h3>
                                <p><strong>Cryptography</strong> makes a message unreadable (but visible). <strong>Steganography</strong> makes it invisible. The best security? Combine both - hide an encrypted message. Even if found, it can't be read!</p>
                            </div>
                            
                            <div class="learn-info-card">
                                <div class="info-number">3</div>
                                <h3>Text Steganography (ZWC)</h3>
                                <p>We use Unicode zero-width characters (invisible characters) to encode your secret message. These characters are inserted between regular letters and are completely invisible to the human eye. The text looks and behaves normally.</p>
                            </div>
                            
                            <div class="learn-info-card">
                                <div class="info-number">4</div>
                                <h3>Image Steganography (LSB)</h3>
                                <p>Images are made of pixels, each with RGB color values. We hide data by modifying the least significant bits - changes so small the human eye cannot detect them, but the data can be perfectly recovered.</p>
                            </div>
                            
                            <div class="learn-info-card">
                                <div class="info-number">5</div>
                                <h3>Encryption Layer (AES-128)</h3>
                                <p>When you add a password, we use AES-128 encryption (military-grade security) to encrypt your secret message before hiding it. Two layers of security: steganography (hiding) + cryptography (encryption).</p>
                            </div>
                            
                            <div class="learn-info-card">
                                <div class="info-number">6</div>
                                <h3>Quality Metrics</h3>
                                <p>We measure image quality with MSE (Mean Squared Error), PSNR (Peak Signal-to-Noise Ratio), and SSIM (Structural Similarity). These confirm the stego-image remains visually identical to the original.</p>
                            </div>
                        </div>
                    </div>

                    <!-- HISTORY Section -->
                    <div id="learn-history" class="learn-section">
                        <div class="learn-section-header">
                            <span class="section-icon"></span>
                            <h2>The History of Hidden Messages</h2>
                        </div>
                        
                        <div class="history-timeline-modern">
                            <div class="timeline-era">
                                <div class="era-marker ancient"></div>
                                <div class="era-label">Ancient World</div>
                            </div>
                            
                            <div class="timeline-event">
                                <div class="event-date">~440 BC</div>
                                <div class="event-content">
                                    <h4> The Shaved Head Message</h4>
                                    <p>Histiaeus of Miletus shaved a slave's head, tattooed a secret message on his scalp, waited for hair to regrow, then sent him to deliver the message to Aristagoras, helping to incite a revolt against Persia.</p>
                                </div>
                            </div>
                            
                            <div class="timeline-event">
                                <div class="event-date">~480 BC</div>
                                <div class="event-content">
                                    <h4> Wax Tablets</h4>
                                    <p>Demaratus warned Sparta of Xerxes' invasion by scraping wax off tablets, writing on wood beneath, then re-applying wax. Queen Gorgo discovered the hidden message and saved Greece.</p>
                                </div>
                            </div>
                            
                            <div class="timeline-event">
                                <div class="event-date">1st Century</div>
                                <div class="event-content">
                                    <h4> Invisible Inks</h4>
                                    <p>Pliny the Elder documented using plant-based invisible inks. Messages written with milk, fruit juices, or urine become visible when heated. This technique remained popular for centuries.</p>
                                </div>
                            </div>
                            
                            <div class="timeline-era">
                                <div class="era-marker medieval"></div>
                                <div class="era-label">Medieval Period</div>
                            </div>
                            
                            <div class="timeline-event">
                                <div class="event-date">1499</div>
                                <div class="event-content">
                                    <h4> Birth of the Term</h4>
                                    <p>Johannes Trithemius wrote "Steganographia" - the first book on hidden writing. While appearing to be about magic, it contained sophisticated cipher systems. The term steganography was born.</p>
                                </div>
                            </div>
                            
                            <div class="timeline-era">
                                <div class="era-marker modern"></div>
                                <div class="era-label">World Wars</div>
                            </div>
                            
                            <div class="timeline-event">
                                <div class="event-date">WWI</div>
                                <div class="event-content">
                                    <h4> Invisible Ink Wars</h4>
                                    <p>German spies used invisible inks extensively. Messages were hidden in innocent-looking letters. The British developed chemical tests to detect these communications.</p>
                                </div>
                            </div>
                            
                            <div class="timeline-event">
                                <div class="event-date">WWII</div>
                                <div class="event-content">
                                    <h4> The Microdot Revolution</h4>
                                    <p>Germans perfected "microdots" - photographs shrunk to the size of a period. An entire page of text in a single dot. The FBI called it "the enemy's masterpiece of espionage."</p>
                                </div>
                            </div>
                            
                            <div class="timeline-era">
                                <div class="era-marker digital"></div>
                                <div class="era-label">Digital Age</div>
                            </div>
                            
                            <div class="timeline-event">
                                <div class="event-date">1985</div>
                                <div class="event-content">
                                    <h4> Digital Steganography</h4>
                                    <p>With digital images emerging, researchers developed LSB (Least Significant Bit) embedding - hiding data in the imperceptible bits of pixel colors.</p>
                                </div>
                            </div>
                            
                            <div class="timeline-event">
                                <div class="event-date">1990s</div>
                                <div class="event-content">
                                    <h4> Internet Explosion</h4>
                                    <p>The internet enabled new steganography applications. Digital watermarking protected copyrights. Tools proliferated for hiding data in images, audio, and video.</p>
                                </div>
                            </div>
                            
                            <div class="timeline-event">
                                <div class="event-date">Today</div>
                                <div class="event-content">
                                    <h4> AI & Advanced Methods</h4>
                                    <p>Modern steganography uses neural networks for better hiding. Research continues in both hiding and detecting hidden data. The cat-and-mouse game evolves.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- TECHNIQUES Section -->
                    <div id="learn-techniques" class="learn-section">
                        <div class="learn-section-header">
                            <span class="section-icon"></span>
                            <h2>Steganography Techniques</h2>
                        </div>
                        
                        <div class="technique-showcase">
                            <div class="technique-item">
                                <div class="technique-visual">
                                    <div class="pixel-demo">
                                        <div class="pixel original">10110<span class="lsb">1</span>10</div>
                                        <div class="pixel-arrow"></div>
                                        <div class="pixel modified">10110<span class="lsb changed">0</span>10</div>
                                    </div>
                                </div>
                                <div class="technique-info">
                                    <h3> LSB Embedding</h3>
                                    <p>Hiding data in the least significant bits of image pixels. The rightmost bit changes from 1 to 0 - imperceptible to eyes but stores your data. Can hide ~3 bits per pixel in RGB images.</p>
                                    <div class="technique-stats">
                                        <span class="stat">Capacity: High</span>
                                        <span class="stat">Detection: Medium</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="technique-item">
                                <div class="technique-visual">
                                    <div class="zwc-demo">
                                        <span>Hello</span><span class="zwc-char"></span><span>World</span>
                                        <div class="zwc-reveal">H e l l o [ZWC] W o r l d</div>
                                    </div>
                                </div>
                                <div class="technique-info">
                                    <h3> Zero-Width Characters</h3>
                                    <p>Invisible Unicode characters (U+200B, U+200C, U+200D) inserted between visible text. Completely invisible when displayed, but encode binary data.</p>
                                    <div class="technique-stats">
                                        <span class="stat">Capacity: Medium</span>
                                        <span class="stat">Detection: Low</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="technique-item">
                                <div class="technique-visual">
                                    <div class="audio-demo">
                                        <div class="waveform"> </div>
                                    </div>
                                </div>
                                <div class="technique-info">
                                    <h3> Audio Steganography</h3>
                                    <p>Embedding data in audio files by modifying inaudible frequencies, using echo hiding, or spread spectrum techniques. Human ears can't detect small amplitude changes.</p>
                                    <div class="technique-stats">
                                        <span class="stat">Capacity: High</span>
                                        <span class="stat">Detection: Medium</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="technique-item">
                                <div class="technique-visual">
                                    <div class="video-demo"> Frame 1  2  3</div>
                                </div>
                                <div class="technique-info">
                                    <h3> Video Steganography</h3>
                                    <p>Embedding data across video frames. The temporal dimension allows for massive payloads while maintaining visual quality. Each frame can carry hidden bits.</p>
                                    <div class="technique-stats">
                                        <span class="stat">Capacity: Very High</span>
                                        <span class="stat">Detection: Low</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="technique-item">
                                <div class="technique-visual">
                                    <div class="network-demo"> [Header][Data][Hidden]</div>
                                </div>
                                <div class="technique-info">
                                    <h3> Network Steganography</h3>
                                    <p>Covert channels in network protocols - hiding data in packet headers, timing patterns, or unused protocol fields. Extremely difficult to detect.</p>
                                    <div class="technique-stats">
                                        <span class="stat">Capacity: Low</span>
                                        <span class="stat">Detection: Very Low</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="technique-item">
                                <div class="technique-visual">
                                    <div class="doc-demo"> [Whitespace Hidden]</div>
                                </div>
                                <div class="technique-info">
                                    <h3> Document Steganography</h3>
                                    <p>Hiding data in Word documents, PDFs through whitespace manipulation, font variations, or metadata fields. Often survives printing and scanning.</p>
                                    <div class="technique-stats">
                                        <span class="stat">Capacity: Medium</span>
                                        <span class="stat">Detection: Medium</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- FAMOUS CASES Section -->
                    <div id="learn-cases" class="learn-section">
                        <div class="learn-section-header">
                            <span class="section-icon"></span>
                            <h2>Famous Cases & Real Stories</h2>
                        </div>
                        
                        <div class="cases-showcase">
                            <div class="case-card-modern">
                                <div class="case-badge wartime">Wartime</div>
                                <div class="case-icon-large"></div>
                                <h3>Operation Bernhard (WWII)</h3>
                                <p>Nazi Germany's plan to destabilize Britain by flooding the economy with counterfeit pound notes. Messages were hidden in the watermarks of the forged currency. One of the largest counterfeiting operations in history.</p>
                            </div>
                            
                            <div class="case-card-modern">
                                <div class="case-badge espionage">Espionage</div>
                                <div class="case-icon-large"></div>
                                <h3>Russian Spy Ring (2010)</h3>
                                <p>The FBI caught Russian sleeper agents who embedded secret messages in images posted on public websites. The "Illegals Program" used sophisticated digital steganography to communicate for over a decade.</p>
                            </div>
                            
                            <div class="case-card-modern">
                                <div class="case-badge classic">Classic</div>
                                <div class="case-icon-large"></div>
                                <h3>Velvalee Dickinson (WWII)</h3>
                                <p>German spy sent letters about "dolls" to South American contacts. Reading the first letter of each word revealed military intelligence about US Navy ships. She was caught by the FBI in 1944.</p>
                            </div>
                            
                            <div class="case-card-modern">
                                <div class="case-badge forensics">Forensics</div>
                                <div class="case-icon-large"></div>
                                <h3>Printer Tracking Dots</h3>
                                <p>Most color printers secretly embed nearly invisible yellow dots encoding the printer's serial number and timestamp. NSA leaker Reality Winner was caught in 2017 using this forensic technique.</p>
                            </div>
                            
                            <div class="case-card-modern">
                                <div class="case-badge entertainment">Entertainment</div>
                                <div class="case-icon-large"></div>
                                <h3>Hidden Music Messages</h3>
                                <p>Aphex Twin hid his face in the spectrogram of "Equation". Nine Inch Nails hid GPS coordinates in their album art. Musicians love hiding easter eggs in audio frequencies.</p>
                            </div>
                            
                            <div class="case-card-modern">
                                <div class="case-badge modern">Modern</div>
                                <div class="case-icon-large"></div>
                                <h3>Malware in Images</h3>
                                <p>Modern attackers hide malicious code in innocent-looking images. The "StegoLoader" malware family embeds itself in PNG files, evading antivirus detection by hiding in plain sight.</p>
                            </div>
                        </div>
                    </div>

                    <!-- DETECTION Section -->
                    <div id="learn-detection" class="learn-section">
                        <div class="learn-section-header">
                            <span class="section-icon"></span>
                            <h2>Steganalysis: Detecting Hidden Messages</h2>
                        </div>
                        
                        <div class="detection-intro">
                            <p>Just as cryptanalysis tries to break encryption, <strong>steganalysis</strong> attempts to detect steganographic content. It's an eternal cat-and-mouse game between hiders and detectors.</p>
                        </div>
                        
                        <div class="detection-methods">
                            <div class="detection-card">
                                <div class="detection-icon"></div>
                                <h3>Statistical Analysis</h3>
                                <p>Analyzes pixel value distributions. LSB embedding often disrupts natural statistical patterns, creating detectable anomalies in image histograms.</p>
                                <div class="effectiveness-meter">
                                    <span>Effectiveness:</span>
                                    <div class="meter-bar"><div class="meter-fill" style="width: 85%"></div></div>
                                </div>
                            </div>
                            
                            <div class="detection-card">
                                <div class="detection-icon"></div>
                                <h3>Chi-Square Attack</h3>
                                <p>Measures the probability that adjacent pixel pairs differ in specific ways. Clean images have predictable patterns that steganography disrupts.</p>
                                <div class="effectiveness-meter">
                                    <span>Effectiveness:</span>
                                    <div class="meter-bar"><div class="meter-fill" style="width: 90%"></div></div>
                                </div>
                            </div>
                            
                            <div class="detection-card">
                                <div class="detection-icon"></div>
                                <h3>Machine Learning</h3>
                                <p>Neural networks trained on millions of clean and stego images can detect subtle patterns invisible to statistical tests. The future of steganalysis.</p>
                                <div class="effectiveness-meter">
                                    <span>Effectiveness:</span>
                                    <div class="meter-bar"><div class="meter-fill" style="width: 95%"></div></div>
                                </div>
                            </div>
                            
                            <div class="detection-card">
                                <div class="detection-icon"></div>
                                <h3>Visual Inspection</h3>
                                <p>Enhanced contrast viewing, histogram analysis, and color plane separation can reveal artifacts. Works best when steganography is poorly implemented.</p>
                                <div class="effectiveness-meter">
                                    <span>Effectiveness:</span>
                                    <div class="meter-bar"><div class="meter-fill" style="width: 60%"></div></div>
                                </div>
                            </div>
                            
                            <div class="detection-card">
                                <div class="detection-icon"></div>
                                <h3>Signature Detection</h3>
                                <p>Identifying artifacts left by known steganography tools. Many tools leave fingerprints that can be catalogued and searched for.</p>
                                <div class="effectiveness-meter">
                                    <span>Effectiveness:</span>
                                    <div class="meter-bar"><div class="meter-fill" style="width: 75%"></div></div>
                                </div>
                            </div>
                            
                            <div class="detection-card">
                                <div class="detection-icon"></div>
                                <h3>RS Analysis</h3>
                                <p>Examines regular and singular groups in pixel patterns. One of the most reliable methods for detecting LSB steganography.</p>
                                <div class="effectiveness-meter">
                                    <span>Effectiveness:</span>
                                    <div class="meter-bar"><div class="meter-fill" style="width: 88%"></div></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="detection-tip">
                            <strong> Pro Tip:</strong> Use our <a href="#" onclick="navigate('scanner'); return false;">Stego Scanner</a> tool to analyze images for potential hidden content using several of these techniques!
                        </div>
                    </div>

                    <!-- BEST PRACTICES Section -->
                    <div id="learn-practice" class="learn-section">
                        <div class="learn-section-header">
                            <span class="section-icon"></span>
                            <h2>Best Practices & Security Tips</h2>
                        </div>
                        
                        <div class="practices-grid">
                            <div class="practice-card do">
                                <div class="practice-header">
                                    <span class="practice-icon"></span>
                                    <h3>Do's</h3>
                                </div>
                                <ul class="practice-list">
                                    <li>Always use a strong password for sensitive secrets</li>
                                    <li>Keep cover text natural and contextually appropriate</li>
                                    <li>Use PNG format for lossless image quality</li>
                                    <li>Share passwords through a separate secure channel</li>
                                    <li>Use images with natural noise and detail</li>
                                    <li>Test your stego-content before sending</li>
                                    <li>Combine steganography with encryption</li>
                                    <li>Use fresh, unique cover media each time</li>
                                </ul>
                            </div>
                            
                            <div class="practice-card dont">
                                <div class="practice-header">
                                    <span class="practice-icon"></span>
                                    <h3>Don'ts</h3>
                                </div>
                                <ul class="practice-list">
                                    <li>Don't reuse the same cover text/image multiple times</li>
                                    <li>Don't use simple or obvious passwords</li>
                                    <li>Don't use JPEG for steganography (lossy compression)</li>
                                    <li>Don't send password and message together</li>
                                    <li>Don't use images with large flat color areas</li>
                                    <li>Don't exceed 10% of image capacity</li>
                                    <li>Don't trust steganography alone for security</li>
                                    <li>Don't use well-known images as covers</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="security-levels">
                            <h3> Security Level Guide</h3>
                            <div class="level-cards">
                                <div class="level-card basic">
                                    <div class="level-badge">Basic</div>
                                    <h4>Steganography Only</h4>
                                    <p>Hidden but not encrypted. Anyone with the right tool can decode.</p>
                                    <div class="level-use">Use for: Non-sensitive data, fun</div>
                                </div>
                                
                                <div class="level-card medium">
                                    <div class="level-badge">Medium</div>
                                    <h4>Stego + Password</h4>
                                    <p>Hidden AND encrypted. Requires both tool and password to access.</p>
                                    <div class="level-use">Use for: Personal secrets, private notes</div>
                                </div>
                                
                                <div class="level-card high">
                                    <div class="level-badge">High</div>
                                    <h4>Stego + Strong Encryption + Fresh Media</h4>
                                    <p>Long password, unique cover media, sent through separate channels.</p>
                                    <div class="level-use">Use for: Sensitive communications</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================================
             GUIDE PAGE
        ======================================== -->
        <section id="page-guide" class="page-section">
            <div class="guide-container">
                <div style="text-align: center; margin-bottom: 48px;">
                    <h1 style="font-size: 3rem; font-weight: 900; margin-bottom: 16px;">How Steganography Works</h1>
                    <p style="font-size: 1.2rem; color: var(--text-secondary);">Learn about hiding messages in plain sight</p>
                </div>

                <div class="guide-card">
                    <div class="guide-number">1</div>
                    <h3 class="guide-title">What is Steganography?</h3>
                    <p class="guide-text">
                        Steganography is the art of hiding secret information inside ordinary-looking data. Unlike encryption (which scrambles data), steganography conceals the very existence of the message. To an observer, the carrier text or image appears completely normal.
                    </p>
                </div>

                <div class="guide-card">
                    <div class="guide-number">2</div>
                    <h3 class="guide-title">Text Steganography (Zero-Width Characters)</h3>
                    <p class="guide-text">
                        We use Unicode zero-width characters (invisible characters) to encode your secret message. These characters are inserted between regular letters and are completely invisible to the human eye. The text looks and behaves normally, but contains hidden data that only our tool can extract.
                    </p>
                </div>

                <div class="guide-card">
                    <div class="guide-number">3</div>
                    <h3 class="guide-title">Image Steganography (LSB Method)</h3>
                    <p class="guide-text">
                        Images are made of pixels, and each pixel has color values (Red, Green, Blue). We hide data by slightly modifying the least significant bits of these color values. The changes are so small that the human eye cannot detect them, but the data can be perfectly recovered. Our quality metrics (MSE, PSNR, SSIM) confirm the image remains visually identical.
                    </p>
                </div>

                <div class="guide-card">
                    <div class="guide-number">4</div>
                    <h3 class="guide-title">Encryption Layer (AES-128)</h3>
                    <p class="guide-text">
                        When you add a password, we use AES-128 encryption (military-grade security) to encrypt your secret message before hiding it. This means even if someone discovers there's a hidden message, they can't read it without the password. This provides two layers of security: steganography (hiding) + cryptography (encryption).
                    </p>
                </div>

                <div class="guide-card">
                    <div class="guide-number">5</div>
                    <h3 class="guide-title">Best Practices</h3>
                    <p class="guide-text">
                         Always use a strong password for sensitive secrets<br>
                         Keep cover text natural and contextually appropriate<br>
                         For images, use PNG format for lossless quality<br>
                         Share the password through a separate secure channel<br>
                         Don't reuse the same cover text/image multiple times
                    </p>
                </div>
            </div>
        </section>

        <!-- ========================================
             STEGANOGRAPHY HISTORY / ABOUT PAGE
        ======================================== -->
        <section id="page-stego-history" class="page-section">
            <div class="guide-container">
                <div style="text-align: center; margin-bottom: 48px;">
                    <h1 style="font-size: 2.5rem; font-weight: 900; margin-bottom: 16px;"> The History of Steganography</h1>
                    <p style="font-size: 1.1rem; color: var(--text-secondary); max-width: 700px; margin: 0 auto;">
                        From ancient civilizations to modern digital age - discover how the art of hiding messages has evolved over millennia
                    </p>
                </div>

                <!-- Timeline -->
                <div class="stego-timeline">
                    <div class="timeline-item">
                        <div class="timeline-date">~440 BC</div>
                        <div class="timeline-content">
                            <h3> Ancient Greece - The Hidden Message</h3>
                            <p>Histiaeus shaved a slave's head and tattooed a secret message on his scalp. After the hair regrew, the slave was sent to deliver the hidden message to Aristagoras, helping to incite a revolt against Persian rule.</p>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-date">~480 BC</div>
                        <div class="timeline-content">
                            <h3> Wax Tablets</h3>
                            <p>Demaratus warned Sparta of Xerxes' invasion plans by scraping wax off tablets, writing on the wood beneath, then re-applying wax. The blank tablets passed inspection, but Queen Gorgo discovered the hidden message.</p>
                        </div>
                    </div>

                    <div class="timeline-item">
                        <div class="timeline-date">1st Century</div>
                        <div class="timeline-content">
                            <h3> Invisible Inks</h3>
                            <p>Pliny the Elder documented using plant-based invisible inks. Messages written with milk, fruit juices, or urine become visible when heated. This technique remained popular for centuries in espionage.</p>
                        </div>
                    </div>

                    <div class="timeline-item">
                        <div class="timeline-date">15th Century</div>
                        <div class="timeline-content">
                            <h3> Johannes Trithemius</h3>
                            <p>The German abbot wrote "Steganographia" (1499), the first book dedicated to steganography. While appearing to be about magic, it actually contained sophisticated cipher systems hidden within.</p>
                        </div>
                    </div>

                    <div class="timeline-item">
                        <div class="timeline-date">World War I</div>
                        <div class="timeline-content">
                            <h3> Microdots & Invisible Ink</h3>
                            <p>German spies used invisible inks extensively. Messages were hidden in innocent-looking letters. The British developed chemical tests to detect these hidden communications.</p>
                        </div>
                    </div>

                    <div class="timeline-item">
                        <div class="timeline-date">World War II</div>
                        <div class="timeline-content">
                            <h3> The Microdot Revolution</h3>
                            <p>The Germans perfected "microdots" - photographs shrunk to the size of a period. An entire page of text could be hidden in a single dot on a letter. The FBI called it "the enemy's masterpiece of espionage."</p>
                        </div>
                    </div>

                    <div class="timeline-item">
                        <div class="timeline-date">1985</div>
                        <div class="timeline-content">
                            <h3> Digital Era Begins</h3>
                            <p>With the rise of digital images, researchers began exploring how to hide data within image pixels. The concept of LSB (Least Significant Bit) embedding was developed.</p>
                        </div>
                    </div>

                    <div class="timeline-item">
                        <div class="timeline-date">1990s</div>
                        <div class="timeline-content">
                            <h3> Internet & Digital Watermarking</h3>
                            <p>As the internet grew, steganography tools proliferated. Companies began using digital watermarking to protect copyrighted images, music, and videos.</p>
                        </div>
                    </div>

                    <div class="timeline-item">
                        <div class="timeline-date">2000s</div>
                        <div class="timeline-content">
                            <h3> Modern Applications</h3>
                            <p>Steganography found legitimate uses: protecting intellectual property, secure communications, medical imaging privacy, and covert channels for whistleblowers and journalists.</p>
                        </div>
                    </div>

                    <div class="timeline-item">
                        <div class="timeline-date">Today</div>
                        <div class="timeline-content">
                            <h3> AI & Advanced Techniques</h3>
                            <p>Modern steganography uses neural networks for better hiding, audio/video embedding, and detection-resistant methods. Research continues in both hiding and detecting hidden data.</p>
                        </div>
                    </div>
                </div>

                <!-- Famous Techniques Section -->
                <div style="margin-top: 60px;">
                    <h2 style="font-size: 1.8rem; margin-bottom: 24px; text-align: center;"> Notable Techniques & Methods</h2>
                    
                    <div class="techniques-grid">
                        <div class="technique-card">
                            <div class="technique-icon"></div>
                            <h4>LSB Embedding</h4>
                            <p>Hiding data in the least significant bits of image pixels. Changes are imperceptible to human eyes but can store substantial data.</p>
                        </div>
                        
                        <div class="technique-card">
                            <div class="technique-icon"></div>
                            <h4>Zero-Width Characters</h4>
                            <p>Using invisible Unicode characters (ZWJ, ZWNJ) to encode binary data within ordinary text. Completely invisible when displayed.</p>
                        </div>
                        
                        <div class="technique-card">
                            <div class="technique-icon"></div>
                            <h4>Audio Steganography</h4>
                            <p>Embedding data in audio files by modifying inaudible frequencies or using echo hiding and spread spectrum techniques.</p>
                        </div>
                        
                        <div class="technique-card">
                            <div class="technique-icon"></div>
                            <h4>Document Steganography</h4>
                            <p>Hiding data in Word documents, PDFs through whitespace manipulation, font variations, or metadata fields.</p>
                        </div>
                        
                        <div class="technique-card">
                            <div class="technique-icon"></div>
                            <h4>Network Steganography</h4>
                            <p>Covert channels in network protocols - hiding data in packet headers, timing patterns, or unused protocol fields.</p>
                        </div>
                        
                        <div class="technique-card">
                            <div class="technique-icon"></div>
                            <h4>Video Steganography</h4>
                            <p>Embedding data across video frames. The temporal dimension allows for larger payloads while maintaining visual quality.</p>
                        </div>
                    </div>
                </div>

                <!-- Modern Uses Section -->
                <div style="margin-top: 60px;">
                    <h2 style="font-size: 1.8rem; margin-bottom: 24px; text-align: center;"> Legitimate Modern Uses</h2>
                    
                    <div class="uses-grid">
                        <div class="use-card">
                            <h4> Digital Rights Management</h4>
                            <p>Companies embed invisible watermarks in media to track unauthorized distribution and protect intellectual property.</p>
                        </div>
                        
                        <div class="use-card">
                            <h4> Journalist Protection</h4>
                            <p>Reporters in dangerous regions use steganography to safely transmit sensitive information past censorship systems.</p>
                        </div>
                        
                        <div class="use-card">
                            <h4> Medical Privacy</h4>
                            <p>Patient information can be embedded within medical images (X-rays, MRIs), keeping data linked without visible annotations.</p>
                        </div>
                        
                        <div class="use-card">
                            <h4> Ballot Security</h4>
                            <p>Some electronic voting systems use steganographic techniques to verify ballot integrity without compromising voter privacy.</p>
                        </div>
                    </div>
                </div>

                <!-- Steganalysis Section -->
                <div style="margin-top: 60px; margin-bottom: 40px;">
                    <h2 style="font-size: 1.8rem; margin-bottom: 24px; text-align: center;"> Steganalysis: The Counter-Measure</h2>
                    
                    <div class="guide-card" style="max-width: 800px; margin: 0 auto;">
                        <p class="guide-text" style="margin-bottom: 16px;">
                            <strong>Steganalysis</strong> is the science of detecting hidden messages. Just as cryptanalysis tries to break encryption, steganalysis attempts to detect steganographic content. Methods include:
                        </p>
                        <ul style="color: var(--text-secondary); line-height: 1.8; padding-left: 20px;">
                            <li><strong>Statistical Analysis:</strong> Looking for anomalies in data patterns (chi-square tests, RS analysis)</li>
                            <li><strong>Visual Inspection:</strong> Enhanced contrast viewing, histogram analysis</li>
                            <li><strong>Machine Learning:</strong> Training AI to detect subtle differences between clean and stego-images</li>
                            <li><strong>Signature Detection:</strong> Identifying artifacts left by known steganography tools</li>
                        </ul>
                        <p class="guide-text" style="margin-top: 16px;">
                            Our Scanner tool uses several of these techniques to analyze images for potential hidden content.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================================
             HISTORY PAGE
        ======================================== -->
        <section id="page-history" class="page-section">
            <div class="history-panel">
                <div class="history-header">
                    <h2 class="history-title"> Operation History</h2>
                    <div class="history-actions">
                        <button class="btn-action" onclick="refreshHistory()"> Refresh</button>
                        <button class="btn-action" onclick="clearAllHistory()" style="color: #ef4444;"> Clear All</button>
                    </div>
                </div>
                
                <div id="history-stats" class="analytics-grid" style="padding: 24px;">
                    <div class="metric-card">
                        <div class="metric-value" id="history-total">0</div>
                        <div class="metric-label">Total Operations</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="history-encodes">0</div>
                        <div class="metric-label">Encodes</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="history-decodes">0</div>
                        <div class="metric-label">Decodes</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="history-encrypted">0</div>
                        <div class="metric-label">Encrypted</div>
                    </div>
                </div>
                
                <div id="history-list" class="history-list">
                    <div class="history-empty">
                        <div class="history-empty-icon"></div>
                        <p>No history yet. Start encoding or decoding messages!</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================================
             ACCOUNT SETTINGS PAGE
        ======================================== -->
        <section id="page-account" class="page-section">
            <!-- Account Header with Avatar -->
            <div class="account-hero">
                <div class="account-avatar-large" id="account-avatar-display">
                    <span id="account-avatar-letter">?</span>
                </div>
                <h1 class="account-name" id="account-display-name">Welcome</h1>
                <p class="account-email-display" id="account-email-display">Sign in to view your account</p>
                <div class="account-stats-row">
                    <div class="account-stat">
                        <span class="account-stat-value" id="account-stat-encodes">0</span>
                        <span class="account-stat-label">Encodes</span>
                    </div>
                    <div class="account-stat">
                        <span class="account-stat-value" id="account-stat-decodes">0</span>
                        <span class="account-stat-label">Decodes</span>
                    </div>
                    <div class="account-stat">
                        <span class="account-stat-value" id="account-stat-encrypted">0</span>
                        <span class="account-stat-label">Encrypted</span>
                    </div>
                </div>
            </div>
            
            <!-- Settings Cards Grid -->
            <div class="settings-grid">
                <!-- Profile Card -->
                <div class="settings-card">
                    <div class="settings-card-header">
                        <div class="settings-card-icon"></div>
                        <h3 class="settings-card-title">Profile Information</h3>
                    </div>
                    <div class="settings-card-body">
                        <div class="profile-info-row">
                            <span class="profile-label">Username</span>
                            <span class="profile-value" id="account-username">-</span>
                        </div>
                        <div class="profile-info-row">
                            <span class="profile-label">Email</span>
                            <span class="profile-value" id="account-email">-</span>
                        </div>
                        <div class="profile-info-row">
                            <span class="profile-label">Member Since</span>
                            <span class="profile-value" id="account-created">-</span>
                        </div>
                    </div>
                </div>
                
                <!-- Security Card -->
                <div class="settings-card">
                    <div class="settings-card-header">
                        <div class="settings-card-icon"></div>
                        <h3 class="settings-card-title">Change Password</h3>
                    </div>
                    <div class="settings-card-body">
                        <div class="auth-form-group">
                            <label class="auth-form-label">Current Password</label>
                            <input type="password" id="current-password" class="input-field" placeholder="Enter current password">
                        </div>
                        <div class="auth-form-group">
                            <label class="auth-form-label">New Password</label>
                            <input type="password" id="new-password" class="input-field" placeholder="Enter new password">
                        </div>
                        <div class="auth-form-group">
                            <label class="auth-form-label">Confirm New Password</label>
                            <input type="password" id="confirm-new-password" class="input-field" placeholder="Confirm new password">
                        </div>
                        <button onclick="handleChangePassword()" class="settings-btn primary"> Update Password</button>
                    </div>
                </div>
                
                <!-- Danger Zone Card -->
                <div class="settings-card danger">
                    <div class="settings-card-header">
                        <div class="settings-card-icon danger"></div>
                        <h3 class="settings-card-title danger">Danger Zone</h3>
                    </div>
                    <div class="settings-card-body">
                        <p class="danger-warning">Once you delete your account, there is no going back. All your data, history, and preferences will be permanently removed.</p>
                        <button onclick="handleDeleteAccount()" class="settings-btn danger"> Delete My Account</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================================
             STEGANOGRAPHY HISTORY PAGE
        ======================================== -->
        <section id="page-stego-history" class="page-section">
            <div class="workspace-card">
                <div class="card-header">
                    <h2 class="card-title"> History of Steganography</h2>
                    <p class="card-subtitle">Famous cases, techniques, and attacks throughout history</p>
                </div>
                <div class="card-body">
                    
                    <!-- Timeline Section -->
                    <div class="history-section">
                        <h3 class="history-section-title"> Historical Timeline</h3>
                        
                        <div class="history-timeline">
                            <div class="timeline-item">
                                <div class="timeline-year">440 BC</div>
                                <div class="timeline-content">
                                    <h4>Ancient Greece - Histiaeus</h4>
                                    <p>The first recorded use of steganography. Histiaeus shaved a slave's head, tattooed a message on his scalp, waited for hair to regrow, then sent him to deliver the hidden message.</p>
                                </div>
                            </div>
                            
                            <div class="timeline-item">
                                <div class="timeline-year">1499</div>
                                <div class="timeline-content">
                                    <h4>Johannes Trithemius</h4>
                                    <p>Published "Steganographia" - the first book on the art of hidden writing. Though it appeared to be about magic, it actually contained sophisticated encryption techniques.</p>
                                </div>
                            </div>
                            
                            <div class="timeline-item">
                                <div class="timeline-year">WWII</div>
                                <div class="timeline-content">
                                    <h4>Microdots & Invisible Ink</h4>
                                    <p>German spies used microdots - photographs shrunk to the size of a period that could contain an entire page of text. Allies also used invisible ink made from various chemicals.</p>
                                </div>
                            </div>
                            
                            <div class="timeline-item">
                                <div class="timeline-year">1985</div>
                                <div class="timeline-content">
                                    <h4>Digital Steganography Begins</h4>
                                    <p>With the rise of digital images and the internet, steganography evolved into hiding data in digital files using techniques like LSB (Least Significant Bit) encoding.</p>
                                </div>
                            </div>
                            
                            <div class="timeline-item">
                                <div class="timeline-year">2001</div>
                                <div class="timeline-content">
                                    <h4>Post-9/11 Concerns</h4>
                                    <p>Reports suggested terrorists may have used steganography to communicate. This led to increased research in steganalysis - the art of detecting hidden messages.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Famous Cases Section -->
                    <div class="history-section">
                        <h3 class="history-section-title"> Famous Cases & Examples</h3>
                        
                        <div class="history-cases-grid">
                            <div class="history-case-card">
                                <div class="case-icon"></div>
                                <h4>Operation Bernhard (WWII)</h4>
                                <p>Nazi Germany's plan to destabilize Britain by flooding the economy with counterfeit pound notes. Messages were hidden in the watermarks of the forged currency.</p>
                                <div class="case-tag">Wartime</div>
                            </div>
                            
                            <div class="history-case-card">
                                <div class="case-icon"></div>
                                <h4>Bin Laden's Steganography</h4>
                                <p>After 9/11, rumors circulated that Al-Qaeda used steganography in images on eBay and pornographic websites to coordinate attacks. While never proven, it sparked major research.</p>
                                <div class="case-tag">Modern</div>
                            </div>
                            
                            <div class="history-case-card">
                                <div class="case-icon"></div>
                                <h4>Russian Spy Ring (2010)</h4>
                                <p>The FBI caught Russian sleeper agents who embedded secret messages in images posted on public websites. The "Illegals Program" used sophisticated digital steganography.</p>
                                <div class="case-tag">Espionage</div>
                            </div>
                            
                            <div class="history-case-card">
                                <div class="case-icon"></div>
                                <h4>Audio Steganography</h4>
                                <p>Musicians have hidden messages in albums - from The Beatles' "Revolution 9" (play backward) to Aphex Twin's spectrogram face hidden in "Equation" audio frequencies.</p>
                                <div class="case-tag">Entertainment</div>
                            </div>
                            
                            <div class="history-case-card">
                                <div class="case-icon"></div>
                                <h4>Null Cipher in WWII</h4>
                                <p>German spy Velvalee Dickinson sent letters about "dolls" to contacts in South America. Reading every first letter of each word revealed hidden military intelligence.</p>
                                <div class="case-tag">Classic</div>
                            </div>
                            
                            <div class="history-case-card">
                                <div class="case-icon"></div>
                                <h4>Printer Tracking Dots</h4>
                                <p>Many color printers secretly embed nearly invisible yellow dots that encode the printer's serial number and timestamp. NSA leaker Reality Winner was caught this way in 2017.</p>
                                <div class="case-tag">Forensics</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Steganalysis Attacks Section -->
                    <div class="history-section">
                        <h3 class="history-section-title"> Steganalysis Attacks</h3>
                        <p style="margin-bottom: 24px; color: var(--text-secondary);">Techniques used to detect hidden messages in digital files</p>
                        
                        <div class="attack-grid">
                            <div class="attack-card">
                                <div class="attack-header">
                                    <span class="attack-icon"></span>
                                    <h4>Statistical Analysis</h4>
                                </div>
                                <p>Analyzes the statistical properties of pixel values. LSB embedding often disrupts natural distributions, creating detectable anomalies in histograms.</p>
                                <div class="attack-effectiveness">
                                    <span>Effectiveness:</span>
                                    <div class="effectiveness-bar"><div style="width: 85%;"></div></div>
                                </div>
                            </div>
                            
                            <div class="attack-card">
                                <div class="attack-header">
                                    <span class="attack-icon"></span>
                                    <h4>Chi-Square Attack</h4>
                                </div>
                                <p>Detects sequential LSB embedding by measuring the probability that pixel pairs differ. Clean images have specific statistical patterns that steganography disrupts.</p>
                                <div class="attack-effectiveness">
                                    <span>Effectiveness:</span>
                                    <div class="effectiveness-bar"><div style="width: 90%;"></div></div>
                                </div>
                            </div>
                            
                            <div class="attack-card">
                                <div class="attack-header">
                                    <span class="attack-icon"></span>
                                    <h4>Machine Learning Detection</h4>
                                </div>
                                <p>Neural networks trained on thousands of clean and stego images can detect subtle patterns invisible to traditional analysis. CNNs achieve >95% accuracy.</p>
                                <div class="attack-effectiveness">
                                    <span>Effectiveness:</span>
                                    <div class="effectiveness-bar"><div style="width: 95%;"></div></div>
                                </div>
                            </div>
                            
                            <div class="attack-card">
                                <div class="attack-header">
                                    <span class="attack-icon"></span>
                                    <h4>Visual Attack</h4>
                                </div>
                                <p>Extracts and enhances the least significant bit plane. In stego images, this reveals patterns; in clean images, it appears random. Simple but effective.</p>
                                <div class="attack-effectiveness">
                                    <span>Effectiveness:</span>
                                    <div class="effectiveness-bar"><div style="width: 70%;"></div></div>
                                </div>
                            </div>
                            
                            <div class="attack-card">
                                <div class="attack-header">
                                    <span class="attack-icon"></span>
                                    <h4>RS Analysis</h4>
                                </div>
                                <p>Regular-Singular analysis divides image into groups and measures how flipping LSBs affects "smoothness." Stego images show characteristic RS patterns.</p>
                                <div class="attack-effectiveness">
                                    <span>Effectiveness:</span>
                                    <div class="effectiveness-bar"><div style="width: 80%;"></div></div>
                                </div>
                            </div>
                            
                            <div class="attack-card">
                                <div class="attack-header">
                                    <span class="attack-icon"></span>
                                    <h4>Sample Pair Analysis</h4>
                                </div>
                                <p>Examines pairs of pixels to estimate the embedding rate. Can detect even low-capacity embedding and estimate how much data is hidden.</p>
                                <div class="attack-effectiveness">
                                    <span>Effectiveness:</span>
                                    <div class="effectiveness-bar"><div style="width: 75%;"></div></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Modern Techniques Section -->
                    <div class="history-section">
                        <h3 class="history-section-title"> Modern Steganography Techniques</h3>
                        
                        <div class="techniques-grid">
                            <div class="technique-card">
                                <h4> Image Steganography</h4>
                                <ul>
                                    <li><strong>LSB Embedding:</strong> Replaces least significant bits of pixels</li>
                                    <li><strong>DCT Domain:</strong> Hides data in JPEG compression coefficients</li>
                                    <li><strong>Spread Spectrum:</strong> Spreads message across frequency domain</li>
                                    <li><strong>Adaptive:</strong> Embeds only in "noisy" image regions</li>
                                </ul>
                            </div>
                            
                            <div class="technique-card">
                                <h4> Audio Steganography</h4>
                                <ul>
                                    <li><strong>Echo Hiding:</strong> Encodes data in sound echoes</li>
                                    <li><strong>Phase Coding:</strong> Modifies audio phase components</li>
                                    <li><strong>Spread Spectrum:</strong> Hides in audio frequency spread</li>
                                    <li><strong>MP3 Stego:</strong> Embeds in compression artifacts</li>
                                </ul>
                            </div>
                            
                            <div class="technique-card">
                                <h4> Text Steganography</h4>
                                <ul>
                                    <li><strong>Zero-Width Characters:</strong> Invisible Unicode characters</li>
                                    <li><strong>Whitespace:</strong> Extra spaces and tabs encode bits</li>
                                    <li><strong>Semantic:</strong> Word substitution with synonyms</li>
                                    <li><strong>Format-Based:</strong> Font, size, or color variations</li>
                                </ul>
                            </div>
                            
                            <div class="technique-card">
                                <h4> Network Steganography</h4>
                                <ul>
                                    <li><strong>Protocol Fields:</strong> Unused TCP/IP header fields</li>
                                    <li><strong>Timing Channels:</strong> Packet timing encodes data</li>
                                    <li><strong>DNS Tunneling:</strong> Data in DNS queries</li>
                                    <li><strong>ICMP Covert:</strong> Hidden in ping packets</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Fun Facts Section -->
                    <div class="history-section">
                        <h3 class="history-section-title"> Fun Facts</h3>
                        <div class="fun-facts-grid">
                            <div class="fun-fact">
                                <span class="fun-fact-icon"></span>
                                <p>In the movie "A Beautiful Mind," John Nash discovers hidden Soviet messages in newspapers - a dramatization of real Cold War paranoia about steganography.</p>
                            </div>
                            <div class="fun-fact">
                                <span class="fun-fact-icon"></span>
                                <p>A typical 1080p image can hide approximately 2.5 MB of data using advanced LSB techniques without visible quality loss.</p>
                            </div>
                            <div class="fun-fact">
                                <span class="fun-fact-icon"></span>
                                <p>Some apps use steganography to watermark screenshots, allowing companies to trace leaks back to specific users.</p>
                            </div>
                            <div class="fun-fact">
                                <span class="fun-fact-icon"></span>
                                <p>Video game developers have hidden messages in game files. Minecraft famously contains the phrase "FOLLOW THE RABBIT" in its audio files.</p>
                            </div>
                        </div>
                    </div>
                    
                </div>
            </div>
        </section>

    </div>

    <script>
        // Automatically use the correct API endpoint
        const API_BASE = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
            ? 'http://localhost:5000/api' 
            : `${window.location.protocol}//${window.location.host}/api`;
        
        // Debug: Log API base on load
        console.log('API Base URL:', API_BASE);
        
        let coverImageData = null;
        let stegoImageData = null;
        let decodeImageData = null;
        
        // System limits (will be loaded from API)
        let systemLimits = {
            max_text_length: 100000,
            max_secret_length: 50000,
            max_image_dimension: 4096
        };
        
        // Auth state
        let authState = {
            isLoggedIn: false,
            user: null,
            accessToken: null,
            refreshToken: null
        };

        // Statistics tracking
        let stats = {
            encodes: 0,
            decodes: 0,
            totalTime: 0,
            operations: 0
        };
        
        // ============================================================================
        // THEME TOGGLE FUNCTIONS
        // ============================================================================
        
        function initTheme() {
            // Check localStorage for saved theme
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                document.documentElement.setAttribute('data-theme', savedTheme);
            } else {
                // Check system preference
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                document.documentElement.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
            }
        }
        
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            // Animate the toggle button
            const toggle = document.querySelector('.theme-toggle');
            toggle.style.transform = 'scale(0.8) rotate(360deg)';
            setTimeout(() => {
                toggle.style.transform = 'scale(1) rotate(0deg)';
            }, 300);
        }
        
        // Initialize theme on page load
        initTheme();
        
        // ============================================================================
        // PASSWORD GENERATOR FUNCTIONS
        // ============================================================================
        
        function generatePassword(inputId) {
            const length = 16;
            const uppercase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const lowercase = 'abcdefghijklmnopqrstuvwxyz';
            const numbers = '0123456789';
            const symbols = '!@#$%^&*()_+-=[]{}|;:,.<>?';
            const allChars = uppercase + lowercase + numbers + symbols;
            
            let password = '';
            // Ensure at least one of each type
            password += uppercase[Math.floor(Math.random() * uppercase.length)];
            password += lowercase[Math.floor(Math.random() * lowercase.length)];
            password += numbers[Math.floor(Math.random() * numbers.length)];
            password += symbols[Math.floor(Math.random() * symbols.length)];
            
            // Fill the rest randomly
            for (let i = 4; i < length; i++) {
                password += allChars[Math.floor(Math.random() * allChars.length)];
            }
            
            // Shuffle the password
            password = password.split('').sort(() => Math.random() - 0.5).join('');
            
            // Set the password
            const input = document.getElementById(inputId);
            if (input) {
                input.value = password;
                input.type = 'text'; // Show the password
                
                // Flash animation
                input.style.transition = 'background-color 0.3s';
                input.style.backgroundColor = 'rgba(16, 185, 129, 0.2)';
                setTimeout(() => {
                    input.style.backgroundColor = '';
                }, 300);
            }
            
            showNotification(' Strong password generated!', 'success');
        }
        
        function copyPasswordToClipboard(inputId) {
            const input = document.getElementById(inputId);
            if (input && input.value) {
                navigator.clipboard.writeText(input.value).then(() => {
                    showNotification(' Password copied to clipboard!', 'success');
                }).catch(err => {
                    showNotification('Failed to copy password', 'error');
                });
            } else {
                showNotification('No password to copy', 'warning');
            }
        }
        // ============================================================================
        // AUTH FUNCTIONS
        // ============================================================================
        
        function openAuthModal(type = 'login') {
            document.getElementById('auth-modal').classList.add('active');
            if (type === 'signup') {
                showSignupForm();
            } else {
                showLoginForm();
            }
        }
        
        function closeAuthModal() {
            document.getElementById('auth-modal').classList.remove('active');
            clearAuthErrors();
        }
        
        function showLoginForm() {
            document.getElementById('login-form').classList.remove('hidden');
            document.getElementById('signup-form').classList.add('hidden');
            clearAuthErrors();
        }
        
        function showSignupForm() {
            document.getElementById('login-form').classList.add('hidden');
            document.getElementById('signup-form').classList.remove('hidden');
            clearAuthErrors();
        }
        
        function clearAuthErrors() {
            document.querySelectorAll('.auth-form-error').forEach(el => {
                el.classList.remove('show');
                el.textContent = '';
            });
            document.querySelectorAll('.auth-form-input').forEach(el => {
                el.classList.remove('error');
            });
        }
        
        function clearAllFormFields() {
            // Clear text encode/decode fields
            const textCover = document.getElementById('text-cover');
            const textSecret = document.getElementById('text-secret');
            const textPassword = document.getElementById('text-password');
            const textEncodeOutput = document.getElementById('text-encode-output');
            const textDecodeInput = document.getElementById('text-decode-input');
            const textDecodePassword = document.getElementById('text-decode-password');
            const textDecodeOutput = document.getElementById('text-decode-output');
            
            if (textCover) textCover.value = '';
            if (textSecret) textSecret.value = '';
            if (textPassword) textPassword.value = '';
            if (textEncodeOutput) textEncodeOutput.value = '';
            if (textDecodeInput) textDecodeInput.value = '';
            if (textDecodePassword) textDecodePassword.value = '';
            if (textDecodeOutput) textDecodeOutput.textContent = '';
            
            // Clear image encode/decode fields  
            const imageSecret = document.getElementById('image-secret');
            const imagePassword = document.getElementById('image-password');
            const imageDecodePassword = document.getElementById('image-decode-password');
            const imageDecodeOutput = document.getElementById('image-decode-output');
            const imageEncodePreview = document.getElementById('image-encode-preview');
            const imageDecodePreview = document.getElementById('image-decode-preview');
            const imageEncodeInput = document.getElementById('image-encode-input');
            const imageDecodeInput = document.getElementById('image-decode-input');
            
            if (imageSecret) imageSecret.value = '';
            if (imagePassword) imagePassword.value = '';
            if (imageDecodePassword) imageDecodePassword.value = '';
            if (imageDecodeOutput) imageDecodeOutput.textContent = '';
            if (imageEncodePreview) imageEncodePreview.innerHTML = '';
            if (imageDecodePreview) imageDecodePreview.innerHTML = '';
            if (imageEncodeInput) imageEncodeInput.value = '';
            if (imageDecodeInput) imageDecodeInput.value = '';
            
            // Clear multi-file stego
            const mfSecret = document.getElementById('mf-secret');
            const mfResults = document.getElementById('mf-results');
            const mfPreview = document.getElementById('mf-preview');
            const mfEncodePreview = document.getElementById('mf-encode-preview');
            
            if (mfSecret) mfSecret.value = '';
            if (mfResults) mfResults.innerHTML = '';
            if (mfPreview) mfPreview.innerHTML = '';
            if (mfEncodePreview) mfEncodePreview.innerHTML = '';
            
            // Clear scanner
            const scannerOutput = document.getElementById('scanner-output');
            const scannerPreview = document.getElementById('scanner-preview');
            const scannerText = document.getElementById('scanner-text');
            const scannerTextOutput = document.getElementById('scanner-text-output');
            
            if (scannerOutput) scannerOutput.innerHTML = '';
            if (scannerPreview) scannerPreview.innerHTML = '';
            if (scannerText) scannerText.value = '';
            if (scannerTextOutput) scannerTextOutput.innerHTML = '';
            
            // Hide result sections
            document.getElementById('text-encode-result')?.classList.add('hidden');
            document.getElementById('text-decode-result')?.classList.add('hidden');
            document.getElementById('image-encode-result')?.classList.add('hidden');
            document.getElementById('image-decode-result')?.classList.add('hidden');
            
            // Reset character counters
            document.querySelectorAll('.char-count').forEach(el => {
                el.textContent = '0';
            });
            
            // Reset global variables in features.js if they exist
            if (typeof multiFileImages !== 'undefined') {
                multiFileImages.length = 0;
            }
            if (typeof mfCustomImages !== 'undefined') {
                mfCustomImages.length = 0;
            }
            if (typeof scannerImageData !== 'undefined') {
                scannerImageData = null;
            }
            
            // Reset any global image data
            if (typeof currentImageData !== 'undefined') {
                currentImageData = null;
            }
            
            console.log('All form fields cleared');
        }
        
        function showAuthError(fieldId, message) {
            const input = document.getElementById(fieldId);
            const error = document.getElementById(fieldId + '-error');
            if (input) input.classList.add('error');
            if (error) {
                error.textContent = message;
                error.classList.add('show');
            }
        }
        
        function updatePasswordStrength() {
            const password = document.getElementById('signup-password').value;
            const bar = document.getElementById('password-strength-bar');
            
            let strength = 0;
            if (password.length >= 8) strength++;
            if (/[A-Z]/.test(password)) strength++;
            if (/[a-z]/.test(password)) strength++;
            if (/[0-9]/.test(password)) strength++;
            if (/[!@#$%^&*()_+\-=\[\]{}|;:,.<>?]/.test(password)) strength++;
            
            bar.className = 'password-strength-bar';
            if (strength === 0) bar.style.width = '0%';
            else if (strength <= 2) bar.classList.add('weak');
            else if (strength === 3) bar.classList.add('fair');
            else if (strength === 4) bar.classList.add('good');
            else bar.classList.add('strong');
        }
        
        async function handleLogin() {
            clearAuthErrors();
            
            const username = document.getElementById('login-username').value.trim();
            const password = document.getElementById('login-password').value;
            const loginBtn = document.getElementById('login-btn');
            
            if (!username) {
                showAuthError('login-username', 'Username or email is required');
                return;
            }
            if (!password) {
                showAuthError('login-password', 'Password is required');
                return;
            }
            
            // Show loading state
            loginBtn.classList.add('loading');
            loginBtn.disabled = true;
            
            try {
                console.log('Attempting login to:', `${API_BASE}/auth/login`);
                
                const response = await fetch(`${API_BASE}/auth/login`, {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({
                        username_or_email: username,
                        password: password
                    })
                });
                
                console.log('Login response status:', response.status);
                
                // Check if response is ok before parsing JSON
                if (!response.ok && response.status === 404) {
                    showAuthError('login-password', 'Server not available. Please try again later.');
                    loginBtn.classList.remove('loading');
                    loginBtn.disabled = false;
                    return;
                }
                
                const data = await response.json();
                console.log('Login response data:', data);
                
                if (data.success) {
                    // Save auth state
                    authState = {
                        isLoggedIn: true,
                        user: data.user,
                        accessToken: data.access_token,
                        refreshToken: data.refresh_token
                    };
                    localStorage.setItem('auth', JSON.stringify(authState));
                    
                    // Clear all form fields for the new session
                    clearAllFormFields();
                    
                    updateAuthUI();
                    closeAuthModal();
                    
                    // Navigate to home page after login
                    navigate('home');
                    
                    showToast(' Welcome back, ' + data.user.username + '!');
                } else {
                    // Format user-friendly error messages
                    let errorMsg = data.error || 'Login failed';
                    if (errorMsg.includes('Invalid username/email or password')) {
                        errorMsg = 'Incorrect username/email or password';
                    } else if (errorMsg.includes('Invalid password')) {
                        errorMsg = data.error; // Keep the attempts remaining message
                    } else if (errorMsg.includes('Account is locked')) {
                        errorMsg = data.error;
                    } else if (errorMsg.includes('Account is deactivated')) {
                        errorMsg = 'This account has been deactivated';
                    }
                    showAuthError('login-password', errorMsg);
                }
            } catch (error) {
                console.error('Login error:', error);
                // More specific error handling
                if (error.name === 'TypeError' && error.message.includes('Failed to fetch')) {
                    showAuthError('login-password', 'Cannot connect to server. Please ensure the server is running.');
                } else if (error instanceof SyntaxError) {
                    showAuthError('login-password', 'Server returned invalid response. Please try again.');
                } else {
                    showAuthError('login-password', 'Connection error. Please check your internet connection.');
                }
            }
            
            // Hide loading state
            loginBtn.classList.remove('loading');
            loginBtn.disabled = false;
        }
        
        async function handleSignup() {
            clearAuthErrors();
            
            const username = document.getElementById('signup-username').value.trim();
            const email = document.getElementById('signup-email').value.trim();
            const password = document.getElementById('signup-password').value;
            const confirm = document.getElementById('signup-confirm').value;
            const signupBtn = document.getElementById('signup-btn');
            
            // Validation
            if (!username) {
                showAuthError('signup-username', 'Username is required');
                return;
            }
            if (username.length < 3) {
                showAuthError('signup-username', 'Username must be at least 3 characters');
                return;
            }
            if (!email) {
                showAuthError('signup-email', 'Email is required');
                return;
            }
            if (!email.includes('@')) {
                showAuthError('signup-email', 'Invalid email format');
                return;
            }
            if (!password) {
                showAuthError('signup-password', 'Password is required');
                return;
            }
            if (password.length < 8) {
                showAuthError('signup-password', 'Password must be at least 8 characters');
                return;
            }
            if (password !== confirm) {
                showAuthError('signup-confirm', 'Passwords do not match');
                return;
            }
            
            // Show loading state
            signupBtn.classList.add('loading');
            signupBtn.disabled = true;
            
            try {
                console.log('Attempting signup to:', `${API_BASE}/auth/signup`);
                
                const response = await fetch(`${API_BASE}/auth/signup`, {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({ username, email, password })
                });
                
                console.log('Signup response status:', response.status);
                
                // Check if response is ok before parsing JSON
                if (!response.ok && response.status === 404) {
                    showAuthError('signup-password', 'Server not available. Please try again later.');
                    signupBtn.classList.remove('loading');
                    signupBtn.disabled = false;
                    return;
                }
                
                const data = await response.json();
                console.log('Signup response data:', data);
                
                if (data.success) {
                    authState = {
                        isLoggedIn: true,
                        user: data.user,
                        accessToken: data.access_token,
                        refreshToken: data.refresh_token
                    };
                    localStorage.setItem('auth', JSON.stringify(authState));
                    
                    updateAuthUI();
                    closeAuthModal();
                    showToast(' Account created! Welcome, ' + data.user.username + '!');
                } else {
                    // Show specific field errors with user-friendly messages
                    let errorMsg = data.error || 'Signup failed';
                    const errorLower = errorMsg.toLowerCase();
                    
                    if (errorLower.includes('username') && errorLower.includes('exists')) {
                        showAuthError('signup-username', 'This username is already taken');
                    } else if (errorLower.includes('email') && errorLower.includes('exists')) {
                        showAuthError('signup-email', 'An account with this email already exists');
                    } else if (errorLower.includes('username')) {
                        showAuthError('signup-username', errorMsg);
                    } else if (errorLower.includes('email')) {
                        showAuthError('signup-email', errorMsg);
                    } else if (errorLower.includes('password')) {
                        showAuthError('signup-password', errorMsg);
                    } else {
                        showAuthError('signup-password', errorMsg);
                    }
                }
            } catch (error) {
                console.error('Signup error:', error);
                // More specific error handling
                if (error.name === 'TypeError' && error.message.includes('Failed to fetch')) {
                    showAuthError('signup-password', 'Cannot connect to server. Please ensure the server is running.');
                } else if (error instanceof SyntaxError) {
                    showAuthError('signup-password', 'Server returned invalid response. Please try again.');
                } else {
                    showAuthError('signup-password', 'Connection error. Please check your internet connection.');
                }
            }
            
            // Hide loading state
            signupBtn.classList.remove('loading');
            signupBtn.disabled = false;
        }
        
        async function handleLogout() {
            showLoading(true);
            try {
                if (authState.accessToken) {
                    await fetch(`${API_BASE}/auth/logout`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${authState.accessToken}`
                        },
                        body: JSON.stringify({ refresh_token: authState.refreshToken })
                    });
                }
            } catch (e) {
                // Ignore errors on logout
            }
            
            authState = { isLoggedIn: false, user: null, accessToken: null, refreshToken: null };
            localStorage.removeItem('auth');
            
            // Clear all form fields when logging out
            clearAllFormFields();
            
            updateAuthUI();
            closeUserDropdown();
            navigate('home');
            showToast(' Logged out successfully');
            showLoading(false);
        }
        
        function updateAuthUI() {
            const authButtons = document.getElementById('auth-buttons');
            const userMenu = document.getElementById('user-menu');
            const navHistory = document.getElementById('nav-history');
            
            if (authState.isLoggedIn && authState.user) {
                authButtons.style.display = 'none';
                userMenu.classList.add('active');
                if (navHistory) navHistory.style.display = 'block';
                
                // Update user info
                document.getElementById('user-avatar').textContent = authState.user.username.charAt(0).toUpperCase();
                document.getElementById('user-dropdown-name').textContent = authState.user.username;
                document.getElementById('user-dropdown-email').textContent = authState.user.email;
                
                // Update account page
                document.getElementById('account-username').textContent = authState.user.username;
                document.getElementById('account-email').textContent = authState.user.email;
                
                // Update new account hero section
                document.getElementById('account-avatar-letter').textContent = authState.user.username.charAt(0).toUpperCase();
                document.getElementById('account-display-name').textContent = authState.user.username;
                document.getElementById('account-email-display').textContent = authState.user.email;
            } else {
                authButtons.style.display = 'flex';
                userMenu.classList.remove('active');
                if (navHistory) navHistory.style.display = 'none';
            }
        }
        
        function toggleUserDropdown() {
            document.getElementById('user-dropdown').classList.toggle('show');
        }
        
        function closeUserDropdown() {
            document.getElementById('user-dropdown').classList.remove('show');
        }
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.user-menu')) {
                closeUserDropdown();
            }
        });
        
        function getAuthHeaders() {
            if (authState.accessToken) {
                return { 'Authorization': `Bearer ${authState.accessToken}` };
            }
            return {};
        }
        
        // Helper function to make authenticated API calls with automatic token refresh
        async function authFetch(url, options = {}) {
            // Add auth headers
            options.headers = {
                ...options.headers,
                ...getAuthHeaders()
            };
            
            let response = await fetch(url, options);
            
            // If unauthorized and we have a refresh token, try to refresh and retry
            if (response.status === 401 && authState.refreshToken) {
                const refreshed = await refreshAccessToken();
                if (refreshed) {
                    // Update headers with new token
                    options.headers = {
                        ...options.headers,
                        ...getAuthHeaders()
                    };
                    // Retry the request
                    response = await fetch(url, options);
                }
            }
            
            return response;
        }
        
        // Token refresh
        async function refreshAccessToken() {
            if (!authState.refreshToken) return false;
            
            try {
                const response = await fetch(`${API_BASE}/auth/refresh`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ refresh_token: authState.refreshToken })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    authState.accessToken = data.access_token;
                    localStorage.setItem('auth', JSON.stringify(authState));
                    return true;
                }
            } catch (e) {
                console.error('Token refresh failed:', e);
            }
            
            // Refresh failed, log out
            authState = { isLoggedIn: false, user: null, accessToken: null, refreshToken: null };
            localStorage.removeItem('auth');
            updateAuthUI();
            return false;
        }
        
        // ============================================================================
        // HISTORY FUNCTIONS
        // ============================================================================
        
        async function loadAccountStats() {
            if (!authState.isLoggedIn) return;
            
            try {
                const response = await fetch(`${API_BASE}/history/stats`, {
                    headers: { ...getAuthHeaders() }
                });
                const data = await response.json();
                if (data.success) {
                    document.getElementById('account-stat-encodes').textContent = data.stats.encodes || 0;
                    document.getElementById('account-stat-decodes').textContent = data.stats.decodes || 0;
                    document.getElementById('account-stat-encrypted').textContent = data.stats.encrypted_operations || 0;
                }
            } catch (e) {
                console.error('Failed to load account stats:', e);
            }
        }
        
        async function loadHistory() {
            if (!authState.isLoggedIn) return;
            
            try {
                const response = await authFetch(`${API_BASE}/history`, {
                    method: 'GET',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    renderHistory(data.history);
                    
                    // Load stats
                    const statsResponse = await authFetch(`${API_BASE}/history/stats`, {
                        method: 'GET',
                        headers: { 'Content-Type': 'application/json' }
                    });
                    const statsData = await statsResponse.json();
                    if (statsData.success) {
                        document.getElementById('history-total').textContent = statsData.stats.total_operations;
                        document.getElementById('history-encodes').textContent = statsData.stats.encodes;
                        document.getElementById('history-decodes').textContent = statsData.stats.decodes;
                        document.getElementById('history-encrypted').textContent = statsData.stats.encrypted_operations;
                    }
                }
            } catch (e) {
                console.error('Failed to load history:', e);
            }
        }
        
        function renderHistory(items) {
            const container = document.getElementById('history-list');
            
            if (!items || items.length === 0) {
                container.innerHTML = `
                    <div class="history-empty">
                        <div class="history-empty-icon"></div>
                        <p>No history yet. Start encoding or decoding messages!</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = items.map(item => {
                const metadata = item.metadata || {};
                return `
                <div class="history-item-wrapper" data-id="${item.id}">
                    <div class="history-item" onclick="toggleHistoryDetails(${item.id})">
                        <div class="history-item-icon ${item.operation_type}">
                            ${item.operation_type === 'encode' ? '' : ''}
                        </div>
                        <div class="history-item-content">
                            <div class="history-item-title">
                                ${item.operation_type === 'encode' ? 'Encoded' : 'Decoded'} message
                                <span class="history-item-badge ${item.algorithm}">${item.algorithm.toUpperCase()}</span>
                                ${item.is_encrypted ? '<span class="history-item-badge encrypted"> Encrypted</span>' : ''}
                            </div>
                            <div class="history-item-meta">
                                <span>${item.input_preview ? item.input_preview.substring(0, 50) + (item.input_preview.length > 50 ? '...' : '') : '[Data]'}</span>
                                <span></span>
                                <span>${new Date(item.created_at).toLocaleString()}</span>
                            </div>
                        </div>
                        <div class="history-item-expand"></div>
                        <button class="history-item-delete" onclick="event.stopPropagation(); deleteHistoryItem(${item.id})"></button>
                    </div>
                    <div class="history-item-details" id="history-details-${item.id}">
                        <div class="history-details-grid">
                            <div class="history-detail-section">
                                <h4> Operation Details</h4>
                                <div class="history-detail-row">
                                    <span class="history-detail-label">Type:</span>
                                    <span class="history-detail-value">${item.operation_type === 'encode' ? 'Encode (Hide Message)' : 'Decode (Extract Message)'}</span>
                                </div>
                                <div class="history-detail-row">
                                    <span class="history-detail-label">Algorithm:</span>
                                    <span class="history-detail-value">${item.algorithm === 'zwc' ? 'Zero-Width Characters (Text)' : 'LSB Steganography (Image)'}</span>
                                </div>
                                <div class="history-detail-row">
                                    <span class="history-detail-label">Encrypted:</span>
                                    <span class="history-detail-value">${item.is_encrypted ? ' Yes (Password Protected)' : ' No'}</span>
                                </div>
                                <div class="history-detail-row">
                                    <span class="history-detail-label">Date/Time:</span>
                                    <span class="history-detail-value">${new Date(item.created_at).toLocaleString()}</span>
                                </div>
                            </div>
                            ${metadata && Object.keys(metadata).length > 0 ? `
                            <div class="history-detail-section">
                                <h4> Technical Info</h4>
                                ${metadata.encoding_bits ? `<div class="history-detail-row"><span class="history-detail-label">Encoding Bits:</span><span class="history-detail-value">${metadata.encoding_bits}</span></div>` : ''}
                                ${metadata.insertion_method ? `<div class="history-detail-row"><span class="history-detail-label">Method:</span><span class="history-detail-value">${metadata.insertion_method.replace('_', ' ')}</span></div>` : ''}
                                ${metadata.bits_per_pixel ? `<div class="history-detail-row"><span class="history-detail-label">Bits/Pixel:</span><span class="history-detail-value">${metadata.bits_per_pixel}</span></div>` : ''}
                                ${metadata.channel ? `<div class="history-detail-row"><span class="history-detail-label">Channel:</span><span class="history-detail-value">${metadata.channel}</span></div>` : ''}
                                ${metadata.cover_length ? `<div class="history-detail-row"><span class="history-detail-label">Cover Length:</span><span class="history-detail-value">${metadata.cover_length.toLocaleString()} chars</span></div>` : ''}
                                ${metadata.secret_length ? `<div class="history-detail-row"><span class="history-detail-label">Secret Length:</span><span class="history-detail-value">${metadata.secret_length.toLocaleString()} chars</span></div>` : ''}
                                ${metadata.message_length ? `<div class="history-detail-row"><span class="history-detail-label">Message Length:</span><span class="history-detail-value">${metadata.message_length.toLocaleString()} chars</span></div>` : ''}
                                ${metadata.pixels_modified ? `<div class="history-detail-row"><span class="history-detail-label">Pixels Modified:</span><span class="history-detail-value">${metadata.pixels_modified.toLocaleString()}</span></div>` : ''}
                                ${metadata.capacity_used_percent ? `<div class="history-detail-row"><span class="history-detail-label">Capacity Used:</span><span class="history-detail-value">${metadata.capacity_used_percent}%</span></div>` : ''}
                                ${metadata.image_dimensions ? `<div class="history-detail-row"><span class="history-detail-label">Image Size:</span><span class="history-detail-value">${metadata.image_dimensions}</span></div>` : ''}
                            </div>
                            ` : ''}
                        </div>
                        <div class="history-detail-previews">
                            ${item.input_preview && item.input_preview !== '[Image]' && item.input_preview !== '[Image Data]' ? `
                            <div class="history-preview-box">
                                <h4> Input Preview</h4>
                                <div class="history-preview-content">${escapeHistoryHtml(item.input_preview)}</div>
                            </div>` : ''}
                            ${item.output_preview && item.output_preview !== '[Image]' && item.output_preview !== '[Image Data]' ? `
                            <div class="history-preview-box">
                                <h4> Output Preview</h4>
                                <div class="history-preview-content">${escapeHistoryHtml(item.output_preview)}</div>
                            </div>` : ''}
                        </div>
                    </div>
                </div>
            `;
            }).join('');
        }
        
        function toggleHistoryDetails(id) {
            const wrapper = document.querySelector(`.history-item-wrapper[data-id="${id}"]`);
            if (wrapper) {
                wrapper.classList.toggle('expanded');
            }
        }
        
        function escapeHistoryHtml(str) {
            if (!str) return '';
            return str
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#039;');
        }
        
        async function deleteHistoryItem(id) {
            if (!confirm('Delete this history item?')) return;
            
            try {
                const response = await fetch(`${API_BASE}/history/${id}`, {
                    method: 'DELETE',
                    headers: { ...getAuthHeaders() }
                });
                
                if (response.ok) {
                    loadHistory();
                    showToast(' History item deleted');
                }
            } catch (e) {
                showToast(' Failed to delete');
            }
        }
        
        async function clearAllHistory() {
            if (!confirm('Clear all history? This cannot be undone.')) return;
            
            try {
                const response = await fetch(`${API_BASE}/history`, {
                    method: 'DELETE',
                    headers: { ...getAuthHeaders() }
                });
                
                const data = await response.json();
                if (data.success) {
                    loadHistory();
                    showToast(' All history cleared');
                }
            } catch (e) {
                showToast(' Failed to clear history');
            }
        }
        
        function refreshHistory() {
            loadHistory();
            showToast(' History refreshed');
        }
        
        // ============================================================================
        // ACCOUNT FUNCTIONS
        // ============================================================================
        
        async function handleChangePassword() {
            const current = document.getElementById('current-password').value;
            const newPass = document.getElementById('new-password').value;
            const confirm = document.getElementById('confirm-new-password').value;
            
            if (!current || !newPass || !confirm) {
                showToast(' Please fill in all password fields');
                return;
            }
            
            if (newPass !== confirm) {
                showToast(' New passwords do not match');
                return;
            }
            
            showLoading(true);
            try {
                const response = await fetch(`${API_BASE}/auth/password`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        ...getAuthHeaders()
                    },
                    body: JSON.stringify({
                        current_password: current,
                        new_password: newPass
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    document.getElementById('current-password').value = '';
                    document.getElementById('new-password').value = '';
                    document.getElementById('confirm-new-password').value = '';
                    showToast(' Password changed successfully');
                } else {
                    showToast(' ' + data.error);
                }
            } catch (e) {
                showToast(' Failed to change password');
            }
            showLoading(false);
        }
        
        async function handleDeleteAccount() {
            const password = prompt('Enter your password to confirm account deletion:');
            if (!password) return;
            
            if (!confirm('Are you SURE you want to delete your account? This cannot be undone!')) return;
            
            showLoading(true);
            try {
                const response = await fetch(`${API_BASE}/auth/account`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json',
                        ...getAuthHeaders()
                    },
                    body: JSON.stringify({ password })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    authState = { isLoggedIn: false, user: null, accessToken: null, refreshToken: null };
                    localStorage.removeItem('auth');
                    updateAuthUI();
                    navigate('home');
                    showToast(' Account deleted. Goodbye!');
                } else {
                    showToast(' ' + data.error);
                }
            } catch (e) {
                showToast(' Failed to delete account');
            }
            showLoading(false);
        }
        
        // ============================================================================
        // SYSTEM LIMITS
        // ============================================================================
        
        async function loadSystemLimits() {
            try {
                const response = await fetch(`${API_BASE}/limits`);
                const data = await response.json();
                if (data.success) {
                    systemLimits = data.limits;
                }
            } catch (e) {
                console.error('Failed to load limits:', e);
            }
        }

        function updateStats(type, time) {
            if (type === 'encode') stats.encodes++;
            if (type === 'decode') stats.decodes++;
            stats.totalTime += time;
            stats.operations++;

            document.getElementById('stat-encodes').textContent = stats.encodes;
            document.getElementById('stat-decodes').textContent = stats.decodes;
            document.getElementById('stat-speed').textContent = Math.round(stats.totalTime / stats.operations) + 'ms';
            
            // Animate progress bars
            const maxOps = Math.max(stats.encodes, stats.decodes, 1);
            document.querySelector('.stat-card:nth-child(1) .stat-bar-fill').style.width = (stats.encodes / maxOps * 100) + '%';
            document.querySelector('.stat-card:nth-child(2) .stat-bar-fill').style.width = (stats.decodes / maxOps * 100) + '%';
            
            // Update chart
            if (window.qualityChart) {
                updateChart();
            }
        }

        // Sample demos
        function loadTextSample() {
            navigate('text-encode');
            setTimeout(() => {
                document.getElementById('text-encode-cover').value = `Subject: Q4 Marketing Campaign Update

Dear Marketing Team,

I hope this email finds you well. I wanted to share some exciting updates regarding our Q4 marketing campaign performance.

Our recent social media initiatives have shown promising results:
- Instagram engagement increased by 34%
- Twitter followers grew by 2,150 users
- Facebook reach expanded to 45,000 impressions

The content calendar for next month has been finalized, and we're ready to launch the holiday season promotions starting December 1st.

Please review the attached analytics report and let me know if you have any questions during our Friday meeting.

Best regards,
Sarah Mitchell
Senior Marketing Manager
TechCorp Solutions`;

                document.getElementById('text-encode-secret').value = `CONFIDENTIAL: Project Phoenix launch date moved to March 15th. Budget approved $2.5M. Key stakeholders: Anderson, Chen, Rodriguez. Competitor analysis shows 6-month lead advantage. Board approval secured. NDA required for all participants.`;
                
                document.getElementById('text-encode-password').value = "SecurePass2024!";
                
                showToast(' Realistic business email loaded with hidden corporate intel! Click "Hide Message" below');
            }, 300);
        }

        function loadJournalistSample() {
            navigate('text-encode');
            setTimeout(() => {
                document.getElementById('text-encode-cover').value = `Breaking: Tech Giant Announces New Privacy Initiative

San Francisco, CA - In a major policy shift, TechCorp announced today a comprehensive overhaul of its user data protection policies. The company's CEO stated that user privacy will become a "fundamental pillar" of all future products.

The initiative includes end-to-end encryption for all communications, enhanced transparency reports, and a new user data control dashboard. Industry analysts believe this move could pressure competitors to follow suit.

The changes will roll out gradually over the next six months, with full implementation expected by Q2 2024. Users will receive notifications as new features become available.

For more information, visit the company's privacy portal or contact their press office.`;

                document.getElementById('text-encode-secret').value = `SOURCE PROTECTED: Whistleblower identity: Dr. Lisa Chen, Senior Engineer. Meeting location: Golden Gate Park, north entrance, Dec 5th 3PM. Documents prove data breach cover-up. Use encrypted channel only. Code word: "Firefly"`;
                
                document.getElementById('text-encode-password').value = "journalist2024";
                
                showToast(' News article loaded with protected source information!');
            }, 300);
        }

        function loadSocialSample() {
            navigate('text-encode');
            setTimeout(() => {
                document.getElementById('text-encode-cover').value = `Just had the most amazing coffee at this new spot downtown!  

The vibes are immaculate and the barista made the perfect latte art  Definitely my new favorite hangout spot for getting work done.

Anyone else been here? Drop your fave coffee shops in the comments! 

#CoffeeLovers #CafeVibes #WorkFromCafe #LatteArt #LocalBusiness #CoffeeCommunity`;

                document.getElementById('text-encode-secret').value = `Flash mob dance performance this Saturday at Central Park fountain, 2PM sharp. Wear red. Learn the routine: bit.ly/flashdance2024. Surprise for Emma's birthday. Don't tell her!`;
                
                document.getElementById('text-encode-password').value = "";
                
                showToast(' Social media post loaded with hidden event coordinates!');
            }, 300);
        }

        function loadEncryptedSample() {
            navigate('text-encode');
            setTimeout(() => {
                document.getElementById('text-encode-cover').value = `MEMORANDUM

TO: All Department Heads
FROM: Office of Administration
DATE: November 24, 2025
RE: Annual Strategic Planning Meeting

The annual strategic planning meeting has been scheduled for January 15-17, 2026, at the corporate headquarters conference center.

All department heads are required to submit their preliminary budget proposals and strategic objectives by December 20, 2025. Please use the standardized template available on the intranet.

Key discussion topics will include:
 Departmental goals and KPIs for 2026
 Cross-functional collaboration initiatives  
 Technology infrastructure upgrades
 Talent acquisition and retention strategies

Please confirm your attendance by responding to this memo. Contact HR for travel arrangements if required.

Thank you for your cooperation.`;

                document.getElementById('text-encode-secret').value = `CLASSIFIED: Merger talks with GlobalTech progressing. Acquisition target $4.2B. Due diligence phase complete. Announcement planned for Feb 1st. Stock ticker: GBTC. Insider trading restrictions active. Legal team: Morrison & Associates. Board vote scheduled Jan 10th.`;
                
                document.getElementById('text-encode-password').value = "TopSecret!2024";
                
                showToast(' Password-protected corporate memo loaded with merger intel!');
            }, 300);
        }

        function loadImageSample() {
            showToast(' Image samples require uploading your own image. Try the text sample first!');
            navigate('text-encode');
        }

        // Method switcher for process explanation
        function showMethod(method) {
            document.querySelectorAll('.method-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.method-animation').forEach(anim => anim.classList.remove('active'));
            
            event.target.closest('.method-tab').classList.add('active');
            document.getElementById('method-' + method).classList.add('active');
        }

        // Initialize quality comparison chart
        let qualityChart = null;
        function initChart() {
            const ctx = document.getElementById('qualityChart');
            if (!ctx) return;

            qualityChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['LSB Method', 'DCT Method', 'Wavelet Method', 'Spread Spectrum'],
                    datasets: [{
                        label: 'PSNR (dB) - Higher is Better',
                        data: [48.2, 42.5, 45.8, 40.3],
                        backgroundColor: [
                            'rgba(138, 43, 226, 0.8)',
                            'rgba(255, 20, 147, 0.8)',
                            'rgba(30, 144, 255, 0.8)',
                            'rgba(50, 205, 50, 0.8)'
                        ],
                        borderColor: [
                            'rgba(138, 43, 226, 1)',
                            'rgba(255, 20, 147, 1)',
                            'rgba(30, 144, 255, 1)',
                            'rgba(50, 205, 50, 1)'
                        ],
                        borderWidth: 2,
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                font: {
                                    size: 14,
                                    weight: 'bold',
                                    family: 'Poppins'
                                },
                                padding: 20
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleFont: {
                                size: 16,
                                family: 'Poppins',
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 14,
                                family: 'Poppins'
                            },
                            padding: 12,
                            cornerRadius: 8,
                            callbacks: {
                                label: function(context) {
                                    return context.parsed.y + ' dB (Excellent quality preserved)';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 60,
                            ticks: {
                                font: {
                                    size: 12,
                                    family: 'Poppins',
                                    weight: '600'
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            ticks: {
                                font: {
                                    size: 12,
                                    family: 'Poppins',
                                    weight: '600'
                                }
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    animation: {
                        duration: 2000,
                        easing: 'easeInOutQuart'
                    }
                }
            });
        }

        function updateChart() {
            if (!qualityChart) return;
            
            // Simulate dynamic updates based on actual operations
            const randomVariation = () => (Math.random() - 0.5) * 2;
            qualityChart.data.datasets[0].data = [
                48.2 + randomVariation(),
                42.5 + randomVariation(),
                45.8 + randomVariation(),
                40.3 + randomVariation()
            ];
            qualityChart.update();
        }

        // Initialize auth and chart when page loads
        document.addEventListener('DOMContentLoaded', () => {
            // Check server connectivity first
            checkServerConnection();
            
            // Restore auth state from localStorage
            const savedAuth = localStorage.getItem('auth');
            if (savedAuth) {
                try {
                    authState = JSON.parse(savedAuth);
                    // Verify token is still valid by refreshing
                    if (authState.refreshToken) {
                        refreshAccessToken();
                    }
                } catch (e) {
                    localStorage.removeItem('auth');
                }
            }
            updateAuthUI();
            
            // Load system limits
            loadSystemLimits();
            
            // Initialize chart
            setTimeout(initChart, 500);
        });
        
        // Check if server is reachable
        async function checkServerConnection() {
            try {
                const response = await fetch(`${API_BASE.replace('/api', '')}/ping`, {
                    method: 'GET',
                    headers: { 'Accept': 'application/json' }
                });
                if (response.ok) {
                    console.log(' Server connection OK');
                } else {
                    console.warn(' Server responded with status:', response.status);
                }
            } catch (error) {
                console.error(' Server connection failed:', error);
                showToast(' Server may be unavailable');
            }
        }

        // Navigation
        // Tutorial System
        let tutorialStep = 0;
        const tutorialSteps = [
            {
                title: "Welcome to Steganography Pro! ",
                description: "This comprehensive tutorial will guide you step-by-step through all features: hiding messages in text, revealing them, encrypting with passwords, working with images, and more. Let's begin!",
                spotlight: null,
                cardPosition: { top: '50%', left: '50%', transform: 'translate(-50%, -50%)' },
                action: null
            },
            {
                title: "1 Navigation Overview",
                description: "The navigation menu has 6 main sections: Home, Hide in Text, Reveal from Text, Hide in Image, Reveal from Image, and How It Works. Each handles a specific task in the steganography process.",
                spotlight: '.nav-menu',
                cardPosition: { top: '140px', left: '50%', transform: 'translateX(-50%)' },
                action: null
            },
            {
                title: "2 Hide Messages in Text",
                description: "Click 'Hide in Text' to encode secret messages inside normal text using invisible Unicode characters. The text looks completely normal but contains hidden data. Let's go there now!",
                spotlight: '.nav-menu li:nth-child(2)',
                cardPosition: { top: '140px', left: '20%', transform: 'translateX(-50%)' },
                action: () => navigate('text-encode')
            },
            {
                title: "3 Enter Your Cover Text",
                description: "This is your 'cover text' - the normal-looking text that will carry your hidden message. Type or paste any text here. The longer it is, the more data you can hide. Try the samples below for examples!",
                spotlight: '#text-encode-cover',
                cardPosition: { top: '200px', left: '50%', transform: 'translateX(-50%)' },
                action: () => { navigate('text-encode'); setTimeout(() => window.scrollTo({ top: 300, behavior: 'smooth' }), 100); }
            },
            {
                title: "4 Enter Your Secret Message",
                description: "Type your secret message here. This is what you want to hide inside the cover text. Only people who use this tool can extract it!",
                spotlight: '#text-encode-secret',
                cardPosition: { top: '400px', left: '50%', transform: 'translateX(-50%)' },
                action: () => { navigate('text-encode'); setTimeout(() => window.scrollTo({ top: 500, behavior: 'smooth' }), 100); }
            },
            {
                title: "5 Add Password (Optional)",
                description: "Want extra security? Add a password to encrypt your message with AES-128 military-grade encryption. Without the password, nobody can read your secret - even if they extract it!",
                spotlight: '#text-encode-password',
                cardPosition: { top: '600px', left: '50%', transform: 'translateX(-50%)' },
                action: () => { navigate('text-encode'); setTimeout(() => window.scrollTo({ top: 700, behavior: 'smooth' }), 100); }
            },
            {
                title: "6 Reveal Hidden Messages",
                description: "Now let's learn how to extract hidden messages! Click 'Reveal from Text' to decode messages that were hidden in text. You'll paste the stego-text here.",
                spotlight: '.nav-menu li:nth-child(3)',
                cardPosition: { top: '140px', left: '30%', transform: 'translateX(-50%)' },
                action: () => navigate('text-decode')
            },
            {
                title: "7 Paste Encoded Text",
                description: "Paste the text containing the hidden message here. The tool will automatically extract the secret message embedded in the invisible characters.",
                spotlight: '#text-decode-input',
                cardPosition: { top: '300px', left: '50%', transform: 'translateX(-50%)' },
                action: () => { navigate('text-decode'); setTimeout(() => window.scrollTo({ top: 300, behavior: 'smooth' }), 100); }
            },
            {
                title: "8 Hide Messages in Images",
                description: "You can also hide messages inside image files! Click 'Hide in Image' to use LSB (Least Significant Bit) steganography. The image looks identical but contains your secret data.",
                spotlight: '.nav-menu li:nth-child(4)',
                cardPosition: { top: '140px', left: '50%', transform: 'translateX(-50%)' },
                action: () => navigate('image-encode')
            },
            {
                title: "9 Upload & Extract from Images",
                description: "Upload a cover image, type your secret message, optionally add a password, and click 'Hide Message'. To reveal, go to 'Reveal from Image', upload the stego-image, enter the password if used, and extract!",
                spotlight: '.workspace-card',
                cardPosition: { top: '250px', left: '50%', transform: 'translateX(-50%)' },
                action: () => { navigate('image-encode'); setTimeout(() => window.scrollTo({ top: 300, behavior: 'smooth' }), 100); }
            },
            {
                title: " Tutorial Complete!",
                description: "You now know how to: hide & reveal text messages, encrypt with passwords, work with images, and use all features! Try the sample buttons on the home page to practice. Happy encoding! ",
                spotlight: null,
                cardPosition: { top: '50%', left: '50%', transform: 'translate(-50%, -50%)' },
                action: () => navigate('home')
            }
        ];

        function startTutorial() {
            tutorialStep = 0;
            document.getElementById('tutorial-overlay').classList.add('active');
            showTutorialStep();
        }

        function nextTutorialStep() {
            tutorialStep++;
            if (tutorialStep >= tutorialSteps.length) {
                skipTutorial();
                return;
            }
            showTutorialStep();
        }

        function skipTutorial() {
            document.getElementById('tutorial-overlay').classList.remove('active');
            tutorialStep = 0;
        }

        function showTutorialStep() {
            const step = tutorialSteps[tutorialStep];
            const card = document.getElementById('tutorial-card');
            const spotlight = document.getElementById('tutorial-spotlight');
            
            // Execute action if any
            if (step.action) {
                step.action();
            }
            
            // Update content
            document.getElementById('tutorial-title').textContent = step.title;
            document.getElementById('tutorial-description').textContent = step.description;
            document.getElementById('tutorial-step-badge').textContent = `Step ${tutorialStep + 1} of ${tutorialSteps.length}`;
            
            // Update button text
            const nextBtn = document.getElementById('tutorial-next');
            nextBtn.textContent = tutorialStep === tutorialSteps.length - 1 ? 'Finish' : 'Next';
            
            // Update progress dots
            const dots = document.querySelectorAll('.tutorial-dot');
            dots.forEach((dot, i) => {
                dot.classList.toggle('active', i === tutorialStep);
            });
            
            // Position card
            Object.assign(card.style, step.cardPosition);
            
            // Handle spotlight
            if (step.spotlight) {
                const target = document.querySelector(step.spotlight);
                if (target) {
                    const rect = target.getBoundingClientRect();
                    const padding = 10;
                    spotlight.style.display = 'block';
                    spotlight.style.top = (rect.top - padding) + 'px';
                    spotlight.style.left = (rect.left - padding) + 'px';
                    spotlight.style.width = (rect.width + padding * 2) + 'px';
                    spotlight.style.height = (rect.height + padding * 2) + 'px';
                    
                    // Apply clip-path to overlay to create a "hole" for the spotlight
                    const overlay = document.getElementById('tutorial-overlay');
                    const top = rect.top - padding;
                    const left = rect.left - padding;
                    const right = rect.right + padding;
                    const bottom = rect.bottom + padding;
                    const w = window.innerWidth;
                    const h = window.innerHeight;
                    overlay.style.clipPath = `polygon(
                        0 0, ${w}px 0, ${w}px ${h}px, 0 ${h}px, 0 0,
                        ${left}px ${top}px, ${left}px ${bottom}px, ${right}px ${bottom}px, ${right}px ${top}px, ${left}px ${top}px
                    )`;
                }
            } else {
                spotlight.style.display = 'none';
                document.getElementById('tutorial-overlay').style.clipPath = 'none';
            }
        }

        function navigate(page) {
            // Hide all pages
            document.querySelectorAll('.page-section').forEach(p => p.classList.remove('active'));
            
            // Deactivate all nav links
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            
            // Check if auth required for page
            if ((page === 'history' || page === 'account') && !authState.isLoggedIn) {
                openAuthModal('login');
                return;
            }
            
            // Show target page
            const targetPage = document.getElementById('page-' + page);
            if (targetPage) {
                targetPage.classList.add('active');
            }
            
            // Load data for specific pages
            if (page === 'history') {
                loadHistory();
            }
            if (page === 'account' && authState.user) {
                document.getElementById('account-username').textContent = authState.user.username;
                document.getElementById('account-email').textContent = authState.user.email;
                document.getElementById('account-avatar-letter').textContent = authState.user.username.charAt(0).toUpperCase();
                document.getElementById('account-display-name').textContent = authState.user.username;
                document.getElementById('account-email-display').textContent = authState.user.email;
                if (authState.user.created_at) {
                    document.getElementById('account-created').textContent = new Date(authState.user.created_at).toLocaleDateString();
                }
                // Load account stats
                loadAccountStats();
            }
            
            // Activate nav link
            // Find the link that calls this function with the same page argument
            const links = document.querySelectorAll('.nav-link');
            links.forEach(link => {
                const onclick = link.getAttribute('onclick');
                if (onclick && onclick.includes(`'${page}'`)) {
                    link.classList.add('active');
                }
            });
            
            closeUserDropdown();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Learn Page Section Switching
        function showLearnSection(sectionId) {
            // Hide all learn sections
            document.querySelectorAll('.learn-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active from all nav cards
            document.querySelectorAll('.learn-nav-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // Show the selected section
            const targetSection = document.getElementById('learn-' + sectionId);
            if (targetSection) {
                targetSection.classList.add('active');
            }
            
            // Highlight the nav card that was clicked
            event.currentTarget.classList.add('active');
            
            // Smooth scroll to content area
            document.getElementById('learn-content-area').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Utilities
        let toastTimeoutId = null;
        function showToast(message) {
            const toast = document.getElementById('toast');
            if (!toast) return;
            
            // Clear any existing timeout to prevent overlap
            if (toastTimeoutId) {
                clearTimeout(toastTimeoutId);
            }
            
            // Reset the toast state
            toast.classList.remove('show');
            
            // Force reflow to restart animation
            void toast.offsetWidth;
            
            toast.textContent = message;
            toast.classList.add('show');
            
            toastTimeoutId = setTimeout(() => {
                toast.classList.remove('show');
                toastTimeoutId = null;
            }, 3000);
        }

        function showLoading(show) {
            document.getElementById('loading').classList.toggle('hidden', !show);
        }
        
        function showNotification(message, type = 'info') {
            // Use toast for simple notifications
            showToast(message);
        }
        
        // Speed metrics display
        function showSpeedMetrics(resultContainerId, metrics) {
            const container = document.getElementById(resultContainerId);
            if (!container) return;
            
            // Remove existing speed metrics
            const existingMetrics = container.querySelector('.speed-metrics');
            if (existingMetrics) {
                existingMetrics.remove();
            }
            
            const metricsHtml = `
                <div class="speed-metrics">
                    <div class="speed-metric">
                        <span class="speed-metric-icon"></span>
                        <span class="speed-metric-value">${metrics.time}s</span>
                        <span class="speed-metric-label">Processing Time</span>
                    </div>
                    <div class="speed-metric">
                        <span class="speed-metric-icon"></span>
                        <span class="speed-metric-value">${formatBytes(metrics.inputSize)}</span>
                        <span class="speed-metric-label">Input Size</span>
                    </div>
                    <div class="speed-metric">
                        <span class="speed-metric-icon"></span>
                        <span class="speed-metric-value">${formatBytes(metrics.outputSize)}</span>
                        <span class="speed-metric-label">Output Size</span>
                    </div>
                    <div class="speed-metric">
                        <span class="speed-metric-icon">${metrics.encrypted ? '' : ''}</span>
                        <span class="speed-metric-value">${metrics.encrypted ? 'AES-128' : 'None'}</span>
                        <span class="speed-metric-label">Encryption</span>
                    </div>
                </div>
            `;
            
            // Insert after result header
            const resultHeader = container.querySelector('.result-header');
            if (resultHeader) {
                resultHeader.insertAdjacentHTML('afterend', metricsHtml);
            }
        }
        
        function formatBytes(bytes) {
            if (bytes < 1024) return bytes + ' chars';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        }
        
        // Encryption visualization functions
        function showEncryptionVisualization(containerId, hasPassword) {
            if (!hasPassword) return;
            
            const container = document.getElementById(containerId);
            if (!container) return;
            
            container.style.display = 'block';
            const roundsContainer = document.getElementById(containerId.replace('-viz', '-rounds'));
            const progressBar = document.getElementById(containerId.replace('-viz', '-progress'));
            const statusEl = document.getElementById(containerId.replace('-viz', '-viz-status'));
            
            // AES-128 has 10 rounds
            const totalRounds = 10;
            roundsContainer.innerHTML = '';
            
            for (let i = 0; i <= totalRounds; i++) {
                const roundName = i === 0 ? 'Init' : i === totalRounds ? 'Final' : `R${i}`;
                const roundEl = document.createElement('div');
                roundEl.className = 'encryption-round';
                roundEl.id = `${containerId}-round-${i}`;
                roundEl.innerHTML = `
                    <div class="encryption-round-number">${roundName}</div>
                    <div class="encryption-round-data">---</div>
                `;
                roundsContainer.appendChild(roundEl);
            }
            
            // Animate the rounds
            animateEncryptionRounds(containerId, totalRounds, progressBar, statusEl);
        }
        
        async function animateEncryptionRounds(containerId, totalRounds, progressBar, statusEl) {
            const fakeData = ['AddKey', 'SubByt', 'ShfRow', 'MxCol', 'AddKey', 'SubByt', 'ShfRow', 'MxCol', 'AddKey', 'SubByt', 'Final'];
            
            for (let i = 0; i <= totalRounds; i++) {
                const roundEl = document.getElementById(`${containerId}-round-${i}`);
                if (!roundEl) continue;
                
                // Remove active from previous
                const prevEl = document.getElementById(`${containerId}-round-${i-1}`);
                if (prevEl) {
                    prevEl.classList.remove('active');
                    prevEl.classList.add('completed');
                }
                
                // Set current as active
                roundEl.classList.add('active');
                roundEl.querySelector('.encryption-round-data').textContent = fakeData[i] || '---';
                
                // Update progress
                const progress = ((i + 1) / (totalRounds + 1)) * 100;
                progressBar.style.width = progress + '%';
                
                await new Promise(resolve => setTimeout(resolve, 100));
            }
            
            // Mark last as completed
            const lastEl = document.getElementById(`${containerId}-round-${totalRounds}`);
            if (lastEl) {
                lastEl.classList.remove('active');
                lastEl.classList.add('completed');
            }
            
            statusEl.textContent = ' Complete!';
        }
        
        function hideEncryptionVisualization(containerId) {
            const container = document.getElementById(containerId);
            if (container) {
                container.style.display = 'none';
            }
        }
        
        function updateCharCounter(elementId, maxLength) {
            const element = document.getElementById(elementId);
            const counter = document.getElementById(elementId + '-counter');
            if (!element || !counter) return;
            
            const length = element.value.length;
            counter.textContent = `${length.toLocaleString()} / ${maxLength.toLocaleString()} characters`;
            
            // Update styling based on usage
            counter.classList.remove('warning', 'error');
            if (length > maxLength) {
                counter.classList.add('error');
            } else if (length > maxLength * 0.9) {
                counter.classList.add('warning');
            }
        }

        // TEXT ENCODE
        async function performTextEncode() {
            const cover = document.getElementById('text-encode-cover').value.trim();
            const secret = document.getElementById('text-encode-secret').value.trim();
            const password = document.getElementById('text-encode-password').value;

            if (!cover || !secret) {
                showToast(' Please fill in both cover text and secret message');
                return;
            }
            
            // Check limits
            if (cover.length > systemLimits.max_text_length) {
                showToast(` Cover text exceeds ${systemLimits.max_text_length.toLocaleString()} character limit`);
                return;
            }
            if (secret.length > systemLimits.max_secret_length) {
                showToast(` Secret message exceeds ${systemLimits.max_secret_length.toLocaleString()} character limit`);
                return;
            }

            showLoading(true);
            const startTime = performance.now();
            
            try {
                const response = await authFetch(`${API_BASE}/encode`, {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        algorithm: 'zwc',
                        cover_text: cover,
                        secret_message: secret,
                        password: password || undefined
                    })
                });

                const data = await response.json();
                const endTime = performance.now();
                const processingTime = ((endTime - startTime) / 1000).toFixed(2);
                
                if (data.success) {
                    document.getElementById('text-encode-output').value = data.stego_text;
                    document.getElementById('text-encode-result').classList.remove('hidden');
                    
                    // Show speed metrics
                    showSpeedMetrics('text-encode-result', {
                        time: processingTime,
                        inputSize: cover.length + secret.length,
                        outputSize: data.stego_text.length,
                        encrypted: !!password
                    });
                    
                    showToast(` Message hidden in ${processingTime}s!`);
                    updateStats('encode', endTime - startTime);
                    
                    // Refresh history if user is logged in
                    if (authState.isLoggedIn) {
                        loadHistory();
                    }
                } else {
                    showToast(' Error: ' + data.error);
                }
            } catch (error) {
                showToast(' Connection error. Make sure the server is running.');
            }
            showLoading(false);
        }

        // TEXT DECODE
        async function performTextDecode() {
            const stego = document.getElementById('text-decode-input').value.trim();
            const password = document.getElementById('text-decode-password').value;

            if (!stego) {
                showToast(' Please paste the text to decode');
                return;
            }

            showLoading(true);
            const startTime = performance.now();
            
            try {
                const response = await authFetch(`${API_BASE}/decode`, {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        algorithm: 'zwc',
                        stego_text: stego,
                        password: password || undefined
                    })
                });

                const data = await response.json();
                const endTime = performance.now();
                const processingTime = ((endTime - startTime) / 1000).toFixed(2);
                
                if (data.success) {
                    document.getElementById('text-decode-output').textContent = data.secret_message;
                    document.getElementById('text-decode-result').classList.remove('hidden');
                    
                    // Show speed metrics
                    showSpeedMetrics('text-decode-result', {
                        time: processingTime,
                        inputSize: stego.length,
                        outputSize: data.secret_message.length,
                        encrypted: !!password
                    });
                    
                    showToast(` Secret revealed in ${processingTime}s!`);
                    updateStats('decode', endTime - startTime);
                    
                    // Refresh history if user is logged in
                    if (authState.isLoggedIn) {
                        loadHistory();
                    }
                } else {
                    showToast(' ' + (data.error || 'No hidden message found'));
                }
            } catch (error) {
                showToast(' Connection error');
            }
            showLoading(false);
        }

        // IMAGE ENCODE
        document.getElementById('image-encode-file').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    coverImageData = e.target.result;
                    document.getElementById('image-encode-preview-img').src = coverImageData;
                    document.getElementById('image-encode-preview').classList.remove('hidden');
                    showToast(' Image loaded: ' + file.name);
                };
                reader.readAsDataURL(file);
            }
        });

        async function performImageEncode() {
            if (!coverImageData) {
                showToast(' Please upload an image first');
                return;
            }

            const secret = document.getElementById('image-encode-secret').value.trim();
            const password = document.getElementById('image-encode-password').value;

            if (!secret) {
                showToast(' Please enter a secret message');
                return;
            }
            
            // Check secret length limit
            if (secret.length > systemLimits.max_secret_length) {
                showToast(` Secret message exceeds ${systemLimits.max_secret_length.toLocaleString()} character limit`);
                return;
            }

            showLoading(true);
            const startTime = performance.now();
            
            try {
                const response = await authFetch(`${API_BASE}/encode`, {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        algorithm: 'lsb',
                        cover_image: coverImageData,
                        secret_message: secret,
                        password: password || undefined,
                        bits_per_pixel: 2
                    })
                });

                const data = await response.json();
                const endTime = performance.now();
                const processingTime = ((endTime - startTime) / 1000).toFixed(2);
                
                if (data.success) {
                    stegoImageData = 'data:image/png;base64,' + data.stego_image;
                    
                    // Analyze quality
                    const analyzeRes = await fetch(`${API_BASE}/analyze`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            original_image: coverImageData,
                            stego_image: stegoImageData
                        })
                    });
                    const analyzeData = await analyzeRes.json();
                    
                    if (analyzeData.success) {
                        document.getElementById('img-quality').textContent = analyzeData.metrics.quality_assessment;
                        document.getElementById('img-mse').textContent = analyzeData.metrics.mse.toFixed(4);
                        document.getElementById('img-psnr').textContent = analyzeData.metrics.psnr === 'Inf' ? '' : analyzeData.metrics.psnr.toFixed(2);
                        document.getElementById('img-ssim').textContent = analyzeData.metrics.ssim.toFixed(4);
                    }

                    document.getElementById('image-encode-output').src = stegoImageData;
                    document.getElementById('image-download-link').href = stegoImageData;
                    document.getElementById('image-encode-result').classList.remove('hidden');
                    
                    // Show speed metrics
                    showSpeedMetrics('image-encode-result', {
                        time: processingTime,
                        inputSize: coverImageData.length,
                        outputSize: stegoImageData.length,
                        encrypted: !!password
                    });
                    
                    showToast(` Image encoded in ${processingTime}s!`);
                    updateStats('encode', endTime - startTime);
                    
                    // Refresh history if user is logged in
                    if (authState.isLoggedIn) {
                        loadHistory();
                    }
                } else {
                    showToast(' ' + data.error);
                }
            } catch (error) {
                showToast(' Connection error');
            }
            showLoading(false);
        }

        // IMAGE DECODE
        document.getElementById('image-decode-file').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    decodeImageData = e.target.result;
                    document.getElementById('image-decode-preview-img').src = decodeImageData;
                    document.getElementById('image-decode-preview').classList.remove('hidden');
                    showToast(' Image loaded: ' + file.name);
                };
                reader.readAsDataURL(file);
            }
        });

        async function performImageDecode() {
            if (!decodeImageData) {
                showToast(' Please upload an image');
                return;
            }

            const password = document.getElementById('image-decode-password').value;

            showLoading(true);
            const startTime = performance.now();
            
            try {
                const response = await authFetch(`${API_BASE}/decode`, {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        algorithm: 'lsb',
                        stego_image: decodeImageData,
                        password: password || undefined
                    })
                });

                const data = await response.json();
                const endTime = performance.now();
                const processingTime = ((endTime - startTime) / 1000).toFixed(2);
                
                if (data.success) {
                    document.getElementById('image-decode-output').textContent = data.secret_message;
                    document.getElementById('image-decode-result').classList.remove('hidden');
                    
                    // Show speed metrics
                    showSpeedMetrics('image-decode-result', {
                        time: processingTime,
                        inputSize: decodeImageData.length,
                        outputSize: data.secret_message.length,
                        encrypted: !!password
                    });
                    
                    showToast(` Secret extracted in ${processingTime}s!`);
                    updateStats('decode', endTime - startTime);
                    
                    // Refresh history if user is logged in
                    if (authState.isLoggedIn) {
                        loadHistory();
                    }
                } else {
                    showToast(' ' + (data.error || 'No hidden message found'));
                }
            } catch (error) {
                showToast(' Connection error');
            }
            showLoading(false);
        }

        // Copy functions with robust fallback
        function copyToClipboard(elementIdOrText) {
            let text = '';
            
            // Check if it's an element ID or direct text
            const element = document.getElementById(elementIdOrText);
            
            if (element) {
                // It's an element ID - get text based on element type
                if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                    text = element.value || '';
                } else {
                    text = element.textContent || element.innerText || '';
                }
            } else {
                // It's direct text (not an element ID)
                text = String(elementIdOrText);
            }
            
            // Trim and validate
            text = text.trim();
            
            if (!text) {
                showToast(' Nothing to copy');
                return;
            }
            
            // Try modern clipboard API first
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text).then(() => {
                    showToast(' Copied to clipboard!');
                }).catch((err) => {
                    console.error('Clipboard API failed:', err);
                    // Fallback for clipboard API failure
                    fallbackCopy(text);
                });
            } else {
                // Fallback for older browsers
                fallbackCopy(text);
            }
        }
        
        // Dedicated function for copying text encode output
        function copyTextEncodeOutput() {
            const element = document.getElementById('text-encode-output');
            if (element && element.value && element.value.trim()) {
                copyToClipboard(element.value);
            } else {
                showToast(' Nothing to copy - encode a message first');
            }
        }
        
        function fallbackCopy(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed';
            textarea.style.left = '-9999px';
            textarea.style.top = '0';
            document.body.appendChild(textarea);
            textarea.focus();
            textarea.select();
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showToast(' Copied to clipboard!');
                } else {
                    showToast(' Copy failed');
                }
            } catch (err) {
                showToast(' Copy not supported in this browser');
            }
            
            document.body.removeChild(textarea);
        }

        function copySecretText() {
            const element = document.getElementById('text-decode-output');
            const text = element ? (element.textContent || element.innerText || '') : '';
            if (!text.trim()) {
                showToast(' Nothing to copy');
                return;
            }
            copyToClipboard(text);
        }

        function copyImageSecret() {
            const element = document.getElementById('image-decode-output');
            const text = element ? (element.textContent || element.innerText || '') : '';
            if (!text.trim()) {
                showToast(' Nothing to copy');
                return;
            }
            copyToClipboard(text);
        }
    </script>

    <script src="features.js"></script>
    <!-- Chatbot JavaScript -->
    <script src="chatbot.js"></script>

</body>
</html>
